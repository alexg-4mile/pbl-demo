//dashboard.sample.txt
//import the emebed sdk
import { LookerEmbedSDK, LookerEmbedDashboard } from '@looker/embed-sdk'

//initialize the embed sdk
LookerEmbedSDK.init('demo.looker.com', '/auth')

//call helper method when page loads to create dashboard and setup events
componentDidMount() {
    this.embedSdkInit()
}

//create dashboard using embed sdk method
embedSdkInit() {
    LookerEmbedSDK.createDashboardWithId(5277)
        .appendTo('#embedContainer')
        .withClassName('iframe')
        .withNext()
        .on('dashboard:run:start', (e) => { console.log(e) })
        .on('dashboard:filters:changed', (e) => this.filtersUpdates(e))
        .build()
        .connect()
        .then(this.setupDashboard)
        .catch((error) => {
            console.error('Connection error', error)
        })
}

//apply dashboard to state so it's accessible for events later
//e.g. this.filtersUpdate()
setupDashboard = (dashboard) => {
    this.setState({
        dashboard: dashboard
    }})
}

//render embedContainer on the page so the dashboard can be appeneded
render() {
    return (
        <div id="embedContainer" className="mt-3 pt-3 border-top"></div>
    )
}