(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{257:function(e,t,n){},275:function(e){e.exports=JSON.parse('{"external_user_id":"","first_name":"","last_name":"","session_length":3600,"force_logout_login":true,"external_group_id":"","group_ids":[],"permissions":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","create_table_calculations","save_content","embed_browse_spaces","schedule_look_emails","schedule_external_look_emails","send_to_sftp","send_to_s3","send_outgoing_webhook","see_sql","send_to_integration","create_alerts"],"models":["atom_fashion"],"user_attributes":{"locale":"en_US","country":"USA","brand":"Calvin Klein","time_horizon":"last 6 months"}}')},364:function(e,t,n){e.exports=n.p+"static/media/atom_splash_blog.89cd1730.jpg"},365:function(e,t,n){e.exports=n.p+"static/media/atom_splash_inventory.5ac8518d.jpg"},366:function(e,t,n){e.exports=n.p+"static/media/atom_splash_trends.3591acf3.jpg"},392:function(e){e.exports=JSON.parse('[{"label":"Columbia"},{"label":"Calvin Klein"},{"label":"Carhartt"},{"label":"Levi\'s"},{"label":"Dockers"}]')},42:function(e,t){e.exports={makeid:function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*a));return t},validIdHelper:function(e){return e.replace(/[^a-zA-Z0-9-.#]/g,"")},prettifyString:function(e){var t,n=e.split("_");for(t=0;t<n.length;t++)n[t]=n[t].charAt(0).toUpperCase()+n[t].slice(1);return n.join(" ")},getUrlVars:function(e){for(var t,n={},a=e.slice(e.indexOf("?")+1).split("&"),o=0;o<a.length;o++)n[(t=a[o].split("="))[0]]=t[1];return n},decodeHtml:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}}},428:function(e,t,n){e.exports=n(888)},433:function(e,t,n){},435:function(e,t,n){},61:function(e){e.exports=JSON.parse('{"basic":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","create_table_calculations","save_content","embed_browse_spaces","schedule_look_emails","schedule_external_look_emails","send_to_sftp","send_to_s3","send_outgoing_webhook","see_sql","send_to_integration","create_alerts"],"advanced":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","create_table_calculations","save_content","embed_browse_spaces","schedule_look_emails","schedule_external_look_emails","send_to_sftp","send_to_s3","send_outgoing_webhook","see_sql","send_to_integration","create_alerts","see_drill_overlay","download_with_limit"],"premium":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","create_table_calculations","download_with_limit","save_content","embed_browse_spaces","schedule_look_emails","schedule_external_look_emails","send_to_sftp","send_to_s3","send_outgoing_webhook","see_sql","send_to_integration","create_alerts","see_drill_overlay","download_without_limit","explore"]}')},67:function(e){e.exports=JSON.parse('{"atom":{"label":"Atom Fashion","vignette":{"name":"Atom","logo_url":"../images/atom_logo.png"},"layout":"right-appbar","demoComponents":[{"type":"splash page","label":"Home","description":"We\'re thrilled to have you on Atom Fashion - the premiere third party fashion marketplace for today\'s leading brands. Throughout this portal you will find a series of analytic content designed to help you maximize your performance.","icon":"fa-home","menuCategory":"home","lookerContent":[{"id":"19","gridWidth":6,"height":200,"type":"welcome","inlineQueries":[{"model":"atom_fashion","view":"order_items","fields":["order_items.total_sale_price","order_items.created_week","products.category"],"pivots":["order_items.created_week"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"2 weeks ago for 2 weeks"},"filter_expression":null,"sorts":["order_items.total_sale_price desc 1","order_items.created_week 0"],"limit":"1","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(pivot_index(${order_items.total_sale_price},2)-pivot_index(${order_items.total_sale_price},1))/pivot_index(${order_items.total_sale_price},1\\\\n  )\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"supermeasure\\",\\"_type_hint\\":\\"number\\"}]"},{"model":"atom_fashion","view":"order_items","fields":["order_items.total_sale_price","order_items.created_week","products.category"],"pivots":["order_items.created_week"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"2 weeks ago for 2 weeks"},"filter_expression":null,"sorts":["order_items.total_sale_price 1","order_items.created_week 0"],"limit":"1","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(pivot_index(${order_items.total_sale_price},2)-pivot_index(${order_items.total_sale_price},1))/pivot_index(${order_items.total_sale_price},1\\\\n  )\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"supermeasure\\",\\"_type_hint\\":\\"number\\"}]"}],"inlineQueriesMap":["best","worst"],"resultFormat":"json"},{"id":"17","gridWidth":6,"height":200,"type":"carousel"},{"id":"18","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_week","order_items.total_gross_margin"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"12 weeks ago for 12 weeks"},"sorts":["order_items.created_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"week_over_week_change\\",\\"label\\":\\"Week over Week %25 Change\\",\\"expression\\":\\"(${order_items.total_gross_margin}-offset(${order_items.total_gross_margin},1))/offset(${order_items.total_gross_margin},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Revenue by Week","visColor":"#4595EC"},{"id":"20","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","events.sessions_count"],"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${events.sessions_count}-offset(${events.sessions_count},1))/offset(${events.sessions_count},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Visits by Week","visColor":"#F3A759"},{"id":"21","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","events.bounce_rate"],"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"filter_expression":null,"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${events.bounce_rate}-offset(${events.bounce_rate},1))/offset(${events.bounce_rate},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Bounce Rate by Week","visColor":"#E24E3A"},{"id":"22","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","sessions.average_duration"],"pivots":null,"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"filter_expression":null,"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${sessions.average_duration}-offset(${sessions.average_duration},1))/offset(${sessions.average_duration},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Average Time on Site by Week","visColor":"#65AB5A"},{"gridWidth":8,"height":400,"type":"dashboard","id":"12"},{"gridWidth":4,"height":400,"type":"popular analysis","vectors":[{"id":"9","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Analytics","gridWidth":"4"},{"id":"5","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Sales","gridWidth":"4"},{"id":"1","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Inventory","gridWidth":"4"}],"label":"Popular analysis"}]},{"type":"simple dashboard","label":"Web Analytics","menuCategory":"marketing","description":"Overview of all your web traffic","icon":"fa-chart-line","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"9","label":"Web Analytics","isNext":false}]},{"type":"simple dashboard","label":"Sales Overview","menuCategory":"sales","description":"Overview of all your sales!","icon":"fa-tachometer-alt","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"5","label":"Sales Overview","isNext":true,"filter":{"label":"Select Category","filterName":"Category","lookerMethod":"runInlineQuery"},"inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["this_period","last_period","products.category"],"filters":{"order_items.created_date":"60 days ago for 60 days","order_items.count":">5"},"sorts":["products.category"],"limit":500,"dynamic_fields":"[{\\"table_calculation\\":\\"trend\\",\\"label\\":\\"trend\\",\\"expression\\":\\"${this_period} / ${last_period} - 1\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"},{\\"measure\\":\\"this_period\\",\\"based_on\\":\\"order_items.total_sale_price\\",\\"type\\":\\"count_distinct\\",\\"label\\":\\"This Period\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\",\\"filter_expression\\":\\"matches_filter(${order_items.created_date},`30 days ago for 30 days`)\\"},{\\"measure\\":\\"last_period\\",\\"based_on\\":\\"order_items.total_gross_margin\\",\\"label\\":\\"Last Period\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\",\\"filter_expression\\":\\"matches_filter(${order_items.created_date},`60 days ago for 30 days`)\\"}]"},"desiredFilterName":"products.brand"}]},{"type":"custom filter","label":"Inventory Overview","menuCategory":"operations","description":"Overview of your inventory","icon":"fa-tshirt","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"1","isNext":false,"label":"Inventory Overview","filter":{"label":"Select Product Name","filterName":"Product Name","lookerMethod":"runInlineQuery"},"inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["products.item_name"],"query_timezone":"America/Los_Angeles"},"desiredFilterName":"products.brand","dynamicFieldLookUp":{"Inventory":[125,118,124,123,122,121],"Orders":[126,6,7,8,2,127]}}]},{"type":"custom vis","label":"Sales Calendar","menuCategory":"sales","description":"Ayeeeeeee","icon":"fa-calendar","lookerContent":[{"type":"custom vis","lookerMethod":"runInlineQuery","label":"Sales Calendar","inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_date","products.category","order_items.order_count","order_items.total_sale_price"],"query_timezone":"America/Los_Angeles"},"desiredFilterName":"products.brand","desiredFields":["order_items.order_count","order_items.total_sale_price"],"resultFormat":"json"}]},{"type":"report builder","label":"Saved Reports","menuCategory":"operations","description":"Give users the ability to explore existing reports as well as create new ones all from within your application","icon":"fa-sticky-note","lookerContent":[{"type":"folder","id":"14","label":"Saved Reports"},{"type":"explore","id":"atom_fashion::order_items","label":"Create New Report"}]},{"type":"query builder","label":"Query Builder","menuCategory":"operations","description":"Enable business users to self serve on data and answer their own questions","icon":"fa-search","lookerContent":[{"type":"explorelite","id":"explorelite","label":"Build & Run Queries","queryBody":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_month","order_items.created_date","order_items.created_week","users.city","users.state","users.country","products.category_type","products.category","products.brand","order_items.total_sale_price","order_items.total_tax_amount"],"filters":{"users.state":"","users.city":"","users.country":"","order_items.created_date":"6 months"},"limit":500},"resultFormat":"json","fieldType":{"order_items.created_month":"dimension","order_items.created_date":"dimension","order_items.created_week":"dimension","users.city":"dimension","users.state":"dimension","users.country":"dimension","products.category_type":"dimension","products.category":"dimension","products.brand":"dimension","order_items.total_sale_price":"measure","order_items.total_tax_amount":"measure"},"filterType":{"users.state":"string","users.city":"string","users.country":"string","order_items.created_date":"date"}}]}]},"vidly":{"label":"Vidly Media","vignette":{"name":"Vidly","logo":""},"layout":"right-appbar","demoComponents":[]}}')},878:function(e,t,n){var a={"./atom_logo_white.svg":879};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=878},879:function(e,t,n){e.exports=n.p+"static/media/atom_logo_white.89cfe3df.svg"},880:function(e,t,n){var a={"./atom_background1.jpg":881,"./atom_background2.jpg":882,"./atom_background3.jpg":883,"./atom_background4.jpg":884,"./atom_splash_blog.jpg":364,"./atom_splash_inventory.jpg":365,"./atom_splash_trends.jpg":366};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=880},881:function(e,t,n){e.exports=n.p+"static/media/atom_background1.9ed7593f.jpg"},882:function(e,t,n){e.exports=n.p+"static/media/atom_background2.c5efc290.jpg"},883:function(e,t,n){e.exports=n.p+"static/media/atom_background3.b9aecb61.jpg"},884:function(e,t,n){e.exports=n.p+"static/media/atom_background4.1acd6c1b.jpg"},885:function(e,t,n){var a={"./atom_logo_black.svg":886};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=885},886:function(e,t,n){e.exports=n.p+"static/media/atom_logo_black.a213ea2a.svg"},888:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(24),l=n.n(r),i=(n(433),n(15)),s=n.n(i),c=n(22),d=n(30),m=n(49),u=n(36),p=n(35),b=n(87),h=n(86),y=(n(435),n(101)),f=n(131),g=n(258),C=n(52),v=n(32),k=n(38),x=n.n(k),E=n(3),_=n(5),w=n(1028),T=n(1006),S=n(1020),j=n(1047),O=n(136),I=n(1029),N=n(1057),F=n(1040),D=n(952),P=n(891),H=n(1037),A=n(1038),R=n(1030),U=n(1031),B=n(1032),L=n(1033),$=n(1034),M=n(1035),q=n(1036),G=n(389),z=n.n(G),V=n(393),W=n(1027),Q=n(207),K=n(210),J=n(8),Y=n(948),X=n(890),Z=n(395),ee=n(953),te=n(954),ne=n(1050),ae=n(1041),oe=o.a.createContext(null),re=(n(42).validIdHelper,Object(Y.a)((function(e){return{zIndex1500:{zIndex:1500},mr12:{marginRight:12}}})));function le(e){var t=e.lookerUser,n=e.switchLookerUser,r=e.onLogoutSuccess,l=e.lookerUserAttributeBrandOptions,i=e.switchUserAttributeBrand,s=re(),c=Object(a.useContext)(oe).toggleShow,d=Object(a.useContext)(oe).userProfile,m=o.a.useState(null),u=Object(J.a)(m,2),p=u[0],b=u[1],h=o.a.useState(t.user_attributes.brand||""),y=Object(J.a)(h,2),f=y[0],g=y[1],C=function(e){b(null),null==e?r({}):"basic"===e||"advanced"===e||"premium"===e?n(e):"string"===typeof e&&(i(e),g(e))};return o.a.createElement("div",{className:"".concat(s.zIndex1500)},o.a.createElement(X.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){b(e.currentTarget)},color:"inherit"},o.a.createElement(j.a,{alt:d.name,src:d.imageUrl,className:s.mr12}),o.a.createElement(O.a,null,"string"===typeof t.permission_level?t.permission_level.charAt(0).toUpperCase()+t.permission_level.substring(1):"")),o.a.createElement(Z.a,{id:"simple-menu",anchorEl:p,keepMounted:!0,open:Boolean(p),onClose:C},o.a.createElement(ee.a,{autoFocus:!1},"Select User Level"),o.a.createElement(ee.a,{autoFocus:!1,onClick:function(){return C("basic")}},"Basic"),o.a.createElement(ee.a,{autoFocus:!1,onClick:function(){return C("advanced")}},"Advanced"),o.a.createElement(ee.a,{autoFocus:!1,onClick:function(){return C("premium")}},"Premium"),o.a.createElement(te.a,{className:s.divider}),o.a.createElement(ee.a,{onClick:function(){c()}},"Highlight Source"),o.a.createElement(te.a,{className:s.divider}),o.a.createElement(ee.a,{onClick:function(){return C(null)}},"Sign Out"),o.a.createElement(te.a,{className:s.divider}),o.a.createElement(ee.a,null,"Current brand: ",f),o.a.createElement(ee.a,null,o.a.createElement(ae.a,{id:"combo-box-usermenu",options:l,getOptionLabel:function(e){return e.label},style:{width:300},onChange:function(e){return C(e.target.innerText||"")},renderInput:function(e){return o.a.createElement(ne.a,Object.assign({},e,{label:"Change merchant brand",variant:"outlined"}))},loadingText:"Loading...",disableautofocus:"true",onKeyDown:function(e){return e.stopPropagation()}}))))}var ie=n(51),se=n(67),ce=n(64),de=n.n(ce),me=n(958),ue=n(1004),pe=n(1005),be=n(1045),he=n(959);function ye(e){var t=e.classes,n=(e.lookerContent,e.clientSideCode,e.serverSideCode,e.lookerUser);e.permissionNeededCode;return o.a.createElement(me.a,{item:!0,sm:12},Object.keys(n).length?o.a.createElement(o.a.Fragment,null,o.a.createElement(O.a,{variant:"h6",className:t.gridTitle},"Looker User Object",o.a.createElement("br",null)),o.a.createElement(fe,{code:n})):"")}function fe(e){var t=e.code;return o.a.createElement(be.a,{language:"json",style:he.a,showLineNumbers:!0},"object"===typeof t?JSON.stringify(t,!0,4):t)}var ge=n(208),Ce=n(211),ve=ge.a[500],ke=Ce.a[500],xe=(ge.a[900],Ce.a[900],ge.a[100]),Ee=Ce.a[100],_e=Object(Y.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275},maxHeight200:{maxHeight:200,height:200,overflow:"hidden"},mt30:{marginTop:30},mb30:{marginBottom:30},textCenter:{textAlign:"center"},cursorPointer:{cursor:"pointer"},border:{border:"1px solid black"},height800:{height:800},maxHeight100:{maxHeight:100,height:100},maxHeight400:{maxHeight:400,height:400},minHeight680:{minHeight:680},minHeight200:{minHeight:200,overflow:"scroll"},redNeg:{backgroundColor:xe,color:ve,fontWeight:800},greenPos:{backgroundColor:Ee,color:ke,fontWeight:800},padding30:{padding:30},mb12:{marginBottom:12},overflowScroll:{overflow:"scroll"},overflowHidden:{overflow:"hidden"},overflowVisible:{overflow:"visible"},maxHeight150:{maxHeight:150,height:150},minHeight150:{minHeight:150,overflow:"scroll"},carouselLegend:{backgroundColor:"rgb(192,192,192, .5)\t !important",fontSize:"24px !important",textAlign:"center !important",opacity:"100 !important",fontWeight:800}}}));function we(e){var t=e.children,n=e.color,r=e.height,l=e.width,i=e.margin,s=e.id,d=Object(m.a)(e,["children","color","height","width","margin","id"]),u={};return Object(a.useContext)(oe).show&&(u=Object(c.a)(Object(c.a)({},u),{},{boxShadow:"0 0 10px ".concat(n,", \n      inset 0 0 10px ").concat(n),zIndex:1e6})),r&&(u.height=r),l&&(u.width=l),i&&(u.margin=i),o.a.createElement("div",Object.assign({id:s,style:u},d),t)}function Te(e){var t=Object.assign({},e);return o.a.createElement(we,Object.assign({},t,{color:"#FF0000"}))}function Se(e){var t=Object.assign({},e);return o.a.createElement(we,Object.assign({},t,{color:"#0000FF"}))}var je=n(1049),Oe=n(259),Ie=n(42),Ne=Ie.validIdHelper,Fe=Ie.decodeHtml;function De(e){var t=e.lookerContent,n=e.classes,r=Object(a.useState)([]),l=Object(J.a)(r,2),i=l[0],c=l[1],m=Object(a.useContext)(oe),u=(m.userProfile,m.lookerUser),p={};Object(a.useEffect)((function(){(t||u)&&setTimeout((function(){return b()}),1e3)}),[t,u]);var b=function(){var e=Object(d.a)(s.a.mark((function e(){var n,a,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c([]),n=encodeURIComponent(JSON.stringify(t.inlineQuery)),e.next=4,fetch("/runinlinequery/".concat(n,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 4:return a=e.sent,e.next=7,a.json();case 7:o=e.sent,p.id=Ne("singleVisValue-".concat(t.id)),p.data=[],r=[],o.queryResults.map((function(e){if(e[t.inlineQuery.fields[0]]){var n={x:e[t.inlineQuery.fields[0]].toString(),y:e[t.inlineQuery.fields[1]]||0,change:e.change};n&&"null"!==n.y&&r.push(n)}})),p.data=[].concat(r),c([p]);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=i.length?isNaN((100*i[0].data[0].change).toFixed(2))?"":parseInt((100*i[0].data[0].change).toFixed(0))>=0?"&uarr;":"&darr;":"";return o.a.createElement(ue.a,{elevation:1,className:n.padding30},o.a.createElement("div",{className:"".concat(n.textCenter," ").concat(n.overflowHidden),style:{height:t.height}},i.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(Te,{height:150},o.a.createElement(me.a,{container:!0},o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(O.a,{variant:"body2",align:"left",color:"secondary"},t.label)),o.a.createElement(me.a,{item:!0,sm:6},o.a.createElement(O.a,{variant:"subtitle1",align:"left"},o.a.createElement("b",null,i[0].data&&i[0].data[0]?parseInt(i[0].data[0].y).toFixed(2):""))),o.a.createElement(me.a,{item:!0,sm:6},o.a.createElement(je.a,{size:"small",label:"".concat(Fe(h)," ").concat(parseInt(100*i[0].data[0].change).toFixed(0),"% "),className:isNaN((100*i[0].data[0].change).toFixed(2))?"":parseInt((100*i[0].data[0].change).toFixed(0))>=0?n.greenPos:n.redNeg,display:"inline",align:"right"}))),o.a.createElement(Oe.a,{data:i,margin:{top:25,right:25,bottom:25,left:25},xScale:{type:"time",format:"%Y-%m-%d",precision:"day"},yScale:{type:"linear",min:"auto",max:"auto",stacked:!0,reverse:!1},axisLeft:{orient:"left",tickSize:0,tickPadding:5,tickRotation:0,format:function(){return null}},axisBottom:{orient:"bottom",tickSize:0,tickPadding:5,tickRotation:0,format:function(){return null}},enablePoints:!1,enableGridX:!1,enableGridY:!1,height:100,colors:t.visColor,animate:!0}))):o.a.createElement(me.a,{item:!0,sm:12,className:"".concat(n.flexCentered),style:{height:t.height}},o.a.createElement(pe.a,{className:n.circularProgress,style:{color:"".concat(t.visColor," ")}}))))}n(358);var Pe=n(261),He=n(42),Ae=(He.validIdHelper,He.decodeHtml);function Re(e){var t=e.lookerContent,n=e.item,r=e.index,l=e.classes,i=Object(a.useState)(void 0),c=Object(J.a)(i,2),m=c[0],u=c[1],p=Object(a.useContext)(oe),b=(p.userProfile,p.lookerUser);Object(a.useEffect)((function(){n&&h()}),[n,b]);var h=function(){var e=Object(d.a)(s.a.mark((function e(){var a,o,r,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(void 0),a=n,o=encodeURIComponent(JSON.stringify(a)),e.next=5,fetch("/runinlinequery/".concat(o,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return r=e.sent,e.next=8,r.json();case 8:l=e.sent,u(l.queryResults[0]);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=m?m.change>0?"&uarr;":"&darr;":"";return o.a.createElement(me.a,{item:!0,sm:12},m?o.a.createElement(Te,null,o.a.createElement(O.a,{variant:"subtitle1",display:"inline"},"Your ",t.inlineQueriesMap[r]," category, ",o.a.createElement("b",null,m["products.category"]),", is ",m.change>0?"up ":"down "),o.a.createElement(je.a,{size:"small",label:"".concat(Ae(y)," ").concat(parseInt(100*m.change).toFixed(0),"% "),className:m.change>0?l.greenPos:l.redNeg,display:"inline"}),o.a.createElement(O.a,{variant:"subtitle1",display:"inline"},"\xa0over the past week.")):o.a.createElement("div",{style:{height:"56px"}}))}var Ue=n(42).validIdHelper;function Be(e){var t=e.lookerContent,n=e.classes,r=Object(a.useContext)(oe),l=r.userProfile,i=r.lookerUser;return Object(a.useEffect)((function(){}),[t,i]),o.a.createElement("div",{className:"".concat(n.overflowScroll),style:{height:t.height}},o.a.createElement(O.a,{variant:"h4"},"Welcome back"),o.a.createElement("br",null),o.a.createElement(O.a,{variant:"subtitle1",display:"inline"},"Hi ",o.a.createElement("b",null,l.givenName),", hope you're having a good day. Here are a few things you might want to know."),o.a.createElement("br",null),o.a.createElement(o.a.Fragment,null,t.inlineQueries.map((function(e,a){return o.a.createElement(Re,Object.assign({key:"".concat(Ue("naturalLanguage-splashPage-"+a))},{lookerContent:t,item:e,index:a,classes:n}))}))))}function Le(e){e.lookerContent;var t=e.classes,n=e.item,r=e.handleMenuItemSelect,l=Object(a.useState)(void 0),i=Object(J.a)(l,2),c=i[0],m=i[1],u=Object(a.useContext)(oe),p=(u.userProfile,u.lookerUser);Object(a.useEffect)((function(){n&&b()}),[n,p]);var b=function(){var e=Object(d.a)(s.a.mark((function e(){var t,a,o,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/getthumbnail/".concat(n.resourceType,"/").concat(n.id),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,o=new Blob([a.svg],{type:"image/svg+xml"}),r=URL.createObjectURL(o),m(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(me.a,{container:!0,alignItems:"center",spacing:3,onClick:function(){return r(n.id,1)},className:"".concat(t.cursorPointer)},c?o.a.createElement(o.a.Fragment,null,o.a.createElement(me.a,{item:!0,sm:6},o.a.createElement(Te,null,o.a.createElement("div",{className:" ".concat(t.maxHeight100," ").concat(t.textCenter," ").concat(t.cursorPointer," ").concat(t.overflowHidden)},o.a.createElement("img",{onClick:function(){return r(n.id,1)},src:c})))),o.a.createElement(me.a,{item:!0,sm:5},o.a.createElement(O.a,{variant:"subtitle1"},n.label)),o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(te.a,{className:"".concat(t.divider," ").concat(t.mb12," ").concat(t.mt12)}))):"")}var $e=n(42).validIdHelper;function Me(e){var t=e.lookerContent,n=e.classes,r=e.handleMenuItemSelect,l=Object(a.useState)([]),i=Object(J.a)(l,2);i[0],i[1];return o.a.createElement(ue.a,{elevation:1,className:n.padding30},o.a.createElement("div",{className:"".concat(n.overflowScroll),style:{height:t.height}},o.a.createElement(me.a,{container:!0,spacing:3},o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(O.a,{variant:"h6",align:"center",color:"secondary"},"Helpful Dashboards")),t.vectors.map((function(e,a){return o.a.createElement(Le,Object.assign({key:"".concat($e("vectorThumbnail-splashPage-"+a))},{lookerContent:t,item:e,classes:n,handleMenuItemSelect:r}))})))))}function qe(e){var t=e.lookerContent,n=e.classes,r=e.id,l=Object(a.useState)(0),i=Object(J.a)(l,2),s=i[0],c=i[1],d=Object(a.useContext)(oe),m=(d.userProfile,d.lookerUser);return Object(a.useEffect)((function(){de()("#".concat(r)).html(""),c(0),ie.LookerEmbedSDK.createDashboardWithId(t.id).appendTo(document.getElementById(r)).withClassName("dashboard").withClassName("splashPage").withClassName(t.id).withTheme("atom_fashion").build().connect().then((function(e){c(1)})).catch((function(e){console.error("Connection error",e)}))}),[m]),o.a.createElement(ue.a,{elevation:1,className:n.padding30},o.a.createElement("div",{className:"".concat(n.textCenter," ").concat(n.overflowVisible),style:{height:t.height}},s?"":o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(ue.a,{className:"".concat(n.card," ").concat(n.flexCentered," ").concat(n.maxHeight400," "),elevation:0},o.a.createElement(pe.a,{className:n.circularProgress}))),o.a.createElement(F.a,null,o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(Se,null,o.a.createElement("div",{className:"embedContainer splashPage",id:r,key:r}))))))}n(42).validIdHelper;function Ge(e){var t=e.lookerContent,r=e.classes,l=Object(a.useContext)(oe),i=(l.userProfile,l.lookerUser);return Object(a.useEffect)((function(){}),[t,i]),o.a.createElement("div",{className:"".concat(r.overflowScroll),style:{height:t.height}},o.a.createElement(Pe.Carousel,{infiniteLoop:!0,autoPlay:!0,showThumbs:!1},o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:n(364)}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},"Blog")),o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:n(365)}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},"Inventory Best Practices")),o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:n(366)}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},"Macro Trends"))))}var ze=n(42).validIdHelper;function Ve(e){var t=Object(a.useState)(0),n=Object(J.a)(t,2),r=(n[0],n[1],Object(a.useState)(1)),l=Object(J.a)(r,2),i=l[0],s=(l[1],Object(a.useState)("")),c=Object(J.a)(s,2),d=c[0],m=c[1],u=Object(a.useState)(""),p=Object(J.a)(u,2),b=p[0],h=(p[1],_e()),y=(e.staticContent,e.staticContent.lookerContent),f=e.staticContent.type,g=(e.handleTabChange,e.handleMenuItemSelect),C=e.lookerUser,k=[Object(v.a)(y)],x=f||"code flyout";return Object(a.useEffect)((function(){m("//imports\nimport $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport { AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, Divider } from '@material-ui/core'\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./SplashPage.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport { SingleValueVis } from './SingleValueVis';\nimport { Welcome } from './Welcome';\nimport { PopularAnalysis } from './PopularAnalysis';\nimport { EmbeddedLook } from './EmbeddedLook';\nimport { EmbeddedDashboard } from './EmbeddedDashboard';\nimport { ContentCarousel } from './ContentCarousel';\nconst { validIdHelper } = require('../../../tools');\n\n//start of SplashPage Component\nexport default function SplashPage(props) {\n  // console.log('SplashPage')\n  //intialize state using hooks\n  const [value, setValue] = useState(0);\n  const [iFrameExists, setIFrame] = useState(1);\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n\n  //declare constants\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, handleTabChange, handleMenuItemSelect, lookerUser } = props;\n  const codeTab = {\n    type: 'code flyout', label: 'Code', id: 'codeFlyout',\n    lookerContent, lookerUser, clientSideCode, serverSideCode\n  }\n  // const tabContent = [[...lookerContent], codeTab];\n  const tabContent = [[...lookerContent]];\n  const demoComponentType = type || 'code flyout';\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  /**\n   * listen for lookerContent and call \n   * setSampleCode\n  */\n  useEffect(() => {\n    // console.log('useEffect')\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent]);\n\n\n  /**\n   * What this return  does:\n   * Rendering of actual html elements,\n   * this section is necessary but less relevant to looker functionality itself\n   */\n  return (\n    <div className={`${classes.root} ${classes.minHeight680} ${classes.padding30} demoComponent`}>\n      <Grid container\n        spacing={3}\n        key={validIdHelper(type)} >\n        <div className={classes.root}>\n          {iFrameExists ? '' :\n            <Grid item sm={12} >\n              <Card className={`${classes.card} ${classes.flexCentered}`}>\n                <CircularProgress className={classes.circularProgress} />\n              </Card>\n            </Grid>\n          }\n          <Box className={iFrameExists ? `` : `${classes.hidden}`}>\n            <Box className=\"tabPanelContainer\">\n              {tabContent.map((tabContentItem, index) => {\n                return <Grid container\n                  spacing={3}\n                  key={`${validIdHelper(demoComponentType + '-gridContainer-' + index)}`}\n                >\n                  {tabContentItem.type === 'code flyout' ?\n                    <CodeFlyout {...props}\n                      classes={classes}\n                      lookerContent={lookerContent}\n                      clientSideCode={clientSideCode}\n                      serverSideCode={serverSideCode}\n                      lookerUser={lookerUser} />\n                    :\n                    <React.Fragment\n                      key={`${validIdHelper(demoComponentType + '-outerFragment-' + index)}`}>\n                      {tabContentItem.map((lookerContent, innerIndex) => {\n                        return (\n                          <Grid\n                            key={`${validIdHelper(demoComponentType + '-innerFragment-' + innerIndex)}`}\n                            item\n                            sm={parseInt(lookerContent.gridWidth)}\n                          >\n                            {/* <Card className={classes.padding30}> */}\n                            {(lookerContent.type === 'welcome') && <Welcome\n                              {...{ lookerContent, classes, demoComponentType }}\n                            />}\n                            {(lookerContent.type === 'carousel') && <ContentCarousel\n                              {...{ lookerContent, classes, demoComponentType }}\n                            />}\n                            {(lookerContent.type === 'single value') && <SingleValueVis\n                              {...{ lookerContent, classes, demoComponentType }}\n                            />}\n                            {(lookerContent.type === 'dashboard') && <EmbeddedDashboard\n                              {...{ lookerContent, classes }} id={validIdHelper(`embedContainer-${demoComponentType}-${lookerContent.id}`)}\n                            />}\n                            {(lookerContent.type === 'popular analysis') && <PopularAnalysis\n                              {...{ lookerContent, classes, demoComponentType, handleMenuItemSelect }}\n                            />}\n                          </Grid>\n                        )\n                      })}\n                    </React.Fragment>\n                  }\n                </Grid>\n                // </TabPanel>\n              })}\n            </Box>\n          </Box >\n        </div >\n      </Grid >\n    </div >\n  )\n}")}),[y]),o.a.createElement("div",{className:"".concat(h.root," ").concat(h.minHeight680," ").concat(h.padding30," demoComponent")},o.a.createElement(me.a,{container:!0,spacing:3,key:ze(f)},o.a.createElement("div",{className:h.root},i?"":o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(ue.a,{className:"".concat(h.card," ").concat(h.flexCentered)},o.a.createElement(pe.a,{className:h.circularProgress}))),o.a.createElement(F.a,{className:i?"":"".concat(h.hidden)},o.a.createElement(F.a,{className:"tabPanelContainer"},k.map((function(t,n){return o.a.createElement(me.a,{container:!0,spacing:3,key:"".concat(ze(x+"-gridContainer-"+n))},"code flyout"===t.type?o.a.createElement(ye,Object.assign({},e,{classes:h,lookerContent:y,clientSideCode:d,serverSideCode:b,lookerUser:C})):o.a.createElement(o.a.Fragment,{key:"".concat(ze(x+"-outerFragment-"+n))},t.map((function(e,t){return o.a.createElement(me.a,{key:"".concat(ze(x+"-innerFragment-"+t)),item:!0,sm:parseInt(e.gridWidth)},"welcome"===e.type&&o.a.createElement(Be,{lookerContent:e,classes:h,demoComponentType:x}),"carousel"===e.type&&o.a.createElement(Ge,{lookerContent:e,classes:h,demoComponentType:x}),"single value"===e.type&&o.a.createElement(De,{lookerContent:e,classes:h,demoComponentType:x}),"dashboard"===e.type&&o.a.createElement(qe,Object.assign({lookerContent:e,classes:h},{id:ze("embedContainer-".concat(x,"-").concat(e.id))})),"popular analysis"===e.type&&o.a.createElement(Me,{lookerContent:e,classes:h,demoComponentType:x,handleMenuItemSelect:g}))}))))})))))))}var We=n(1042),Qe=n(1007),Ke=n(1058),Je=n(1008),Ye=Object(Y.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275,minHeight:800}}}));function Xe(e){var t=e.children,n=e.value,a=e.index,r=Object(m.a)(e,["children","value","index"]);return o.a.createElement(O.a,Object.assign({component:"div",role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),o.a.createElement(F.a,{p:3},t))}function Ze(e){var t=e.val,n=e.positive_good,a=(e.abs_val,{up:n?"green":"red",down:n?"red":"green"}),r=t<0?a.down:t>0?a.up:"black",l=Math.abs(t).toLocaleString("en",{style:"percent",minimumFractionDigits:2}),i=t<0?"\u25bc":t>0?"\u25b2":"\u2014";return o.a.createElement(o.a.Fragment,null,o.a.createElement("font",{color:r},"".concat(i," ").concat(l)))}var et=n(42).validIdHelper;function tt(e){var t=Object(a.useState)(0),n=Object(J.a)(t,2),r=n[0],l=n[1],i=Object(a.useState)(0),m=Object(J.a)(i,2),u=m[0],p=m[1],b=Object(a.useState)([]),h=Object(J.a)(b,2),y=h[0],f=h[1],g=Object(a.useState)({}),k=Object(J.a)(g,2),E=k[0],_=k[1],w=Object(a.useState)(""),S=Object(J.a)(w,2),j=S[0],O=S[1],I=Object(a.useState)(""),N=Object(J.a)(I,2),D=N[0],P=N[1],H=Object(a.useState)(""),A=Object(J.a)(H,2),R=A[0],U=A[1],B=Object(a.useState)({}),L=Object(J.a)(B,2),$=L[0],M=L[1],q=(Object(a.useContext)(oe).togglePayWallModal,Ye()),G=e.staticContent.lookerContent,z=e.staticContent.type,V=(e.activeTabValue,e.handleTabChange),W=e.lookerUser,Q={type:"code flyout",label:"Code",id:"codeFlyout",lookerContent:G,lookerUser:W,clientSideCode:j,serverSideCode:D},K=[].concat(Object(v.a)(G),[Q]),Y=z||"code flyout",X=function(e,t){U(t);var n=x.a.filter($.dashboard_layout_components,(function(e){return G[0].dynamicFieldLookUp[t].indexOf(e.dashboard_element_id)>-1})),a=Object(c.a)(Object(c.a)({},$),{},{dashboard_layout_components:n});E.setOptions({layouts:[a]})};Object(a.useEffect)((function(){setTimeout((function(){return Z(Object(v.a)(G))}),1e3),O("import $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport { AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, TextField } from '@material-ui/core'\nimport { Autocomplete, ToggleButton, ToggleButtonGroup } from '@material-ui/lab'\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./Dashboard.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport { ApiHighlight, EmbedHighlight } from '../../Highlights/Highlight';\nimport { NumberToColoredPercent } from '../../Accessories/NumberToColoredPercent';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of Dashboard Component\nexport default function Dashboard(props) {\n  // console.log('Dashboard')\n  //initialize state using hooks\n  const [value, setValue] = useState(0);\n  const [iFrameExists, setIFrame] = useState(0);\n  const [apiContent, setApiContent] = useState([]);\n  const [dashboardObj, setDashboardObj] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const [toggleValue, setToggleValue] = useState('');\n  const [dashboardLayout, setDashboardLayout] = useState({});\n  const { togglePayWallModal } = useContext(AppContext)\n\n  //declare constants\n  const classes = useStyles();\n  const { staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser } = props;\n  const codeTab = {\n    type: 'code flyout', label: 'Code', id: 'codeFlyout',\n    lookerContent, lookerUser, clientSideCode, serverSideCode\n  }\n  const tabContent = [...lookerContent, codeTab];\n  const demoComponentType = type || 'code flyout';\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  const handleToggle = (event, newValue) => {\n    setToggleValue(newValue)\n    const filteredLayout = _.filter(dashboardLayout.dashboard_layout_components, (row) => {\n      return (lookerContent[0].dynamicFieldLookUp[newValue].indexOf(row.dashboard_element_id) > -1)\n    })\n    const newDashboardLayout = {\n      ...dashboardLayout,\n      dashboard_layout_components: filteredLayout\n    }\n    dashboardObj.setOptions({ \"layouts\": [newDashboardLayout] })\n  };\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    // console.log('validIdHelper(demoComponentType + lookerContent[0].id)', validIdHelper(demoComponentType + lookerContent[0].id))\n    // if (validIdHelper(demoComponentType + lookerContent[0].id) === selectedMenuItem) {\n    setTimeout(() => performLookerApiCalls([...lookerContent]), 1000)\n    setClientSideCode(rawSampleCode)\n    // }\n  }, [lookerContent, lookerUser]);\n\n\n  useEffect(() => {\n    if (Object.keys(dashboardLayout).length && Object.keys(dashboardObj).length && lookerContent[0].dynamicFieldLookUp) {\n      handleToggle(null, Object.keys(lookerContent[0].dynamicFieldLookUp)[0])\n    }\n  }, [dashboardLayout]);\n\n  /** \n   * What this function does:\n   * iterate over Looker Content array referenced above and\n   * calls specific endpoints and methods available from Looker Node SDK\n   * and embed SDK to create the experience on this page\n   */\n  const performLookerApiCalls = function (lookerContent) {\n    // console.log('performLookerApiCalls')\n    $(`.embedContainer.${validIdHelper(demoComponentType)}:visible`).html('')\n    setIFrame(0)\n    setApiContent([])\n    lookerContent.map(async lookerContent => {\n      // console.log('lookerContent map')\n      let dashboardId = lookerContent.id;\n      // console.log('dashboardId ', dashboardId)\n      // console.log('embed container exists??', $('#' + validIdHelper(`embedContainer-${demoComponentType}-${dashboardId}`)).length)\n      // console.log('embed container html??', $('#' + validIdHelper(`embedContainer-${demoComponentType}-${dashboardId}`)).html())\n\n\n      //how can test to see if it has content???\n      LookerEmbedSDK.createDashboardWithId(dashboardId)\n        .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${dashboardId}`))\n        .withClassName('iframe')\n        .withNext()\n        // .withNext(lookerContent.isNext || false) //how can I make this dynamic based on prop??\n        .withTheme('atom_fashion')\n        .withParams({ 'schedule_modal': 'true' })\n        .on('page:property:change', (event) => {\n          // console.log('page property is changing!!!!')\n          changeHeight(event)\n        }) // dashboards-next\n        .on('dashboard:loaded', (event) => {\n          setDashboardLayout(event.dashboard.options.layouts[0])\n        })\n        // .on('drillmenu:click', (event) => {\n        //   drillMenuClick(event)\n        // })\n        .build()\n        .connect()\n        .then((dashboard) => {\n          setIFrame(1)\n          setDashboardObj(dashboard)\n        })\n        .catch((error) => {\n          // console.error('Connection error', error)\n        })\n\n      if (lookerContent.hasOwnProperty('filter')) {\n        //get inline query from usecase file & set user attribute dynamically\n        let jsonQuery = lookerContent.inlineQuery;\n        jsonQuery.filters = {\n          ...jsonQuery.filters,\n          [lookerContent.desiredFilterName]: lookerUser.user_attributes.brand\n        };\n        lookerContent.inlineQuery = jsonQuery;\n        let stringifiedQuery = encodeURIComponent(JSON.stringify(lookerContent.inlineQuery))\n        let lookerResponse = await fetch('/runinlinequery/' + stringifiedQuery + '/json', {\n          method: 'GET',\n          headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json'\n          }\n        })\n        let lookerResponseData = await lookerResponse.json();\n        let queryResultsForDropdown = [];\n        let desiredProperty = Object.keys(lookerResponseData.queryResults[0])[0];\n        for (let i = 0; i < lookerResponseData.queryResults.length; i++) {\n          queryResultsForDropdown.push({\n            'label': lookerResponseData.queryResults[i][desiredProperty],\n            'trend': (lookerResponseData.queryResults[i]['trend']) ? lookerResponseData.queryResults[i]['trend'] : undefined\n          })\n        }\n        setApiContent(queryResultsForDropdown);\n        if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n      }\n    })\n  }\n\n  /**\n   * update dashboard when custom filter changed\n  */\n  const customFilterAction = (dashboardId, filterName, newFilterValue) => {\n    if (Object.keys(dashboardObj).length) {\n      dashboardObj.updateFilters({ [filterName]: newFilterValue })\n      dashboardObj.run()\n    }\n  }\n\n  // const drillMenuClick = (event) => {\n\n  //   const basicLookerUser = lookerUser.permission_level === 'basic' ? true : false;\n  //   if (basicLookerUser) {\n  //     togglePayWallModal()\n  //     return { cancel: (basicLookerUser) ? true : false }\n  //   }\n  // }\n\n  const changeHeight = (event) => {\n    // console.log('changeHeight')\n    // console.log('event', event)\n  }\n\n  /**\n   * What this return  does:\n   * Rendering of actual html elements,\n   * this section is necessary but less relevant to looker functionality itself\n   */\n  return (\n    <div className={`${classes.root} demoComponent`}>\n      <Grid container\n        spacing={3}\n        key={validIdHelper(type)} >\n        <div className={classes.root}>\n          {iFrameExists ? '' :\n            <Grid item sm={12} >\n              <Card className={`${classes.card} ${classes.flexCentered}`}>\n                <CircularProgress className={classes.circularProgress} />\n              </Card>\n            </Grid>\n          }\n\n          {/* additional loading logic, need embedContainer to exist but want it hidden until iFrame has content...*/}\n          <Box className={iFrameExists ? `` : `${classes.hidden}`}>\n            <AppBar position=\"static\">\n              <Tabs\n                className={classes.tabs}\n                value={value}\n                onChange={handleChange}\n                aria-label=\"simple tabs example\">\n                {tabContent.map((item, index) => (\n                  <Tab\n                    key={`${validIdHelper(demoComponentType + '-tab-' + index)}`}\n                    label={item.label}\n                    className={item.type === 'code flyout' ? `${classes.mlAuto}` : ``}\n                    {...a11yProps(index)} />\n                ))}\n              </Tabs>\n            </AppBar>\n            <Box className=\"tabPanelContainer\">\n              {tabContent.map((tabContentItem, index) => (\n                <TabPanel\n                  key={`${validIdHelper(demoComponentType + '-tabPanel-' + index)}`}\n                  value={value}\n                  index={index}>\n                  <Grid container>\n                    {tabContentItem.type === 'code flyout' ?\n                      // could this go to home/parent component\n                      // so it's not in the demo component itself whatsoever\n                      <CodeFlyout {...props}\n                        classes={classes}\n                        lookerContent={lookerContent}\n                        clientSideCode={clientSideCode}\n                        serverSideCode={serverSideCode}\n                        lookerUser={lookerUser} />\n                      :\n                      <React.Fragment\n                        key={`${validIdHelper(demoComponentType + '-innerFragment-' + index)}`}>\n                        {tabContentItem.filter ?\n\n                          <Grid item sm={6}>\n                            <ApiHighlight>\n                              <Autocomplete\n                                id={`combo-box-dashboard-${lookerContent.id}`}\n                                options={Array.isArray(apiContent) ?\n                                  apiContent :\n                                  []}\n                                renderOption={(option) => (\n                                  <Grid container justify=\"space-between\">\n                                    <Grid item>\n                                      {option.label}\n                                    </Grid>\n                                    {option.trend && <Grid item>\n                                      <NumberToColoredPercent\n                                        val={option.trend}\n                                        positive_good={true}\n                                        abs_val={Math.abs(option.trend)}\n                                      />\n                                    </Grid>}\n                                  </Grid>\n                                )}\n                                getOptionLabel={(option) => option.label}\n                                style={{ width: 400 }}\n                                onChange={(event, newValue) => {\n                                  customFilterAction(tabContentItem.id, tabContentItem.filter.filterName, (newValue) ? newValue.label : '')\n                                }}\n                                renderInput={(params) => <TextField {...params} label={tabContentItem.filter.filterName} variant=\"outlined\" />}\n                                loadingText=\"Loading...\"\n                              />\n                            </ApiHighlight>\n                          </Grid> : ''\n                        }\n                        {tabContentItem.dynamicFieldLookUp ?\n                          <Grid item sm={6}>\n                            <ApiHighlight>\n                              <ToggleButtonGroup\n                                value={toggleValue}\n                                exclusive\n                                onChange={handleToggle}\n                                aria-label=\"text alignment\"\n                              >\n                                {Object.keys(tabContentItem.dynamicFieldLookUp).map(key => {\n                                  return (\n                                    <ToggleButton\n                                      key={validIdHelper(`dynamicDashToggle-${key}`)}\n                                      value={key} aria-label=\"left aligned\">\n                                      {key}\n                                    </ToggleButton>\n                                  )\n                                })}\n                              </ToggleButtonGroup>\n                            </ApiHighlight>\n                          </Grid>\n                          : ''\n                        }\n                        <Box className={classes.w100} mt={2}>\n                          <Grid item sm={12}>\n                            <EmbedHighlight>\n                              <div\n                                className={`embedContainer ${validIdHelper(demoComponentType)}`}\n                                id={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                key={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                              >\n                              </div>\n                            </EmbedHighlight>\n                          </Grid>\n                        </Box>\n                      </React.Fragment>\n                    }\n                  </Grid>\n                </TabPanel>\n              ))}\n            </Box>\n          </Box >\n        </div>\n      </Grid >\n    </div >\n  )\n}")}),[G,W]),Object(a.useEffect)((function(){Object.keys($).length&&Object.keys(E).length&&G[0].dynamicFieldLookUp&&X(0,Object.keys(G[0].dynamicFieldLookUp)[0])}),[$]);var Z=function(e){de()(".embedContainer.".concat(et(Y),":visible")).html(""),p(0),f([]),e.map(function(){var e=Object(d.a)(s.a.mark((function e(t){var n,a,o,r,l,i,d,m;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.id,ie.LookerEmbedSDK.createDashboardWithId(n).appendTo(et("#embedContainer-".concat(Y,"-").concat(n))).withClassName("iframe").withNext().withTheme("atom_fashion").withParams({schedule_modal:"true"}).on("page:property:change",(function(e){ee(e)})).on("dashboard:loaded",(function(e){M(e.dashboard.options.layouts[0])})).build().connect().then((function(e){p(1),_(e)})).catch((function(e){})),!t.hasOwnProperty("filter")){e.next=18;break}return(a=t.inlineQuery).filters=Object(c.a)(Object(c.a)({},a.filters),{},Object(C.a)({},t.desiredFilterName,W.user_attributes.brand)),t.inlineQuery=a,o=encodeURIComponent(JSON.stringify(t.inlineQuery)),e.next=9,fetch("/runinlinequery/"+o+"/json",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 9:return r=e.sent,e.next=12,r.json();case 12:for(l=e.sent,i=[],d=Object.keys(l.queryResults[0])[0],m=0;m<l.queryResults.length;m++)i.push({label:l.queryResults[m][d],trend:l.queryResults[m].trend?l.queryResults[m].trend:void 0});f(i),0===D.length&&P(l.code);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},ee=function(e){};return o.a.createElement("div",{className:"".concat(q.root," demoComponent")},o.a.createElement(me.a,{container:!0,spacing:3,key:et(z)},o.a.createElement("div",{className:q.root},u?"":o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(ue.a,{className:"".concat(q.card," ").concat(q.flexCentered)},o.a.createElement(pe.a,{className:q.circularProgress}))),o.a.createElement(F.a,{className:u?"":"".concat(q.hidden)},o.a.createElement(T.a,{position:"static"},o.a.createElement(We.a,{className:q.tabs,value:r,onChange:function(e,t){V(0),l(t)},"aria-label":"simple tabs example"},K.map((function(e,t){return o.a.createElement(Qe.a,Object.assign({key:"".concat(et(Y+"-tab-"+t)),label:e.label,className:"code flyout"===e.type?"".concat(q.mlAuto):""},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)))})))),o.a.createElement(F.a,{className:"tabPanelContainer"},K.map((function(t,n){return o.a.createElement(Xe,{key:"".concat(et(Y+"-tabPanel-"+n)),value:r,index:n},o.a.createElement(me.a,{container:!0},"code flyout"===t.type?o.a.createElement(ye,Object.assign({},e,{classes:q,lookerContent:G,clientSideCode:j,serverSideCode:D,lookerUser:W})):o.a.createElement(o.a.Fragment,{key:"".concat(et(Y+"-innerFragment-"+n))},t.filter?o.a.createElement(me.a,{item:!0,sm:6},o.a.createElement(Te,null,o.a.createElement(ae.a,{id:"combo-box-dashboard-".concat(G.id),options:Array.isArray(y)?y:[],renderOption:function(e){return o.a.createElement(me.a,{container:!0,justify:"space-between"},o.a.createElement(me.a,{item:!0},e.label),e.trend&&o.a.createElement(me.a,{item:!0},o.a.createElement(Ze,{val:e.trend,positive_good:!0,abs_val:Math.abs(e.trend)})))},getOptionLabel:function(e){return e.label},style:{width:400},onChange:function(e,n){var a,o;t.id,a=t.filter.filterName,o=n?n.label:"",Object.keys(E).length&&(E.updateFilters(Object(C.a)({},a,o)),E.run())},renderInput:function(e){return o.a.createElement(ne.a,Object.assign({},e,{label:t.filter.filterName,variant:"outlined"}))},loadingText:"Loading..."}))):"",t.dynamicFieldLookUp?o.a.createElement(me.a,{item:!0,sm:6},o.a.createElement(Te,null,o.a.createElement(Ke.a,{value:R,exclusive:!0,onChange:X,"aria-label":"text alignment"},Object.keys(t.dynamicFieldLookUp).map((function(e){return o.a.createElement(Je.a,{key:et("dynamicDashToggle-".concat(e)),value:e,"aria-label":"left aligned"},e)}))))):"",o.a.createElement(F.a,{className:q.w100,mt:2},o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(Se,null,o.a.createElement("div",{className:"embedContainer ".concat(et(Y)),id:et("embedContainer-".concat(Y,"-").concat(t.id)),key:et("embedContainer-".concat(Y,"-").concat(t.id))})))))))})))))))}var nt=n(1053),at=n(1016),ot=n(1017),rt=n(957),lt=n(1052),it=n(1044),st=n(1015),ct=n(130),dt=n.n(ct),mt=n(1046),ut=n(1010),pt=n(1014),bt=n(1013),ht=n(1009),yt=n(1011),ft=n(1012),gt=n(397),Ct=n(42),vt=Ct.validIdHelper,kt=Ct.prettifyString,xt=Object(Y.a)((function(e){return{paper:{position:"absolute",width:800,maxHeight:450,overflow:"scroll",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},table:{maxHeight:310},card:{minWidth:275,minHeight:"10rem",boxShadow:"none"},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"}}}));function Et(){return{top:"".concat(50,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(50,"%)")}}function _t(e){var t=xt(),n=e.open,a=e.onClose,r=e.modalContent,l=o.a.useState(Et),i=Object(J.a)(l,1)[0];return o.a.createElement(mt.a,{open:n,onClose:a,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:i,className:t.paper},o.a.createElement("h2",{id:"simple-modal-title"},r.title),r.body?o.a.createElement(ht.a,{component:gt.a,className:t.table},o.a.createElement(ut.a,{stickyHeader:!0,className:t.table,size:"small","aria-label":"a dense table"},o.a.createElement(yt.a,null,o.a.createElement(ft.a,null,Object.keys(r.body[0]).map((function(e,t){return o.a.createElement(bt.a,{align:"right",key:vt(e+"-TableHead-TableCell-"+t),id:vt(e+"-TableHead-TableCell-"+t)},kt(e.substring(e.lastIndexOf(".")+1,e.length)))})))),o.a.createElement(pt.a,null,r.body.map((function(e,t){return o.a.createElement(ft.a,{key:vt("TableRow-"+t),id:vt("TableRow-"+t)},Object.keys(e).map((function(e){return o.a.createElement(bt.a,{align:"right",key:vt(e+"-TableBody-TableCell-"+t),id:vt(e+"-TableBody-TableCell-"+t)},r.body[t][e]?r.body[t][e].rendered?r.body[t][e].rendered:r.body[t][e].value?r.body[t][e].value:"number"===typeof r.body[t][e]?Math.round(100*r.body[t][e])/100:r.body[t][e]:"")})))}))))):o.a.createElement(ue.a,{className:"".concat(t.card," ").concat(t.flexCentered)},o.a.createElement(pe.a,{className:t.circularProgress}))))}var wt=n(385),Tt=Object(Y.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},card:{minWidth:275,minHeight:800},height500:{height:500},height700:{height:700},height800:{height:800},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)},skeleton:{height:200,width:"100%"}}}));function St(e){var t=e.children,n=e.value,a=e.index,r=Object(m.a)(e,["children","value","index"]);return o.a.createElement(O.a,Object.assign({component:"div",role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),o.a.createElement(F.a,{p:3},t))}var jt=n(394),Ot=n(272),It=n(276),Nt=n(41),Ft=n(1039),Dt=n(42).validIdHelper;function Pt(e){var t=Object(a.useState)(0),n=Object(J.a)(t,2),r=n[0],l=n[1],i=Object(a.useState)(""),m=Object(J.a)(i,2),u=m[0],p=m[1],b=Object(a.useState)(""),h=Object(J.a)(b,2),y=h[0],f=h[1],g=Object(a.useState)("All"),k=Object(J.a)(g,2),E=k[0],_=k[1],w=Object(a.useState)(""),S=Object(J.a)(w,2),j=S[0],O=S[1],I=Object(a.useState)([]),N=Object(J.a)(I,2),D=N[0],P=N[1],H=o.a.useState(!1),A=Object(J.a)(H,2),R=A[0],U=A[1],B=Object(a.useState)({}),L=Object(J.a)(B,2),$=L[0],M=L[1],q=Object(a.useState)(""),G=Object(J.a)(q,2),z=G[0],V=G[1],W=Object(a.useState)(""),Q=Object(J.a)(W,2),K=Q[0],Y=Q[1],X=Object(a.useContext)(oe).togglePayWallModal,Z=Tt(),ee=(e.staticContent,e.staticContent.lookerContent),ne=e.staticContent.type,ae=(e.activeTabValue,e.handleTabChange),re=e.lookerUser,le=(e.lookerHost,{type:"code flyout",label:"Code",id:"codeFlyout",lookerContent:ee,lookerUser:re,clientSideCode:z,serverSideCode:K}),ie=[].concat(Object(v.a)(ee),[le]),se=ne||"code flyout",ce=function(){var e=Object(d.a)(s.a.mark((function e(t){var n,a,o,r,l,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.day,(o=JSON.parse(JSON.stringify(ee[0].inlineQuery))).filters=Object(c.a)(Object(c.a)({},o.filters),{},(n={},Object(C.a)(n,o.fields[0],a),Object(C.a)(n,o.fields[1],"All"===E?"":E),n)),o.total=!0,o.limit="25",U(!0),e.next=8,fetch("/runinlinequery/"+encodeURIComponent(JSON.stringify(o))+"/json",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 8:return r=e.sent,e.next=11,r.json();case 11:l=e.sent,i={title:"Detail View for ".concat(a),body:l.queryResults},M(i);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de=function(e){if(Date.parse(e)>0){var t=Object(jt.a)(Object(Ot.a)(new Date(e),1),"yyyy-MM-dd");p(t)}},be=function(e){if(Date.parse(e)>0){var t=Object(jt.a)(Object(Ot.a)(new Date(e),1),"yyyy-MM-dd");f(t)}},he=function(e){_(e)},fe=function(e){O(e)},ge=[];if(D.queryResults&&D.queryResults&&(ge=(ge=x.a.filter(D.queryResults,(function(e){return e[D.inlineQuery.fields[0]]>=u&&e[D.inlineQuery.fields[0]]<y&&("All"===E||e[D.inlineQuery.fields[1]]===E)}))).map((function(e){return{day:e[D.inlineQuery.fields[0]],category:e[D.inlineQuery.fields[1]],value:e[j]}})),"All"===E)){var Ce=Object(v.a)(new Set(ge.map((function(e){return e.day})))),ve=[];Ce.map((function(e){var t=x.a.filter(ge,(function(t){return t.day===e})).reduce((function(e,t){return e+t.value}),0),n={day:e,value:t,category:"All"};ve.push(n)})),ge=ve}Object(a.useEffect)((function(){ee.length&&(setTimeout((function(){return ke(ee)}),100),O(ee[0].desiredFields[0]),V("import _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, TextField,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails, Divider, InputLabel, MenuItem,\n  FormControl, Select, Modal\n} from '@material-ui/core'\nimport { Skeleton } from '@material-ui/lab';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ModalTable from '../../Material/ModalTable';\nimport { ResponsiveCalendar } from '@nivo/calendar'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./CustomVis.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport { ApiHighlight } from '../../Highlights/Highlight';\n\n//new date pickers\nimport { format, endOfDay, addDays } from 'date-fns';\n// import React from 'react';\n// import Grid from '@material-ui/core/Grid';\nimport DateFnsUtils from '@date-io/date-fns';\nimport {\n  MuiPickersUtilsProvider,\n  KeyboardTimePicker,\n  KeyboardDatePicker,\n} from '@material-ui/pickers';\n\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of Custom Viz Calendar Component\nexport default function CustomVis(props) {\n  // console.log('CustomVis')\n  //initialize state using hooks\n  const [value, setValue] = useState(0);\n  const [fromDate, setFromDate] = useState('');\n  const [toDate, setToDate] = useState('');\n  const [category, setCategory] = useState('All')\n  const [desiredField, setDesiredField] = useState('')\n  const [apiContent, setApiContent] = useState([]);\n  const [open, setOpen] = React.useState(false);\n  const [modalContent, setModalContent] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n\n  const { togglePayWallModal } = useContext(AppContext)\n\n  //declare constants\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser, lookerHost } = props;\n  const codeTab = {\n    type: 'code flyout', label: 'Code', id: 'codeFlyout',\n    lookerContent, lookerUser, clientSideCode, serverSideCode\n  }\n  const tabContent = [...lookerContent, codeTab]\n  const demoComponentType = type || 'code flyout';\n\n  //handle opening of modal for advanced and premium users\n  const handleModalOpen = async ({ day }) => {\n    let originalInlineQueryCopy = JSON.parse(JSON.stringify(lookerContent[0].inlineQuery));\n    originalInlineQueryCopy.filters = {\n      ...originalInlineQueryCopy.filters,\n      [originalInlineQueryCopy.fields[0]]: day,\n      [originalInlineQueryCopy.fields[1]]: category === \"All\" ? '' : category\n    }\n    originalInlineQueryCopy.total = true;\n    originalInlineQueryCopy.limit = \"25\";\n\n    setOpen(true);\n    let lookerResponse = await fetch('/runinlinequery/' + encodeURIComponent(JSON.stringify(originalInlineQueryCopy)) + '/json', {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n    let lookerResponseData = await lookerResponse.json();\n    let modalObj = {\n      \"title\": `Detail View for ${day}`,\n      \"body\": lookerResponseData.queryResults\n    }\n    setModalContent(modalObj);\n  };\n\n  //handle modal close\n  const handleModalClose = () => {\n    setModalContent({})\n    setOpen(false);\n  };\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  const handleFromDate = newValue => {\n    let validDate = Date.parse(newValue);\n    if (validDate > 0) {\n      let newValueAsDate = format(addDays(new Date(newValue), 1), 'yyyy-MM-dd');\n      setFromDate(newValueAsDate);\n    }\n  }\n  const handleToDate = newValue => {\n    let validDate = Date.parse(newValue);\n    if (validDate > 0) {\n      let newValueAsDate = format(addDays(new Date(newValue), 1), 'yyyy-MM-dd');\n      setToDate(newValueAsDate);\n    }\n  }\n  const handleCategory = newValue => {\n    setCategory(newValue)\n  }\n  const handleDesiredField = newValue => {\n    setDesiredField(newValue)\n  }\n\n  //format response from initial api call based on LookerContent array\n  //to match format required by Nivo Calendar component\n  let filterData = [];\n  if (apiContent.queryResults && apiContent.queryResults) {\n    //filtering for fromDate, toDate and category\n    filterData = _.filter(apiContent.queryResults, (row) => {\n      return (row[apiContent.inlineQuery.fields[0]] >= fromDate\n        && row[apiContent.inlineQuery.fields[0]] < toDate\n        && (category === 'All' ? true : row[apiContent.inlineQuery.fields[1]] === category)\n      )\n    })\n    //converting filterDAta to desired format for vis\n    filterData = filterData.map(item => {\n      return {\n        'day': item[apiContent.inlineQuery.fields[0]],\n        'category': item[apiContent.inlineQuery.fields[1]],\n        'value': item[desiredField]\n      }\n    })\n\n    //special exception for category all\n    //need to reduce array by day across categories\n    //destructuing in reduce of value would not work for dynamic var\n    if (category === 'All') {\n      //create array of all unique dates\n      const uniqueDates = [...new Set(filterData.map(item => item.day))];\n      let filteredAndReducedForAll = []\n      //iterate over unique date\n      uniqueDates.map(uniqueDate => {\n        //filter filterData for current unique date\n        let value = _.filter(filterData, row => {\n          return row.day === uniqueDate\n        }).reduce((acc, { value }) => acc + value, 0)\n        let thisObj = {\n          day: uniqueDate,\n          value: value,\n          category: 'All'\n        }\n        filteredAndReducedForAll.push(thisObj)\n\n      })\n      filterData = filteredAndReducedForAll;\n    }\n  }\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    if (lookerContent.length) {\n      setTimeout(() => performLookerApiCalls(lookerContent), 100);\n      setDesiredField(lookerContent[0].desiredFields[0])\n      setClientSideCode(rawSampleCode)\n    }\n  }, [lookerContent, lookerUser])\n\n  /** \n   * What this function does:\n   * iterate over Looker Content array referenced above and\n   * calls specific endpoints and methods available from Looker Node SDK\n   * and embed SDK to create the experience on this page\n   */\n  const performLookerApiCalls = function (lookerContent) {\n    // console.log('performLookerApiCalls')\n    setApiContent([]); //set to empty array to show progress bar and skeleton\n    lookerContent.map(async lookerContent => {\n      let inlineQuery = lookerContent.inlineQuery;\n      inlineQuery.filters = {\n        // ...inlineQuery.filters,\n        // [Object.keys(inlineQuery.filters)[0]]: lookerUser.user_attributes.time_horizon,\n        [lookerContent.desiredFilterName]: lookerUser.user_attributes.brand\n      };\n      let stringifiedQuery = encodeURIComponent(JSON.stringify(inlineQuery))\n      let lookerResponse = await fetch(`/runinlinequery/${stringifiedQuery}/${lookerContent.resultFormat}`, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })\n      let lookerResponseData = await lookerResponse.json();\n      lookerResponseData.queryResults = lookerResponseData.queryResults.filter(item => {\n        return item[inlineQuery.fields[0]]\n      })\n      let uniqueCategories = ['All'];\n      for (let i = 0; i < lookerResponseData.queryResults.length; i++) {\n        if (uniqueCategories.indexOf(lookerResponseData.queryResults[i][inlineQuery.fields[1]]) === -1) {\n          uniqueCategories.push(lookerResponseData.queryResults[i][inlineQuery.fields[1]])\n        }\n      }\n      lookerResponseData.inlineQuery = inlineQuery;\n      lookerResponseData.uniqueCategories = uniqueCategories;\n      setFromDate(lookerResponseData.queryResults[lookerResponseData.queryResults.length - 1][lookerResponseData.inlineQuery.fields[0]]);\n      setToDate(incrementDate(lookerResponseData.queryResults[0][lookerResponseData.inlineQuery.fields[0]], 1));\n      setApiContent(lookerResponseData)\n      if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n    })\n  }\n\n  let redToBlueColorScale = ['#0302FC', '#2A00D5', '#63009E', '#A1015D', '#D80027', '#FE0002'];\n  let yellowToGreenColorScale = ['#FEFE69', '#DDF969', '#A9F36A', '#A1015D', '#78EC6C', '#57E86B'];\n  let nivoColorScale = ['#61cdbb', '#97e3d5', '#e8c1a0', '#f47560']\n  let googleColorScale = ['#4595EC', '#F3A759', '#E24E3A', '#65AB5A'];\n  return (\n    <div className={`${classes.root} demoComponent`}>\n      <Grid container\n        spacing={3}\n        key={validIdHelper(type)} >\n        <div className={classes.root}>\n          <Box>\n            <AppBar position=\"static\">\n              <Tabs\n                className={classes.tabs}\n                value={value}\n                onChange={handleChange}\n                aria-label=\"simple tabs example\">\n                {tabContent.map((item, index) => (\n                  <Tab\n                    key={`${validIdHelper(demoComponentType + '-tab-' + index)}`}\n                    label={item.label}\n                    className={item.type === 'code flyout' ? `${classes.mlAuto}` : ``}\n                    {...a11yProps(index)} />\n                ))}\n              </Tabs>\n            </AppBar>\n            <Box className=\"tabPanelContainer\">\n              {tabContent.map((tabContentItem, index) => (\n                <TabPanel\n                  key={`${validIdHelper(demoComponentType + '-tabPanel-' + index)}`}\n                  value={value}\n                  index={index}>\n                  <Grid container>\n                    {tabContentItem.type === 'code flyout' ?\n\n                      <CodeFlyout {...props}\n                        classes={classes}\n                        lookerContent={lookerContent}\n                        clientSideCode={clientSideCode}\n                        serverSideCode={serverSideCode}\n                        lookerUser={lookerUser} />\n                      :\n                      <React.Fragment\n                        key={`${validIdHelper(demoComponentType + '-innerFragment-' + index)}`}>\n\n                        {!apiContent.queryResults ?\n                          <Skeleton variant=\"rect\" animation=\"wave\" className={classes.skeleton} />\n                          :\n                          <FilterBar {...props}\n                            classes={classes}\n                            apiContent={apiContent}\n                            fromDate={fromDate}\n                            toDate={toDate}\n                            category={category}\n                            desiredField={desiredField}\n                            handleFromDate={handleFromDate}\n                            handleToDate={handleToDate}\n                            handleCategory={handleCategory}\n                            handleDesiredField={handleDesiredField}\n                          />\n                        }\n                        <Divider className={classes.divider} />\n                        <Box\n                          className={classes.w100}\n                          mt={2}>\n                          {!apiContent.queryResults ?\n\n                            <Grid item sm={12} >\n                              <Card className={`${classes.card} ${classes.flexCentered}`}>\n                                <CircularProgress className={classes.circularProgress} />\n                              </Card>\n                            </Grid>\n\n                            : apiContent.queryResults && apiContent.queryResults.length ?\n                              <>\n                                <Grid item sm={12} className={classes.height800}>\n                                  <ApiHighlight height={400}>\n                                    <ResponsiveCalendar\n                                      data={filterData}\n                                      align=\"top\"\n                                      from={incrementDate(fromDate, 1)}\n                                      to={incrementDate(toDate, 1)}\n                                      emptyColor=\"#eeeeee\"\n                                      colors={desiredField === lookerContent[0].desiredFields[0] ? googleColorScale : nivoColorScale}\n                                      yearSpacing={40}\n                                      monthBorderColor=\"#ffffff\"\n                                      dayBorderWidth={2}\n                                      dayBorderColor=\"#ffffff\"\n                                      margin={{ bottom: 40, left: 40 }}\n                                      legends={[\n                                        {\n                                          anchor: 'bottom-right',\n                                          direction: 'row',\n                                          translateY: 36,\n                                          itemCount: 4,\n                                          itemWidth: 42,\n                                          itemHeight: 36,\n                                          itemsSpacing: 14,\n                                          itemDirection: 'right-to-left'\n                                        }\n                                      ]}\n                                      onClick={(day, event) => {\n                                        if (!day.value) {\n                                        } else if (lookerUser.permission_level === 'basic') {\n                                          togglePayWallModal({\n                                            'show': true,\n                                            'permissionNeeded': 'see_drill_overlay'\n                                          });\n                                        } else {\n                                          handleModalOpen(day)\n                                          event.stopPropagation();\n                                        }\n                                      }}\n                                    />\n                                  </ApiHighlight>\n                                </Grid>\n                              </> :\n                              ''\n                          }\n                        </Box>\n                      </React.Fragment>\n                    }\n                  </Grid>\n                </TabPanel>\n              ))}\n\n            </Box>\n          </Box >\n        </div>\n      </Grid >\n      {open ?\n        <ModalTable\n          {...props}\n          open={open}\n          onClose={handleModalClose}\n          classes={classes}\n          modalContent={modalContent}\n        />\n\n        : ''}\n    </div >\n  )\n}\n//Filter Bar code\nfunction FilterBar(props) {\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, classes,\n    apiContent, fromDate, toDate, category, desiredField, handleFromDate, handleToDate, handleCategory, handleDesiredField } = props;\n\n  const [expanded, setExpanded] = useState(true);\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n\n  // console.log('FilterBar')\n  // console.log('fromDate', fromDate)\n  // console.log('toDate', toDate)\n\n  return (\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel} className={classes.w100}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMoreIcon />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <Typography className={classes.heading}>Filter Data</Typography>\n\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <Grid container spacing={3}>\n          {apiContent.queryResults ?\n            <>\n              <Grid item sm={3}>\n                <FormControl className={classes.formControl}>\n                  <InputLabel\n                    id={`${validIdHelper(type + '-FilterBar-DataPropery-SelectLabel')}`}\n                  >\n                    Metric</InputLabel>\n                  <Select\n                    labelId={`${validIdHelper(type + '-FilterBar-DataPropery-SelectLabel')}`}\n                    id={`${validIdHelper(type + '-FilterBar-DataPropery-Select')}`}\n                    value={desiredField}\n                    onChange={(event) => handleDesiredField(event.target.value)}\n                  >\n                    {lookerContent[0].desiredFields.map((item, index) => (\n\n                      <MenuItem\n                        id={validIdHelper(`${item}-${index}`)}\n                        key={validIdHelper(`${item}-${index}`)}\n                        value={item}\n                      >{item.substring(item.lastIndexOf(\".\") + 1, item.length).split(\"_\").map(item => item.charAt(0).toUpperCase() + item.substring(1)).join(\" \")}</MenuItem>\n                    ))}\n                  </Select>\n                </FormControl>\n              </Grid>\n              <Grid item sm={3}>\n                <FormControl className={classes.formControl}>\n                  <InputLabel\n                    id={`${validIdHelper(type + '-FilterBar-Category-SelectLabel')}`}\n                  >\n                    Category</InputLabel>\n                  <Select\n                    labelId={`${validIdHelper(type + '-FilterBar-Category-SelectLabel')}`}\n                    id={`${validIdHelper(type + '-FilterBar-Category-Select')}`}\n                    value={category}\n                    onChange={(event) => handleCategory(event.target.value)}\n                  >\n                    {apiContent.uniqueCategories.map((item, index) => (\n\n                      <MenuItem\n                        id={validIdHelper(`${item}-${index}`)}\n                        key={validIdHelper(`${item}-${index}`)}\n                        value={item}>{item}</MenuItem>\n                    ))}\n                  </Select>\n                </FormControl>\n              </Grid>\n\n              <Grid item sm={3}>\n                {/* <form className={classes.container} >\n                  <TextField\n                    id=\"fromDate\"\n                    label=\"From date\"\n                    type=\"date\"\n                    value={fromDate}\n                    className={classes.textField}\n                    InputLabelProps={{\n                      shrink: true,\n                    }}\n                    onChange={(event) => handleFromDate(event.target.value)}\n                  />\n                </form> */}\n                <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                  <KeyboardDatePicker\n                    disableToolbar\n                    variant=\"inline\"\n                    format=\"MM/dd/yyyy\"\n                    margin=\"normal\"\n                    id=\"fromDate\"\n                    label=\"From date\"\n                    value={fromDate}\n                    onChange={handleFromDate}\n                    KeyboardButtonProps={{\n                      'aria-label': 'change date',\n                    }}\n                  />\n                </MuiPickersUtilsProvider>\n\n              </Grid>\n              <Grid item sm={3}>\n                <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                  <KeyboardDatePicker\n                    disableToolbar\n                    variant=\"inline\"\n                    format=\"MM/dd/yyyy\"\n                    margin=\"normal\"\n                    id=\"toDate\"\n                    label=\"To date\"\n                    value={toDate}\n                    onChange={handleToDate}\n                    KeyboardButtonProps={{\n                      'aria-label': 'change date',\n                    }}\n                  />\n                </MuiPickersUtilsProvider>\n              </Grid>\n            </>\n            : ''}\n        </Grid>\n      </ExpansionPanelDetails>\n    </ExpansionPanel >\n  )\n}\n\nfunction incrementDate(dateInput, increment) {\n  var dateFormatTotime = new Date(dateInput);\n  var increasedDate = new Date(dateFormatTotime.getTime() + (increment * 86400000));\n  return increasedDate.toISOString().split('T')[0];\n}"))}),[ee,re]);var ke=function(e){P([]),e.map(function(){var e=Object(d.a)(s.a.mark((function e(t){var n,a,o,r,l,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.inlineQuery).filters=Object(C.a)({},t.desiredFilterName,re.user_attributes.brand),a=encodeURIComponent(JSON.stringify(n)),e.next=5,fetch("/runinlinequery/".concat(a,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return o=e.sent,e.next=8,o.json();case 8:for((r=e.sent).queryResults=r.queryResults.filter((function(e){return e[n.fields[0]]})),l=["All"],i=0;i<r.queryResults.length;i++)-1===l.indexOf(r.queryResults[i][n.fields[1]])&&l.push(r.queryResults[i][n.fields[1]]);r.inlineQuery=n,r.uniqueCategories=l,p(r.queryResults[r.queryResults.length-1][r.inlineQuery.fields[0]]),f(At(r.queryResults[0][r.inlineQuery.fields[0]],1)),P(r),0===K.length&&Y(r.code);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},xe=["#61cdbb","#97e3d5","#e8c1a0","#f47560"],Ee=["#4595EC","#F3A759","#E24E3A","#65AB5A"];return o.a.createElement("div",{className:"".concat(Z.root," demoComponent")},o.a.createElement(me.a,{container:!0,spacing:3,key:Dt(ne)},o.a.createElement("div",{className:Z.root},o.a.createElement(F.a,null,o.a.createElement(T.a,{position:"static"},o.a.createElement(We.a,{className:Z.tabs,value:r,onChange:function(e,t){ae(0),l(t)},"aria-label":"simple tabs example"},ie.map((function(e,t){return o.a.createElement(Qe.a,Object.assign({key:"".concat(Dt(se+"-tab-"+t)),label:e.label,className:"code flyout"===e.type?"".concat(Z.mlAuto):""},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)))})))),o.a.createElement(F.a,{className:"tabPanelContainer"},ie.map((function(t,n){return o.a.createElement(St,{key:"".concat(Dt(se+"-tabPanel-"+n)),value:r,index:n},o.a.createElement(me.a,{container:!0},"code flyout"===t.type?o.a.createElement(ye,Object.assign({},e,{classes:Z,lookerContent:ee,clientSideCode:z,serverSideCode:K,lookerUser:re})):o.a.createElement(o.a.Fragment,{key:"".concat(Dt(se+"-innerFragment-"+n))},D.queryResults?o.a.createElement(Ht,Object.assign({},e,{classes:Z,apiContent:D,fromDate:u,toDate:y,category:E,desiredField:j,handleFromDate:de,handleToDate:be,handleCategory:he,handleDesiredField:fe})):o.a.createElement(st.a,{variant:"rect",animation:"wave",className:Z.skeleton}),o.a.createElement(te.a,{className:Z.divider}),o.a.createElement(F.a,{className:Z.w100,mt:2},D.queryResults?D.queryResults&&D.queryResults.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(me.a,{item:!0,sm:12,className:Z.height800},o.a.createElement(Te,{height:400},o.a.createElement(wt.a,{data:ge,align:"top",from:At(u,1),to:At(y,1),emptyColor:"#eeeeee",colors:j===ee[0].desiredFields[0]?Ee:xe,yearSpacing:40,monthBorderColor:"#ffffff",dayBorderWidth:2,dayBorderColor:"#ffffff",margin:{bottom:40,left:40},legends:[{anchor:"bottom-right",direction:"row",translateY:36,itemCount:4,itemWidth:42,itemHeight:36,itemsSpacing:14,itemDirection:"right-to-left"}],onClick:function(e,t){e.value&&("basic"===re.permission_level?X({show:!0,permissionNeeded:"see_drill_overlay"}):(ce(e),t.stopPropagation()))}})))):"":o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(ue.a,{className:"".concat(Z.card," ").concat(Z.flexCentered)},o.a.createElement(pe.a,{className:Z.circularProgress})))))))})))))),R?o.a.createElement(_t,Object.assign({},e,{open:R,onClose:function(){M({}),U(!1)},classes:Z,modalContent:$})):"")}function Ht(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.staticContent.type,r=e.classes,l=e.apiContent,i=e.fromDate,s=e.toDate,c=e.category,d=e.desiredField,m=e.handleFromDate,u=e.handleToDate,p=e.handleCategory,b=e.handleDesiredField,h=Object(a.useState)(!0),y=Object(J.a)(h,2),f=y[0],g=y[1];return o.a.createElement(nt.a,{expanded:f,onChange:function(e,t){g(!f)},className:r.w100},o.a.createElement(at.a,{expandIcon:o.a.createElement(dt.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(O.a,{className:r.heading},"Filter Data")),o.a.createElement(ot.a,null,o.a.createElement(me.a,{container:!0,spacing:3},l.queryResults?o.a.createElement(o.a.Fragment,null,o.a.createElement(me.a,{item:!0,sm:3},o.a.createElement(rt.a,{className:r.formControl},o.a.createElement(lt.a,{id:"".concat(Dt(n+"-FilterBar-DataPropery-SelectLabel"))},"Metric"),o.a.createElement(it.a,{labelId:"".concat(Dt(n+"-FilterBar-DataPropery-SelectLabel")),id:"".concat(Dt(n+"-FilterBar-DataPropery-Select")),value:d,onChange:function(e){return b(e.target.value)}},t[0].desiredFields.map((function(e,t){return o.a.createElement(ee.a,{id:Dt("".concat(e,"-").concat(t)),key:Dt("".concat(e,"-").concat(t)),value:e},e.substring(e.lastIndexOf(".")+1,e.length).split("_").map((function(e){return e.charAt(0).toUpperCase()+e.substring(1)})).join(" "))}))))),o.a.createElement(me.a,{item:!0,sm:3},o.a.createElement(rt.a,{className:r.formControl},o.a.createElement(lt.a,{id:"".concat(Dt(n+"-FilterBar-Category-SelectLabel"))},"Category"),o.a.createElement(it.a,{labelId:"".concat(Dt(n+"-FilterBar-Category-SelectLabel")),id:"".concat(Dt(n+"-FilterBar-Category-Select")),value:c,onChange:function(e){return p(e.target.value)}},l.uniqueCategories.map((function(e,t){return o.a.createElement(ee.a,{id:Dt("".concat(e,"-").concat(t)),key:Dt("".concat(e,"-").concat(t)),value:e},e)}))))),o.a.createElement(me.a,{item:!0,sm:3},o.a.createElement(Nt.a,{utils:It.a},o.a.createElement(Ft.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"fromDate",label:"From date",value:i,onChange:m,KeyboardButtonProps:{"aria-label":"change date"}}))),o.a.createElement(me.a,{item:!0,sm:3},o.a.createElement(Nt.a,{utils:It.a},o.a.createElement(Ft.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"toDate",label:"To date",value:s,onChange:u,KeyboardButtonProps:{"aria-label":"change date"}})))):"")))}function At(e,t){var n=new Date(e);return new Date(n.getTime()+864e5*t).toISOString().split("T")[0]}var Rt=n(1021),Ut=n(1019),Bt=n(1022),Lt=n(1023),$t=n(388),Mt=n.n($t),qt=Object(Y.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},card:{minWidth:275,minHeight:800},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},skeleton:{minWidth:275,minHeight:600},ml24:{marginLeft:24},parentHoverVisibility:{"&:hover $childHoverVisibility":{visibility:"visible"}},childHoverVisibility:{visibility:"hidden"},faSm:{fontSize:".75em"}}}));function Gt(e){var t=e.children,n=e.value,a=e.index,r=Object(m.a)(e,["children","value","index"]);return o.a.createElement(O.a,Object.assign({component:"div",role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),o.a.createElement(F.a,{p:3},t))}n(257);var zt=n(42).validIdHelper;function Vt(e){var t=Object(a.useState)(0),n=Object(J.a)(t,2),r=n[0],l=n[1],i=Object(a.useState)([]),m=Object(J.a)(i,2),u=m[0],p=m[1],b=Object(a.useState)({}),h=Object(J.a)(b,2),y=h[0],f=h[1],g=Object(a.useState)(""),C=Object(J.a)(g,2),k=C[0],x=C[1],E=Object(a.useState)(""),_=Object(J.a)(E,2),w=_[0],S=_[1],j=Object(a.useContext)(oe).togglePayWallModal,O=qt(),I=Object(a.useState)(0),N=Object(J.a)(I,2),D=N[0],P=N[1],H=(e.staticContent,e.staticContent.lookerContent),A=e.staticContent.type,R=e.activeTabValue,U=e.handleTabChange,B=e.lookerUser,L={type:"code flyout",label:"Code",id:"codeFlyout",lookerContent:H,lookerUser:B,clientSideCode:k,serverSideCode:w},$=A||"code flyout",M=[].concat(Object(v.a)(H),[L]),q=function(e,t){1==t&&"premium"!=B.permission_level?j({show:!0,permissionNeeded:"explore"}):(U(t),P(t),D>0&&0===t&&z(H))};Object(a.useEffect)((function(){R>D&&P(R),setTimeout((function(){return z(H,1)}),100),x("import $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport { AppBar, Tabs, Tab, Typography, Box, Grid, Icon, CircularProgress, Card, Button } from '@material-ui/core'\nimport { TreeView, TreeItem } from '@material-ui/lab';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./ReportBuilder.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport '../../Home.css';\nimport { ApiHighlight, EmbedHighlight } from '../../Highlights/Highlight';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of ReportBuilder Component\nexport default function ReportBuilder(props) {\n  //initialize state using hooks\n  const [iFrameExists, setIFrame] = useState(0);\n  const [apiContent, setApiContent] = useState([]);\n  const [exploreObj, setExploreObj] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n\n  const { togglePayWallModal } = useContext(AppContext)\n\n  //declare constants\n  const classes = useStyles();\n  const [value, setValue] = useState(0);\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser } = props;\n  const codeTab = {\n    type: 'code flyout', label: 'Code', id: 'codeFlyout',\n    lookerContent, lookerUser, clientSideCode, serverSideCode\n  }\n  const demoComponentType = type || 'code flyout';\n  // const tabContent = lookerUser.permission_level === 'premium' ?\n  //   [...lookerContent, codeTab] :\n  //   [lookerContent[0], codeTab];\n  const tabContent =\n    [...lookerContent, codeTab]\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n\n    if (newValue == 1 && lookerUser.permission_level != 'premium') {\n      // togglePayWallModal()\n\n      togglePayWallModal({\n        'show': true,\n        'permissionNeeded': 'explore'\n      });\n    } else {\n      handleTabChange(newValue);\n      setValue(newValue);\n      if (value > 0 && newValue === 0) performLookerApiCalls(lookerContent)\n    }\n  };\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    if (activeTabValue > value) {\n      setValue(activeTabValue)\n    }\n    setTimeout(() => performLookerApiCalls(lookerContent, 1), 100)\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent, lookerUser]);\n\n  const action = async (contentType, contentId, secondaryAction, qid, exploreId, newReportEmbedContainer) => {\n    let iFrameArray = $(\".embedContainer:visible > iframe\")\n\n    let matchingIndex = 0;\n    for (let i = 0; i < iFrameArray.length; i++) {\n      if (iFrameArray[i].classList.contains(contentType) && iFrameArray[i].classList.contains(contentId)) {\n        iFrameArray[i].classList.remove('dNone')\n        matchingIndex = i;\n      } else {\n        iFrameArray[i].classList.add('dNone')\n      }\n    }\n\n    if (secondaryAction === 'edit' || secondaryAction === 'explore') {\n      $(`#${newReportEmbedContainer}`).empty();\n\n      LookerEmbedSDK.createExploreWithId(exploreId)\n        .appendTo(`#${newReportEmbedContainer}`)\n        .withClassName('iframe')\n        .on('explore:state:changed', (event) => {\n        })\n        .withClassName(\"exploreIframe\")\n        .withParams({\n          qid: qid\n        })\n        .build()\n        .connect()\n        .then((explore) => {\n          setIFrame(1)\n          setExploreObj(explore)\n        })\n        .catch((error) => {\n          console.error('Connection error', error)\n        })\n      handleChange('edit', 1)\n    } else if (secondaryAction === 'delete') {\n      let lookerResponse = await fetch('/deletelook/' + contentId, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      if (lookerResponse.status === 200) {\n        performLookerApiCalls(lookerContent)\n      }\n    }\n  }\n\n  const performLookerApiCalls = function (lookerContent, animateLoad) {\n    if (animateLoad) {\n      handleChange('refresh', 0)\n      setIFrame(0)\n      setApiContent([])\n    }\n\n    lookerContent.map(async lookerContent => {\n      if (lookerContent.type === 'folder') {\n        let lookerResponse = await fetch('/fetchfolder/' + lookerContent.id, {\n          method: 'GET',\n          headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json'\n          }\n        })\n\n        let lookerResponseData = await lookerResponse.json();\n        if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n\n        let looksToUse = [...lookerResponseData.sharedFolder.looks, ...lookerResponseData.embeddedUserFolder.looks]\n        let dashboardsToUse = [...lookerResponseData.sharedFolder.dashboards]\n        let objToUse = {\n          looks: looksToUse,\n          dashboards: dashboardsToUse\n        }\n        let iFrameArray = $(`.embedContainer.${validIdHelper(demoComponentType)} > iframe`);\n        if (objToUse.looks.length) {\n          objToUse.looks.map((item, index) => {\n\n            let lookId = item.id;\n            let lookIsRendered = false;\n            for (let i = 0; i < iFrameArray.length; i++) {\n              if (iFrameArray[i].classList.contains('look') && iFrameArray[i].classList.contains(lookId)) {\n                lookIsRendered = true;\n              }\n            }\n\n            if (!lookIsRendered) {\n              LookerEmbedSDK.createLookWithId(lookId)\n                .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n                .withClassName('iframe')\n                .withClassName('look')\n                .withClassName(lookerResponseData.sharedFolder.looks.indexOf(item) > -1 ? \"shared\" : \"personal\")\n                .withClassName(index > 0 ? 'dNone' : 'oops')\n                .withClassName(lookId)\n                .build()\n                .connect()\n                .then((look) => {\n                  // setIFrame(1)\n                })\n                .catch((error) => {\n                  console.error('Connection error', error)\n                })\n            }\n\n            if (index === objToUse.looks.length - 1) {\n              setTimeout(() => setIFrame(1), 1000)\n            }\n          })\n        }\n\n        if (objToUse.dashboards.length) {\n          objToUse.dashboards.map((item, index) => {\n            let dashboardId = item.id\n            let dashboardIsRendered = false;\n            for (let i = 0; i < iFrameArray.length; i++) {\n              if (iFrameArray[i].classList.contains('dashboard') && iFrameArray[i].classList.contains(dashboardId)) {\n                dashboardIsRendered = true;\n              }\n            }\n            if (!dashboardIsRendered) {\n              LookerEmbedSDK.createDashboardWithId(dashboardId)\n                .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n                .withClassName('iframe')\n                .withClassName('dashboard')\n                .withClassName(lookerResponseData.sharedFolder.dashboards.indexOf(item) > -1 ? \"shared\" : \"personal\")\n                .withClassName('dNone')\n                .withClassName(dashboardId)\n                .build()\n                .connect()\n                .then((dashboard) => {\n                  setTimeout(() => {\n                    // setIFrame(1)\n                  }, 1000)\n                })\n                .catch((error) => {\n                  console.error('Connection error', error)\n                })\n            }\n\n\n            if (index === objToUse.dashboards.length - 1) {\n              setTimeout(() => setIFrame(1), 1000)\n            }\n          })\n        }\n        setApiContent(objToUse)\n      } else if (lookerContent.type === 'explore' && lookerUser.permission_level === 'premium') {\n        let exploreId = lookerContent.id;\n        $(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`)).html('')\n        LookerEmbedSDK.createExploreWithId(exploreId)\n          .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n          .withClassName('iframe')\n          .on('explore:state:changed', (event) => {\n          })\n          .build()\n          .connect()\n          .then((explore) => {\n            setTimeout(() => setIFrame(1), 1000)\n            setExploreObj(exploreObj)\n          })\n          .catch((error) => {\n            console.error('Connection error', error)\n          })\n      }\n    })\n  }\n\n\n  return (\n    <div className={`${classes.root} demoComponent`}>\n      <Grid container\n        spacing={3}\n        key={validIdHelper(type)} >\n        <div className={classes.root}>\n          {iFrameExists ? '' :\n            <Grid item sm={12} >\n              <Card className={`${classes.card} ${classes.flexCentered}`}>\n                <CircularProgress className={classes.circularProgress} />\n              </Card>\n            </Grid>\n          }\n\n          {/* additional loading logic, need embedContainer to exist but want it hidden until iFrame has content...*/}\n          <Box className={iFrameExists ? `` : `${classes.hidden}`}>\n            <AppBar position=\"static\">\n              <Tabs\n                className={classes.tabs}\n                value={value}\n                onChange={handleChange}\n                aria-label=\"simple tabs example\">\n                {tabContent.map((item, index) => (\n                  <Tab\n                    key={`${validIdHelper(demoComponentType + '-tab-' + index)}`}\n                    label={index == 1 && lookerUser.permission_level != 'premium' ?\n                      <div>{item.label} <Icon className={`fa fa-lock ${classes.faSm}`} /></div> :\n                      item.label}\n                    className={item.type === 'code flyout' ? `${classes.mlAuto}` : ``}\n                    {...a11yProps(index)} />\n                ))}\n              </Tabs>\n            </AppBar>\n\n            <Box className=\"tabPanelContainer\">\n              {tabContent.map((tabContentItem, tabContentItemIndex) => (\n                <TabPanel\n                  key={`${validIdHelper(demoComponentType + '-tabPanel-' + tabContentItemIndex)}`}\n                  value={value}\n                  index={tabContentItemIndex}>\n                  <Grid container>\n                    {tabContentItem.type === 'code flyout' ?\n                      <CodeFlyout {...props}\n                        classes={classes}\n                        lookerContent={lookerContent}\n                        clientSideCode={clientSideCode}\n                        serverSideCode={serverSideCode}\n                        lookerUser={lookerUser} />\n                      :\n                      tabContentItemIndex === 0\n                        ?\n                        <React.Fragment\n                          key={`${validIdHelper(demoComponentType + '-outerFragment-' + tabContentItemIndex)}`}>\n                          <Grid item sm={4} >\n                            <ApiHighlight height={400}>\n                              <TreeSideBar {...{\n                                togglePayWallModal,\n                                classes,\n                                demoComponentType,\n                                tabContent,\n                                tabContentItemIndex,\n                                action,\n                                apiContent,\n                                ...props\n                              }}\n                              />\n                            </ApiHighlight>\n                          </Grid>\n                          <Grid item sm={8} >\n                            <EmbedHighlight>\n                              <div\n                                className={`embedContainer ${validIdHelper(demoComponentType)}`}\n                                id={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                key={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                              >\n                              </div>\n                            </EmbedHighlight>\n                          </Grid>\n                        </React.Fragment>\n                        :\n                        <Grid item sm={12} >\n                          <EmbedHighlight>\n                            <div\n                              className=\"embedContainer\"\n                              id={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                              key={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                            >\n                            </div>\n                          </EmbedHighlight>\n                        </Grid>\n                    }\n                  </Grid>\n                </TabPanel>\n              ))}\n            </Box>\n          </Box >\n        </div>\n      </Grid >\n    </div >\n  )\n}\n\n\nfunction TreeSideBar(props) {\n  // console.log('TreeSideBar')\n  const { staticContent, staticContent: { lookerContent }, classes, demoComponentType, tabContent, tabContentItemIndex, action, apiContent, lookerUser, togglePayWallModal } = props\n  const sharedFolderId = lookerContent[0].type === 'folder' ? lookerContent[0].id : '';\n  let treeCounter = 0;\n  const [selected, setSelected] = useState(2)\n  const expandedArr = Object.keys(apiContent).length ? [\"1\", \"\" + (2 + apiContent[Object.keys(apiContent)[0]].length)] : [];\n  const [expanded, setExpanded] = useState(expandedArr);\n\n  const handleToggle = (event, nodeIds) => {\n    setExpanded(nodeIds);\n  }\n\n  const handleSelect = (event, nodeIds) => {\n    setSelected(nodeIds);\n  };\n\n\n  useEffect(() => {\n    setExpanded(expandedArr)\n  }, [apiContent]);\n\n  return (\n    <TreeView\n      className={classes.tree}\n      defaultCollapseIcon={<ExpandMoreIcon />}\n      defaultExpandIcon={<ChevronRightIcon />}\n      expanded={expanded}\n      onNodeToggle={handleToggle}\n      onNodeSelect={handleSelect}\n    >\n      {apiContent ? Object.keys(apiContent).map((key, outerIndex) => (\n        <React.Fragment\n          key={`${validIdHelper(demoComponentType + '-innerFragment-' + outerIndex)}`}>\n          <TreeItem\n            key={`${validIdHelper(demoComponentType + '-outerTreeItem-' + outerIndex)}`}\n            nodeId={\"\" + (treeCounter += 1)}\n            // treecounter={treeCounter}\n            label={_.capitalize(key)}\n            icon={<Icon className={`fa fa-folder ${classes.icon}`} />}\n            disabled={apiContent[key].length ? false : true}\n          >\n            {\n              apiContent[key].length ?\n                apiContent[key].map((item, index) => (\n                  <TreeItem\n                    key={`${validIdHelper(demoComponentType + '-innerTreeItem-' + treeCounter)}`}\n                    nodeId={\"\" + (treeCounter += 1)}\n                    treecounter={treeCounter}\n                    selected={selected === treeCounter}\n                    className={selected === treeCounter ? `Mui-selected innerTreeItem` : `innerTreeItem`}\n                    contentid={item.id}\n                    label={item.folder_id === sharedFolderId &&\n                      key === 'looks' ?\n\n                      < div\n                        id={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                        key={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                        className={`${classes.labelRoot} ${classes.parentHoverVisibility}`}>\n                        {item.title.length > 30 ? item.title.substring(0, 30) + '...' : item.title}\n\n                        <Button\n                          id={`${validIdHelper(demoComponentType + '-innerTreeItem-Explore' + treeCounter)}`}\n                          key={`${validIdHelper(demoComponentType + '-innerTreeItem-Explore' + treeCounter)}`}\n                          size=\"small\"\n                          className={`${classes.ml24} ${classes.childHoverVisibility}`}\n                          onClick={(event) => {\n                            if (lookerUser.permission_level === 'premium') {\n                              // setSelected(treeCounter);\n                              action(\n                                key.substring(0, key.length - 1),\n                                item.id,\n                                'explore',\n                                item.client_id,\n                                tabContent[tabContentItemIndex + 1].id,\n                                validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                              );\n                              event.stopPropagation();\n                            } else {\n                              // togglePayWallModal();\n\n                              togglePayWallModal({\n                                'show': true,\n                                'permissionNeeded': 'explore'\n                              });\n                            }\n                          }\n                          }\n                          color=\"default\"\n                        >\n                          Explore\n                                                                                            </Button>\n                      </div>\n                      : key === 'looks' ?\n                        <div\n                          id={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                          key={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                          className={`${classes.labelRoot} ${classes.parentHoverVisibility}`}>\n\n                          {item.title.length > 30 ? item.title.substring(0, 30) + '...' : item.title}                          <Button\n                            id={`${validIdHelper(demoComponentType + '-innerTreeItem-EditButton' + treeCounter)}`}\n                            key={`${validIdHelper(demoComponentType + '-innerTreeItem-EditButton' + treeCounter)}`}\n                            size=\"small\"\n                            className={`${classes.ml24} ${classes.childHoverVisibility}`}\n                            onClick={(event) => {\n                              if (lookerUser.permission_level === 'premium') {\n                                // setSelected(treeCounter);\n                                action(\n                                  key.substring(0, key.length - 1),\n                                  item.id,\n                                  'edit',\n                                  item.client_id,\n                                  tabContent[tabContentItemIndex + 1].id,\n                                  validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                                );\n                                event.stopPropagation();\n                              } else {\n                                // togglePayWallModal();\n\n                                togglePayWallModal({\n                                  'show': true,\n                                  'permissionNeeded': 'explore'\n                                });\n                              }\n                            }\n                            }\n                            color=\"primary\"\n                          >\n                            Edit\n                                                                                            </Button>\n                          <Button\n                            id={`${validIdHelper(demoComponentType + '-innerTreeItem-DeleteButton' + treeCounter)}`}\n                            key={`${validIdHelper(demoComponentType + '-innerTreeItem-DeleteButton' + treeCounter)}`}\n                            size=\"small\"\n                            className={`${classes.ml24} ${classes.childHoverVisibility}`}\n                            onClick={(event) => {\n                              if (lookerUser.permission_level === 'premium') {\n                                // setSelected(treeCounter);\n                                action(\n                                  key.substring(0, key.length - 1),\n                                  item.id,\n                                  'delete',\n                                  item.client_id,\n                                  tabContent[tabContentItemIndex + 1].id,\n                                  validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                                );\n                                event.stopPropagation();\n                              } else {\n                                // togglePayWallModal();\n\n                                togglePayWallModal({\n                                  'show': true,\n                                  'permissionNeeded': 'explore'\n                                });\n                              }\n                            }\n                            }\n                            color=\"secondary\"\n                          >\n                            Delete\n                                                                                            </Button>\n                        </div>\n                        : item.title.length > 30 ? item.title.substring(0, 30) + '...' : item.title\n                    }\n                    onClick={() => {\n                      // setSelected(treeCounter)\n                      action(\n                        key.substring(0, key.length - 1), item.id)\n                    }} />\n\n                ))\n                :\n                ''\n            }\n          </TreeItem>\n\n        </React.Fragment>\n      )) : ''}\n    </TreeView>\n  )\n}")}),[H,B]);var G=function(){var e=Object(d.a)(s.a.mark((function e(t,n,a,o,r,i){var c,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c=de()(".embedContainer:visible > iframe"),0,d=0;d<c.length;d++)c[d].classList.contains(t)&&c[d].classList.contains(n)?(c[d].classList.remove("dNone"),d):c[d].classList.add("dNone");if("edit"!==a&&"explore"!==a){e.next=9;break}de()("#".concat(i)).empty(),ie.LookerEmbedSDK.createExploreWithId(r).appendTo("#".concat(i)).withClassName("iframe").on("explore:state:changed",(function(e){})).withClassName("exploreIframe").withParams({qid:o}).build().connect().then((function(e){l(1),f(e)})).catch((function(e){console.error("Connection error",e)})),q(0,1),e.next=14;break;case 9:if("delete"!==a){e.next=14;break}return e.next=12,fetch("/deletelook/"+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 12:200===e.sent.status&&z(H);case 14:case"end":return e.stop()}}),e)})));return function(t,n,a,o,r,l){return e.apply(this,arguments)}}(),z=function(e,t){t&&(q(0,0),l(0),p([])),e.map(function(){var e=Object(d.a)(s.a.mark((function e(t){var n,a,o,r,i,c,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("folder"!==t.type){e.next=17;break}return e.next=3,fetch("/fetchfolder/"+t.id,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,0===w.length&&S(a.code),o=[].concat(Object(v.a)(a.sharedFolder.looks),Object(v.a)(a.embeddedUserFolder.looks)),r=Object(v.a)(a.sharedFolder.dashboards),i={looks:o,dashboards:r},c=de()(".embedContainer.".concat(zt($)," > iframe")),i.looks.length&&i.looks.map((function(e,n){for(var o=e.id,r=!1,s=0;s<c.length;s++)c[s].classList.contains("look")&&c[s].classList.contains(o)&&(r=!0);r||ie.LookerEmbedSDK.createLookWithId(o).appendTo(zt("#embedContainer-".concat($,"-").concat(t.id))).withClassName("iframe").withClassName("look").withClassName(a.sharedFolder.looks.indexOf(e)>-1?"shared":"personal").withClassName(n>0?"dNone":"oops").withClassName(o).build().connect().then((function(e){})).catch((function(e){console.error("Connection error",e)})),n===i.looks.length-1&&setTimeout((function(){return l(1)}),1e3)})),i.dashboards.length&&i.dashboards.map((function(e,n){for(var o=e.id,r=!1,s=0;s<c.length;s++)c[s].classList.contains("dashboard")&&c[s].classList.contains(o)&&(r=!0);r||ie.LookerEmbedSDK.createDashboardWithId(o).appendTo(zt("#embedContainer-".concat($,"-").concat(t.id))).withClassName("iframe").withClassName("dashboard").withClassName(a.sharedFolder.dashboards.indexOf(e)>-1?"shared":"personal").withClassName("dNone").withClassName(o).build().connect().then((function(e){setTimeout((function(){}),1e3)})).catch((function(e){console.error("Connection error",e)})),n===i.dashboards.length-1&&setTimeout((function(){return l(1)}),1e3)})),p(i),e.next=18;break;case 17:"explore"===t.type&&"premium"===B.permission_level&&(d=t.id,de()(zt("#embedContainer-".concat($,"-").concat(t.id))).html(""),ie.LookerEmbedSDK.createExploreWithId(d).appendTo(zt("#embedContainer-".concat($,"-").concat(t.id))).withClassName("iframe").on("explore:state:changed",(function(e){})).build().connect().then((function(e){setTimeout((function(){return l(1)}),1e3),f(y)})).catch((function(e){console.error("Connection error",e)})));case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return o.a.createElement("div",{className:"".concat(O.root," demoComponent")},o.a.createElement(me.a,{container:!0,spacing:3,key:zt(A)},o.a.createElement("div",{className:O.root},r?"":o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(ue.a,{className:"".concat(O.card," ").concat(O.flexCentered)},o.a.createElement(pe.a,{className:O.circularProgress}))),o.a.createElement(F.a,{className:r?"":"".concat(O.hidden)},o.a.createElement(T.a,{position:"static"},o.a.createElement(We.a,{className:O.tabs,value:D,onChange:q,"aria-label":"simple tabs example"},M.map((function(e,t){return o.a.createElement(Qe.a,Object.assign({key:"".concat(zt($+"-tab-"+t)),label:1==t&&"premium"!=B.permission_level?o.a.createElement("div",null,e.label," ",o.a.createElement(Rt.a,{className:"fa fa-lock ".concat(O.faSm)})):e.label,className:"code flyout"===e.type?"".concat(O.mlAuto):""},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)))})))),o.a.createElement(F.a,{className:"tabPanelContainer"},M.map((function(t,n){return o.a.createElement(Gt,{key:"".concat(zt($+"-tabPanel-"+n)),value:D,index:n},o.a.createElement(me.a,{container:!0},"code flyout"===t.type?o.a.createElement(ye,Object.assign({},e,{classes:O,lookerContent:H,clientSideCode:k,serverSideCode:w,lookerUser:B})):0===n?o.a.createElement(o.a.Fragment,{key:"".concat(zt($+"-outerFragment-"+n))},o.a.createElement(me.a,{item:!0,sm:4},o.a.createElement(Te,{height:400},o.a.createElement(Wt,Object(c.a)({togglePayWallModal:j,classes:O,demoComponentType:$,tabContent:M,tabContentItemIndex:n,action:G,apiContent:u},e)))),o.a.createElement(me.a,{item:!0,sm:8},o.a.createElement(Se,null,o.a.createElement("div",{className:"embedContainer ".concat(zt($)),id:zt("embedContainer-".concat($,"-").concat(t.id)),key:zt("embedContainer-".concat($,"-").concat(t.id))})))):o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(Se,null,o.a.createElement("div",{className:"embedContainer",id:zt("embedContainer-".concat($,"-").concat(t.id)),key:zt("embedContainer-".concat($,"-").concat(t.id))})))))})))))))}function Wt(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.classes,r=e.demoComponentType,l=e.tabContent,i=e.tabContentItemIndex,s=e.action,c=e.apiContent,d=e.lookerUser,m=e.togglePayWallModal,u="folder"===t[0].type?t[0].id:"",p=0,b=Object(a.useState)(2),h=Object(J.a)(b,2),y=h[0],f=h[1],g=Object.keys(c).length?["1",""+(2+c[Object.keys(c)[0]].length)]:[],C=Object(a.useState)(g),v=Object(J.a)(C,2),k=v[0],E=v[1];return Object(a.useEffect)((function(){E(g)}),[c]),o.a.createElement(Bt.a,{className:n.tree,defaultCollapseIcon:o.a.createElement(dt.a,null),defaultExpandIcon:o.a.createElement(Mt.a,null),expanded:k,onNodeToggle:function(e,t){E(t)},onNodeSelect:function(e,t){f(t)}},c?Object.keys(c).map((function(e,t){return o.a.createElement(o.a.Fragment,{key:"".concat(zt(r+"-innerFragment-"+t))},o.a.createElement(Lt.a,{key:"".concat(zt(r+"-outerTreeItem-"+t)),nodeId:""+(p+=1),label:x.a.capitalize(e),icon:o.a.createElement(Rt.a,{className:"fa fa-folder ".concat(n.icon)}),disabled:!c[e].length},c[e].length?c[e].map((function(t,a){return o.a.createElement(Lt.a,{key:"".concat(zt(r+"-innerTreeItem-"+p)),nodeId:""+(p+=1),treecounter:p,selected:y===p,className:y===p?"Mui-selected innerTreeItem":"innerTreeItem",contentid:t.id,label:t.folder_id===u&&"looks"===e?o.a.createElement("div",{id:"".concat(zt(r+"-innerTreeItem-LabelContainer"+p)),key:"".concat(zt(r+"-innerTreeItem-LabelContainer"+p)),className:"".concat(n.labelRoot," ").concat(n.parentHoverVisibility)},t.title.length>30?t.title.substring(0,30)+"...":t.title,o.a.createElement(Ut.a,{id:"".concat(zt(r+"-innerTreeItem-Explore"+p)),key:"".concat(zt(r+"-innerTreeItem-Explore"+p)),size:"small",className:"".concat(n.ml24," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.permission_level?(s(e.substring(0,e.length-1),t.id,"explore",t.client_id,l[i+1].id,zt("embedContainer-".concat(r,"-").concat(l[i+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"default"},"Explore")):"looks"===e?o.a.createElement("div",{id:"".concat(zt(r+"-innerTreeItem-LabelContainer"+p)),key:"".concat(zt(r+"-innerTreeItem-LabelContainer"+p)),className:"".concat(n.labelRoot," ").concat(n.parentHoverVisibility)},t.title.length>30?t.title.substring(0,30)+"...":t.title,"                          ",o.a.createElement(Ut.a,{id:"".concat(zt(r+"-innerTreeItem-EditButton"+p)),key:"".concat(zt(r+"-innerTreeItem-EditButton"+p)),size:"small",className:"".concat(n.ml24," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.permission_level?(s(e.substring(0,e.length-1),t.id,"edit",t.client_id,l[i+1].id,zt("embedContainer-".concat(r,"-").concat(l[i+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"primary"},"Edit"),o.a.createElement(Ut.a,{id:"".concat(zt(r+"-innerTreeItem-DeleteButton"+p)),key:"".concat(zt(r+"-innerTreeItem-DeleteButton"+p)),size:"small",className:"".concat(n.ml24," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.permission_level?(s(e.substring(0,e.length-1),t.id,"delete",t.client_id,l[i+1].id,zt("embedContainer-".concat(r,"-").concat(l[i+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"secondary"},"Delete")):t.title.length>30?t.title.substring(0,30)+"...":t.title,onClick:function(){s(e.substring(0,e.length-1),t.id)}})})):""))})):"")}var Qt=n(1054),Kt=n(1055),Jt=n(1024),Yt=n(1056),Xt=n(155),Zt=n.n(Xt),en=n(209),tn=Q.a[400],nn=Q.a[100],an=en.a[400],on=en.a[100],rn=Object(Y.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},ml12:{marginLeft:12},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},table:{minWidth:650},tableContainer:{maxHeight:650},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},greyPrimary:{backgroundColor:tn},greySecondary:{backgroundColor:nn},orangePrimary:{backgroundColor:an},orangeSecondary:{backgroundColor:on},formControl:{margin:e.spacing(1),minWidth:120},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275,minHeight:600},textCenter:{textAlign:"center"}}}));function ln(e){var t=e.children,n=e.value,a=e.index,r=Object(m.a)(e,["children","value","index"]);return o.a.createElement(O.a,Object.assign({component:"div",role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),o.a.createElement(F.a,{p:3},t))}function sn(e,t,n){return e[n]&&t[n]&&t[n].value<e[n].value?-1:e[n]&&t[n]&&t[n].value>e[n].value?1:0}var cn=n(42),dn=cn.validIdHelper,mn=cn.prettifyString;function un(e){var t=Object(a.useState)(0),n=Object(J.a)(t,2),r=n[0],l=n[1],i=Object(a.useState)({}),m=Object(J.a)(i,2),u=m[0],p=m[1],b=Object(a.useState)(""),h=Object(J.a)(b,2),y=h[0],f=h[1],g=Object(a.useState)(""),C=Object(J.a)(g,2),k=C[0],x=C[1],E=rn(),_=(e.staticContent,e.staticContent.lookerContent),w=e.staticContent.type,S=(e.activeTabValue,e.handleTabChange),j=e.lookerUser,I={type:"code flyout",label:"Code",id:"codeFlyout",lookerContent:_,lookerUser:j,clientSideCode:y,serverSideCode:k},N=[].concat(Object(v.a)(_),[I]),D=w||"code flyout";Object(a.useEffect)((function(){_.map((function(e){setTimeout((function(){return P(e.queryBody,e.resultFormat)}),100)})),f("import $ from 'jquery';\nimport _ from 'lodash';\nimport React, { useState, useEffect } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, Icon, CircularProgress, Card, Button,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails, InputLabel, MenuItem, FormControl,\n  Select, Table, TableBody, TableCell, TableContainer, TableHead, TablePagination, TableRow,\n  TableSortLabel, FormControlLabel, Switch, Chip, Divider\n} from '@material-ui/core'\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport DoneIcon from '@material-ui/icons/Done';\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./QueryBuilder.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { ApiHighlight } from '../../Highlights/Highlight';\nimport { TabPanel, a11yProps, descendingComparator, getComparator, stableSort } from './helpers.js';\nconst { validIdHelper, prettifyString } = require('../../../tools');\n\n//start of QueryBuilder Component\nexport default function QueryBuilder(props) {\n  // console.log('QueryBuilder')\n  // console.log('props', props)\n\n  //initialize state using hooks\n  const [value, setValue] = useState(0);\n  const [apiContent, setApiContent] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  //declare constants\n\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser } = props;\n  const codeTab = {\n    type: 'code flyout', label: 'Code', id: 'codeFlyout',\n    lookerContent, lookerUser, clientSideCode, serverSideCode\n  }\n  const tabContent = [...lookerContent, codeTab];\n  const demoComponentType = type || 'code flyout';\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    lookerContent.map(lookerContent => {\n      setTimeout(() => action(lookerContent.queryBody, lookerContent.resultFormat), 100);\n    })\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent, lookerUser])\n\n  const action = async (newQuery, resultFormat) => {\n    // console.log('action')\n    let apiContentCopy = { ...apiContent }\n    apiContentCopy.status = 'running';\n    setApiContent(apiContentCopy)\n\n    let lookerCreateTaskResposnse = await fetch('/createquerytask/' + JSON.stringify(newQuery), {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n    let lookerCreateTaskResponseData = await lookerCreateTaskResposnse.json();\n\n    let taskInterval = setInterval(async () => {\n      let lookerCheckTaskResposnse = await fetch('/checkquerytask/' + lookerCreateTaskResponseData.queryTaskId, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })\n      let lookerCheckTaskResponseData = await lookerCheckTaskResposnse.json();\n      if (lookerCheckTaskResponseData.queryResults.status === 'complete') {\n        clearInterval(taskInterval);\n        setApiContent(lookerCheckTaskResponseData.queryResults)\n        setServerSideCode(lookerCreateTaskResponseData.code)\n      }\n    }, 5000)\n  }\n\n  return (\n    <div className={`${classes.root} demoComponent`}>\n      <Grid container\n        spacing={3}\n        key={validIdHelper(type)} >\n        <div className={classes.root}>\n          <Box>\n            <AppBar position=\"static\">\n              <Tabs\n                className={classes.tabs}\n                value={value}\n                onChange={handleChange}\n                aria-label=\"simple tabs example\">\n                {tabContent.map((item, index) => (\n                  <Tab\n                    key={`${validIdHelper(demoComponentType + '-tab-' + index)}`}\n                    label={item.label}\n                    className={item.type === 'code flyout' ? `${classes.mlAuto}` : ``}\n                    {...a11yProps(index)} />\n                ))}\n              </Tabs>\n            </AppBar>\n            <Box className=\"tabPanelContainer\">\n              {tabContent.map((tabContentItem, index) => (\n                <TabPanel\n                  key={`${validIdHelper(demoComponentType + '-tabPanel-' + index)}`}\n                  value={value}\n                  index={index}>\n                  <Grid container>\n                    {tabContentItem.type === 'code flyout' ?\n                      <CodeFlyout {...props}\n                        classes={classes}\n                        lookerContent={lookerContent}\n                        clientSideCode={clientSideCode}\n                        serverSideCode={serverSideCode}\n                        lookerUser={lookerUser} />\n                      :\n                      <React.Fragment\n                        key={`${validIdHelper(demoComponentType + '-innerFragment-' + index)}`}>\n                        <FilterBar {...props}\n                          classes={classes}\n                          action={action}\n                        />\n                        <Divider className={classes.divider} />\n                        <Box\n                          className={classes.w100}\n                          mt={2}>\n                          {apiContent.status === 'running' ?\n                            <Grid item sm={12} >\n                              <Card className={`${classes.card} ${classes.flexCentered}`}>\n                                <CircularProgress className={classes.circularProgress} />\n                              </Card>\n                            </Grid >\n                            : apiContent.data && apiContent.data.length ?\n                              <Grid item sm={12}>\n                                <EnhancedTable\n                                  {...props}\n                                  classes={classes}\n                                  rows={apiContent.data}\n                                  lookerContent={lookerContent}\n                                />\n                              </Grid>\n                              :\n                              <Grid item sm={12} >\n                                <Typography variant=\"h6\" component=\"h6\" className={`${classes.gridTitle} ${classes.textCenter}`}>\n                                  No results found, try a new query<br />\n                                </Typography>\n                              </Grid>\n                          }\n                        </Box >\n                      </React.Fragment >\n                    }\n                  </Grid >\n                </TabPanel >\n              ))}\n            </Box >\n          </Box >\n        </div >\n      </Grid >\n    </div >\n  )\n}\n\n\nfunction FilterBar(props) {\n  const { staticContent, staticContent: { lookerContent }, classes, action, lookerUser } = props;\n  let measureCounter = 0;\n  let dimensionCounter = 0;\n\n  const [expanded, setExpanded] = useState(true);\n  const [fieldsChipData, setFieldsChipData] = useState(lookerContent[0].queryBody ? lookerContent[0].queryBody.fields.map((item, index) => {\n    return {\n      key: 'fieldChipData' + index,\n      label: prettifyString(item.substring(item.lastIndexOf('.') + 1, item.length)),\n      datalabel: item,\n      selected: true,\n      fieldType: lookerContent[0].fieldType[item]\n    }\n  }) : '');\n  const [queryModified, setQueryModified] = useState(false);\n  const [filtersData, setFilterData] = useState(lookerContent[0].queryBody ? Object.keys(lookerContent[0].queryBody.filters).map((key, index) => {\n    return {\n      key: 'filter' + index,\n      label: key,\n      value: lookerContent[0].queryBody.filters[key],\n      type: lookerContent[0].filterType[key]\n    }\n  }) : '')\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n\n  const handleFieldChipClick = (chip, index) => {\n    let updatedFieldsChipData = [...fieldsChipData]\n    updatedFieldsChipData[index].selected = updatedFieldsChipData[index].selected === false ? true : false\n    setFieldsChipData(updatedFieldsChipData)\n    setQueryModified(true)\n  }\n\n  const handleSelectChange = (index, newValue) => {\n    let updatedFiltersData = [...filtersData]\n    updatedFiltersData[index].value = newValue;\n    setFilterData(updatedFiltersData)\n    setQueryModified(true)\n  }\n\n  const handleQuerySubmit = (event) => {\n    if (queryModified) {\n      let newFields = fieldsChipData.filter(chip => chip.selected).map(item => item.datalabel);\n      let currentFilters = {}; //needs to be object\n      filtersData.map((item, index) => {\n        currentFilters[item.label] = item.value\n      })\n      let newQueryObj = lookerContent[0].queryBody;\n      newQueryObj.fields = newFields;\n      newQueryObj.filters = currentFilters;\n      action(newQueryObj, lookerContent[0].resultFormat);\n    }\n  }\n\n  useEffect(() => {\n    handleQuerySubmit()\n  }, [fieldsChipData, filtersData]);\n\n  const datePermissionMap = {\n    'basic': [\"1 week\", \"1 month\", \"3 months\", \"6 months\"]\n  }\n  datePermissionMap.advanced = [...datePermissionMap.basic, \"1 year\"]\n  datePermissionMap.premium = [...datePermissionMap.advanced, \"before today\"]\n\n  useEffect(() => {\n    let updatedFiltersData = [...filtersData]\n    updatedFiltersData[3].value = \"6 months\";\n    setFilterData(updatedFiltersData)\n  }, [lookerUser]);\n\n  return (\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMoreIcon />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <Typography className={classes.heading}>Build Query</Typography>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <Grid container spacing={3}>\n          <Grid item sm={12}>\n            <Typography variant=\"subtitle1\">\n              Select Fields:\n      {fieldsChipData.length ?\n                fieldsChipData.map((item, index) => {\n                  return (\n                    item.fieldType === 'measure' ?\n                      <Chip\n                        key={item.label}\n                        // key={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        measurecounter={measureCounter += 1}\n                        className={item.selected ? `${classes.orangePrimary}` : ``}\n                        label={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        datalabel={item.label}\n                        onClick={() => handleFieldChipClick(item, index)}\n                        icon={item.selected ? <DoneIcon className={classes.dBlock} /> : <DoneIcon className={classes.dNone} />}\n                      /> : ''\n                  )\n                }) : ''\n              }<br />\n            </Typography>\n          </Grid>\n          <Grid item sm={12}>\n            <Typography variant=\"subtitle1\">\n              Totals:\n                          {fieldsChipData.length ?\n                fieldsChipData.map((item, index) => {\n                  return (\n                    item.fieldType === 'dimension' ?\n                      <Chip\n                        key={item.label}\n                        dimensioncounter={dimensionCounter += 1}\n                        className={item.selected ? `${classes.greyPrimary}` : ``}\n                        label={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        datalabel={item.label}\n                        onClick={() => handleFieldChipClick(item, index)}\n                        icon={item.selected ? <DoneIcon className={classes.dBlock} /> : <DoneIcon className={classes.dNone} />}\n                      /> : ''\n                  )\n                }) : ''\n              }<br />\n            </Typography>\n          </Grid>\n\n          <Grid item sm={12}>\n            <Typography variant=\"subtitle1\">\n              Filter By:\n                      </Typography>\n            {filtersData.length ? filtersData.map((item, index) => {\n              return (\n                <FormControl className={item.value.length ? classes.formControl : classes.hidden} key={validIdHelper(`${item.label}FormControl`)}>\n                  {\n                    item.type === 'yesno' ?\n                      <>\n                        <InputLabel id={validIdHelper(`${item.label}FilterLabel`)}>{prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}:</InputLabel>\n                        <Select\n                          labelId={validIdHelper(`${item.label}FilterLabel`)}\n                          id={validIdHelper(`${item.label}FilterSelect`)}\n                          value={item.value}\n                          onChange={(event) => handleSelectChange(index, event.target.value)}\n                        >\n                          <MenuItem value=\"Yes\">Yes</MenuItem>\n                          <MenuItem value=\"No\">No</MenuItem>\n                          <MenuItem value=\"All\">All</MenuItem>\n                        </Select>\n                      </>\n                      : item.type === 'date' ?\n                        <>\n                          <InputLabel id={validIdHelper(`${item.label}FilterLabel`)}>{prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}:</InputLabel>\n\n                          <Select\n                            labelId={validIdHelper(`${item.label}FilterLabel`)}\n                            id={validIdHelper(`${item.label}FilterSelect`)}\n                            value={item.value || '6 months'}\n                            onChange={(event) => handleSelectChange(index, event.target.value)}\n                          >\n                            {lookerUser.permission_level ? datePermissionMap[lookerUser.permission_level].map(item => (\n                              <MenuItem key={validIdHelper(item)} value={item}>{_.capitalize(item)}</MenuItem>\n                            )) : ''}\n                          </Select>\n                        </>\n                        : ''\n                  }\n                </FormControl>\n              )\n            }) : ''}\n          </Grid>\n        </Grid>\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  )\n}\n\nfunction EnhancedTableHead(props) {\n  const { classes, onSelectAllClick, order, orderBy, numSelected, rowCount, onRequestSort, rows } = props;\n  const createSortHandler = (property) => (event) => {\n    onRequestSort(event, property);\n  };\n\n  return (\n    <TableHead>\n      <TableRow>\n        {Object.keys(rows[0]).map((key, index) => (\n          <TableCell\n            key={validIdHelper(key + '-TableHead-TableCell-' + index)}\n            id={validIdHelper(key + '-TableHead-TableCell-' + index)}\n            align={key.numeric ? 'right' : 'left'}\n            padding={key.disablePadding ? 'none' : 'default'}\n            sortDirection={orderBy === key ? order : false}\n          >\n            <TableSortLabel\n              active={orderBy === key}\n              direction={orderBy === key ? order : 'asc'}\n              onClick={createSortHandler(key)}\n            >\n              {prettifyString(key.substring(key.lastIndexOf('.') + 1, key.length))}\n              {orderBy === key ? (\n                <span className={classes.visuallyHidden}>\n                  {order === 'desc' ? 'sorted descending' : 'sorted ascending'}\n                </span>\n              ) : null}\n            </TableSortLabel>\n          </TableCell>\n        ))}\n      </TableRow>\n    </TableHead>\n  );\n}\n\nEnhancedTableHead.propTypes = {\n  classes: PropTypes.object.isRequired,\n  // numSelected: PropTypes.number.isRequired,\n  onRequestSort: PropTypes.func.isRequired,\n  // onSelectAllClick: PropTypes.func.isRequired,\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\n  orderBy: PropTypes.string.isRequired,\n  rowCount: PropTypes.number.isRequired,\n};\n\nfunction EnhancedTable(props) {\n  const { rows, classes, lookerContent } = props;\n  const [order, setOrder] = React.useState('asc');\n  const [orderBy, setOrderBy] = React.useState(Object.keys(rows[0])[0]);\n  const [page, setPage] = React.useState(0);\n  const [dense, setDense] = React.useState(true);\n  const [rowsPerPage, setRowsPerPage] = React.useState(25);\n\n  const handleRequestSort = (event, property) => {\n    const isAsc = orderBy === property && order === 'asc';\n    setOrder(isAsc ? 'desc' : 'asc');\n    setOrderBy(property);\n  };\n\n  const handleChangePage = (event, newPage) => {\n    setPage(newPage);\n  };\n\n  const handleChangeRowsPerPage = (event) => {\n    setRowsPerPage(parseInt(event.target.value, 10));\n    setPage(0);\n  };\n\n  const handleChangeDense = (event) => {\n    setDense(event.target.checked);\n  };\n\n  const emptyRows = rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage);\n\n  return (\n    <ApiHighlight>\n      <div className={classes.root}>\n        <TableContainer>\n          <Table\n            className={classes.table}\n            aria-labelledby=\"tableTitle\"\n            size={dense ? 'small' : 'medium'}\n            aria-label=\"enhanced table\"\n          >\n            <EnhancedTableHead\n              {...props}\n              classes={classes}\n              order={order}\n              orderBy={orderBy}\n              onRequestSort={handleRequestSort}\n              rowCount={rows.length}\n            />\n\n            <TableBody>\n              {stableSort(rows, getComparator(order, orderBy))\n                .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)\n                .map((row, index) => {\n                  return (\n                    <TableRow\n                      hover\n                      key={validIdHelper('TableRow-' + index)}\n                      id={validIdHelper('TableRow-' + index)}>\n                      {Object.keys(row).map((key, index) => (\n                        <TableCell\n                          key={validIdHelper(key + '-TableBody-TableCell-' + index)}\n                          id={validIdHelper(key + '-TableBody-TableCell-' + index)}\n                          className={lookerContent[0].fieldType[key] === 'dimension' ? classes.greySecondary : classes.orangeSecondary}\n                          align=\"right\">\n                          {row[key].rendered ? row[key].rendered : row[key].value}\n                        </TableCell>\n                      ))}\n                    </TableRow>\n                  );\n                })}\n              {emptyRows > 0 && (\n                <TableRow style={{ height: (dense ? 33 : 53) * emptyRows }}>\n                  <TableCell colSpan={6} />\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </TableContainer>\n        <TablePagination\n          rowsPerPageOptions={[5, 10, 25, 50]}\n          component=\"div\"\n          count={rows.length}\n          rowsPerPage={rowsPerPage}\n          page={page}\n          onChangePage={handleChangePage}\n          onChangeRowsPerPage={handleChangeRowsPerPage}\n        />\n        <FormControlLabel\n          control={<Switch checked={dense} onChange={handleChangeDense} />}\n          label=\"Compact\"\n        />\n      </div>\n    </ApiHighlight>\n  );\n}")}),[_,j]);var P=function(){var e=Object(d.a)(s.a.mark((function e(t,n){var a,o,r,l;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=Object(c.a)({},u)).status="running",p(a),e.next=5,fetch("/createquerytask/"+JSON.stringify(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return o=e.sent,e.next=8,o.json();case 8:r=e.sent,l=setInterval(Object(d.a)(s.a.mark((function e(){var t,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/checkquerytask/"+r.queryTaskId,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:"complete"===(n=e.sent).queryResults.status&&(clearInterval(l),p(n.queryResults),x(r.code));case 7:case"end":return e.stop()}}),e)}))),5e3);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"".concat(E.root," demoComponent")},o.a.createElement(me.a,{container:!0,spacing:3,key:dn(w)},o.a.createElement("div",{className:E.root},o.a.createElement(F.a,null,o.a.createElement(T.a,{position:"static"},o.a.createElement(We.a,{className:E.tabs,value:r,onChange:function(e,t){S(0),l(t)},"aria-label":"simple tabs example"},N.map((function(e,t){return o.a.createElement(Qe.a,Object.assign({key:"".concat(dn(D+"-tab-"+t)),label:e.label,className:"code flyout"===e.type?"".concat(E.mlAuto):""},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)))})))),o.a.createElement(F.a,{className:"tabPanelContainer"},N.map((function(t,n){return o.a.createElement(ln,{key:"".concat(dn(D+"-tabPanel-"+n)),value:r,index:n},o.a.createElement(me.a,{container:!0},"code flyout"===t.type?o.a.createElement(ye,Object.assign({},e,{classes:E,lookerContent:_,clientSideCode:y,serverSideCode:k,lookerUser:j})):o.a.createElement(o.a.Fragment,{key:"".concat(dn(D+"-innerFragment-"+n))},o.a.createElement(pn,Object.assign({},e,{classes:E,action:P})),o.a.createElement(te.a,{className:E.divider}),o.a.createElement(F.a,{className:E.w100,mt:2},"running"===u.status?o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(ue.a,{className:"".concat(E.card," ").concat(E.flexCentered)},o.a.createElement(pe.a,{className:E.circularProgress}))):u.data&&u.data.length?o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(hn,Object.assign({},e,{classes:E,rows:u.data,lookerContent:_}))):o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(O.a,{variant:"h6",component:"h6",className:"".concat(E.gridTitle," ").concat(E.textCenter)},"No results found, try a new query",o.a.createElement("br",null)))))))})))))))}function pn(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.classes,r=e.action,l=e.lookerUser,i=0,s=0,c=Object(a.useState)(!0),d=Object(J.a)(c,2),m=d[0],u=d[1],p=Object(a.useState)(t[0].queryBody?t[0].queryBody.fields.map((function(e,n){return{key:"fieldChipData"+n,label:mn(e.substring(e.lastIndexOf(".")+1,e.length)),datalabel:e,selected:!0,fieldType:t[0].fieldType[e]}})):""),b=Object(J.a)(p,2),h=b[0],y=b[1],f=Object(a.useState)(!1),g=Object(J.a)(f,2),C=g[0],k=g[1],E=Object(a.useState)(t[0].queryBody?Object.keys(t[0].queryBody.filters).map((function(e,n){return{key:"filter"+n,label:e,value:t[0].queryBody.filters[e],type:t[0].filterType[e]}})):""),_=Object(J.a)(E,2),w=_[0],T=_[1],S=function(e,t){var n=Object(v.a)(h);n[t].selected=!1===n[t].selected,y(n),k(!0)},j=function(e,t){var n=Object(v.a)(w);n[e].value=t,T(n),k(!0)};Object(a.useEffect)((function(){!function(e){if(C){var n=h.filter((function(e){return e.selected})).map((function(e){return e.datalabel})),a={};w.map((function(e,t){a[e.label]=e.value}));var o=t[0].queryBody;o.fields=n,o.filters=a,r(o,t[0].resultFormat)}}()}),[h,w]);var I={basic:["1 week","1 month","3 months","6 months"]};return I.advanced=[].concat(Object(v.a)(I.basic),["1 year"]),I.premium=[].concat(Object(v.a)(I.advanced),["before today"]),Object(a.useEffect)((function(){var e=Object(v.a)(w);e[3].value="6 months",T(e)}),[l]),o.a.createElement(nt.a,{expanded:m,onChange:function(e,t){u(!m)}},o.a.createElement(at.a,{expandIcon:o.a.createElement(dt.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(O.a,{className:n.heading},"Build Query")),o.a.createElement(ot.a,null,o.a.createElement(me.a,{container:!0,spacing:3},o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(O.a,{variant:"subtitle1"},"Select Fields:",h.length?h.map((function(e,t){return"measure"===e.fieldType?o.a.createElement(je.a,{key:e.label,measurecounter:i+=1,className:e.selected?"".concat(n.orangePrimary):"",label:mn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),datalabel:e.label,onClick:function(){return S(0,t)},icon:e.selected?o.a.createElement(Zt.a,{className:n.dBlock}):o.a.createElement(Zt.a,{className:n.dNone})}):""})):"",o.a.createElement("br",null))),o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(O.a,{variant:"subtitle1"},"Totals:",h.length?h.map((function(e,t){return"dimension"===e.fieldType?o.a.createElement(je.a,{key:e.label,dimensioncounter:s+=1,className:e.selected?"".concat(n.greyPrimary):"",label:mn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),datalabel:e.label,onClick:function(){return S(0,t)},icon:e.selected?o.a.createElement(Zt.a,{className:n.dBlock}):o.a.createElement(Zt.a,{className:n.dNone})}):""})):"",o.a.createElement("br",null))),o.a.createElement(me.a,{item:!0,sm:12},o.a.createElement(O.a,{variant:"subtitle1"},"Filter By:"),w.length?w.map((function(e,t){return o.a.createElement(rt.a,{className:e.value.length?n.formControl:n.hidden,key:dn("".concat(e.label,"FormControl"))},"yesno"===e.type?o.a.createElement(o.a.Fragment,null,o.a.createElement(lt.a,{id:dn("".concat(e.label,"FilterLabel"))},mn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),":"),o.a.createElement(it.a,{labelId:dn("".concat(e.label,"FilterLabel")),id:dn("".concat(e.label,"FilterSelect")),value:e.value,onChange:function(e){return j(t,e.target.value)}},o.a.createElement(ee.a,{value:"Yes"},"Yes"),o.a.createElement(ee.a,{value:"No"},"No"),o.a.createElement(ee.a,{value:"All"},"All"))):"date"===e.type?o.a.createElement(o.a.Fragment,null,o.a.createElement(lt.a,{id:dn("".concat(e.label,"FilterLabel"))},mn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),":"),o.a.createElement(it.a,{labelId:dn("".concat(e.label,"FilterLabel")),id:dn("".concat(e.label,"FilterSelect")),value:e.value||"6 months",onChange:function(e){return j(t,e.target.value)}},l.permission_level?I[l.permission_level].map((function(e){return o.a.createElement(ee.a,{key:dn(e),value:e},x.a.capitalize(e))})):"")):"")})):""))))}function bn(e){var t=e.classes,n=(e.onSelectAllClick,e.order),a=e.orderBy,r=(e.numSelected,e.rowCount,e.onRequestSort),l=e.rows;return o.a.createElement(yt.a,null,o.a.createElement(ft.a,null,Object.keys(l[0]).map((function(e,l){return o.a.createElement(bt.a,{key:dn(e+"-TableHead-TableCell-"+l),id:dn(e+"-TableHead-TableCell-"+l),align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",sortDirection:a===e&&n},o.a.createElement(Qt.a,{active:a===e,direction:a===e?n:"asc",onClick:(i=e,function(e){r(e,i)})},mn(e.substring(e.lastIndexOf(".")+1,e.length)),a===e?o.a.createElement("span",{className:t.visuallyHidden},"desc"===n?"sorted descending":"sorted ascending"):null));var i}))))}function hn(e){var t=e.rows,n=e.classes,a=e.lookerContent,r=o.a.useState("asc"),l=Object(J.a)(r,2),i=l[0],s=l[1],c=o.a.useState(Object.keys(t[0])[0]),d=Object(J.a)(c,2),m=d[0],u=d[1],p=o.a.useState(0),b=Object(J.a)(p,2),h=b[0],y=b[1],f=o.a.useState(!0),g=Object(J.a)(f,2),C=g[0],v=g[1],k=o.a.useState(25),x=Object(J.a)(k,2),E=x[0],_=x[1],w=E-Math.min(E,t.length-h*E);return o.a.createElement(Te,null,o.a.createElement("div",{className:n.root},o.a.createElement(ht.a,null,o.a.createElement(ut.a,{className:n.table,"aria-labelledby":"tableTitle",size:C?"small":"medium","aria-label":"enhanced table"},o.a.createElement(bn,Object.assign({},e,{classes:n,order:i,orderBy:m,onRequestSort:function(e,t){s(m===t&&"asc"===i?"desc":"asc"),u(t)},rowCount:t.length})),o.a.createElement(pt.a,null,function(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))}(t,function(e,t){return"desc"===e?function(e,n){return sn(e,n,t)}:function(e,n){return-sn(e,n,t)}}(i,m)).slice(h*E,h*E+E).map((function(e,t){return o.a.createElement(ft.a,{hover:!0,key:dn("TableRow-"+t),id:dn("TableRow-"+t)},Object.keys(e).map((function(t,r){return o.a.createElement(bt.a,{key:dn(t+"-TableBody-TableCell-"+r),id:dn(t+"-TableBody-TableCell-"+r),className:"dimension"===a[0].fieldType[t]?n.greySecondary:n.orangeSecondary,align:"right"},e[t].rendered?e[t].rendered:e[t].value)})))})),w>0&&o.a.createElement(ft.a,{style:{height:(C?33:53)*w}},o.a.createElement(bt.a,{colSpan:6}))))),o.a.createElement(Kt.a,{rowsPerPageOptions:[5,10,25,50],component:"div",count:t.length,rowsPerPage:E,page:h,onChangePage:function(e,t){y(t)},onChangeRowsPerPage:function(e){_(parseInt(e.target.value,10)),y(0)}}),o.a.createElement(Jt.a,{control:o.a.createElement(Yt.a,{checked:C,onChange:function(e){v(e.target.checked)}}),label:"Compact"})))}var yn=n(273),fn=n.n(yn);function gn(e){var t=e.className;return Object(a.useContext)(oe).show?o.a.createElement(F.a,{className:t},o.a.createElement(me.a,{container:!0},o.a.createElement(me.a,{item:!0,sm:6},o.a.createElement(O.a,{variant:"subtitle1"},o.a.createElement(fn.a,{style:{color:"#FF0000"}})," API")),o.a.createElement(me.a,{item:!0,sm:6},o.a.createElement(O.a,{variant:"subtitle1"},o.a.createElement(fn.a,{style:{color:"#0000FF"}})," Embed")))):o.a.createElement(o.a.Fragment,null)}var Cn=n(901),vn=n(1025),kn=n(1026),xn=n(61),En=n(42).validIdHelper,_n=Object(Y.a)((function(e){return{paper:{position:"absolute",width:1e3,maxHeight:450,overflow:"scroll",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},card:{display:"flex",flexDirection:"column",justifyContent:"space-between",maxHeight:300,minHeight:300,overflow:"scroll",cursor:"pointer","&:hover":{transform:"scale(1.05)",transition:"transform .2s"}},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},padding15:{padding:15}}}));function wn(){return{top:"".concat(10,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(10,"%)")}}function Tn(e){e.props;var t=e.switchLookerUser,n=Object(a.useContext)(oe),r=n.payWallModal,l=n.togglePayWallModal,i=n.lookerUser,s=o.a.useState(wn),c=Object(J.a)(s,1)[0],d=_n();return o.a.createElement(mt.a,{className:"".concat(d.modal," ").concat(d.padding15),open:r.show||!1,onClose:l},o.a.createElement(Cn.a,{in:r.show||!1},o.a.createElement("div",{style:c,className:d.paper},o.a.createElement("h2",{id:"simple-modal-title"},"Upgrade user account to ",r.permissionNeeded),o.a.createElement(me.a,{container:!0,spacing:3},Object.keys(xn).map((function(e){return o.a.createElement(me.a,{item:!0,sm:4,key:En("monetizationModal-gridItem-".concat(e))},o.a.createElement(ue.a,{className:"".concat(d.card," "),elevation:1,style:e===i.permission_level?{transform:"scale(1.05)",transition:"transform .2s"}:{}},o.a.createElement(vn.a,null,o.a.createElement(O.a,{variant:"h6"},x.a.capitalize(e)," user permissions",e===i.permission_level?o.a.createElement(je.a,{label:"Active"}):""),"advanced"===e?o.a.createElement(O.a,{variant:"subtitle2",gutterBottom:!0},"...Basic user permissions plus"):"premium"===e?o.a.createElement(O.a,{variant:"subtitle2",gutterBottom:!0},"...Advanced user permissions plus"):"",xn[e]?xn[e].map((function(t){return o.a.createElement(O.a,{variant:"subtitle2",gutterBottom:!0,color:"secondary",key:En("monetizationModal-".concat(e,"-permissionItem-").concat(t)),style:t===r.permissionNeeded?{backgroundColor:"yellow"}:{}},"basic"===e||"advanced"===e&&-1==xn.basic.indexOf(t)||"premium"===e&&-1==xn.advanced.indexOf(t)?t:"")})):""),o.a.createElement(kn.a,{disableSpacing:!1},e===i.permission_level?"":o.a.createElement(Ut.a,{color:"primary",onClick:function(){t(e),l()}},"Upgrade"))))}))))))}var Sn=n(42).validIdHelper,jn=Object(V.a)({}),On=Object(V.a)({palette:{primary:{main:Q.a[900]},secondary:{main:Q.a[400]}}}),In=Object(V.a)({palette:{primary:{main:K.a[500]}}}),Nn=function(e){Object(b.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(u.a)(this,a),(n=t.call(this,e)).togglePayWallModal=function(e){n.setState({payWallModal:Object(c.a)({},e)})},n.toggleHighlightShow=function(){n.setState({highlightShow:!n.state.highlightShow})},n.handleTabChange=function(e){n.setState({activeTabValue:e})},n.handleMenuItemSelect=function(e,t){n.handleTabChange(0);var a="";t?se[n.state.activeUsecase].demoComponents.map((function(t){"splash page"!==t.type&&t.lookerContent.map((function(n){n.id===e&&(a=Sn(t.type+n.id))}))})):a=e;var o=Object(v.a)(n.state.renderedDemoComponents);-1==o.indexOf(a)&&o.unshift(a),n.setState((function(e){return{selectedMenuItem:a,renderedDemoComponents:Object(v.a)(o)}}))},n.state={drawerOpen:!0,drawerTabValue:0,activeTabValue:0,activeUsecase:"",appLayout:"",highlightShow:!1,payWallModal:{},selectedMenuItem:"",renderedDemoComponents:[]},n}return Object(p.a)(a,[{key:"componentDidMount",value:function(e){var t=this,n=window.location.pathname.replace(/^\/([^\/]*).*$/,"$1");this.setState({activeUsecase:n,appLayout:se[n].layout||"left-sidebar"},(function(){ie.LookerEmbedSDK.init("https://".concat(t.props.lookerHost,".looker.com"),"/auth")}))}},{key:"componentDidUpdate",value:function(e){var t=e.lookerUser.permission_level,n=this.props.lookerUser.permission_level,a=e.lookerUser.user_attributes.brand,o=this.props.lookerUser.user_attributes.brand;t===n&&a===o||this.setState({renderedDemoComponents:[this.state.selectedMenuItem]})}},{key:"render",value:function(){var e={splashpage19:Ve,simpledashboard5:tt,simpledashboard9:tt,customfilter1:tt,customvis:Pt,querybuilderexplorelite:un,reportbuilder14:Vt},t={atom:On,vidly:In},a=this.state,r=(a.drawerTabValue,a.drawerOpen),l=a.activeTabValue,i=a.activeUsecase,s=a.selectedMenuItem,c=a.renderedDemoComponents,d=this.handleTabChange,m=this.handleMenuItemSelect,u=this.props,p=u.classes,b=(u.activeCustomization,u.switchLookerUser),h=u.lookerUser,y=u.applySession,f=u.lookerUserAttributeBrandOptions,g=u.switchUserAttributeBrand,k=u.lookerHost,_=u.userProfile,D=i?x.a.orderBy(se[i].demoComponents,["menuCategory"],["asc"]):[],P={},H=[],A=0;if(D.map((function(e,t){P.hasOwnProperty(e.menuCategory)?P[e.menuCategory]=[].concat(Object(v.a)(P[e.menuCategory]),[e]):(P[e.menuCategory]=[e],A+=1,H.push(""+(t+A)))})),i&&!s.length){var U=se[i].demoComponents[0].lookerContent[0].id?Sn(se[i].demoComponents[0].type+se[i].demoComponents[0].lookerContent[0].id):Sn(se[i].demoComponents[0].type);this.setState({selectedMenuItem:U,renderedDemoComponents:[U]},(function(){}))}return o.a.createElement("div",{className:p.root},o.a.createElement(oe.Provider,{value:{show:this.state.highlightShow,toggleShow:this.toggleHighlightShow,payWallModal:this.state.payWallModal,togglePayWallModal:this.togglePayWallModal,lookerUser:h,userProfile:_}},o.a.createElement(W.a,{theme:i?t[i]:jn},o.a.createElement(w.a,null),o.a.createElement(T.a,{position:"fixed",className:Object(E.a)(p.appBar)},o.a.createElement(S.a,null,i?o.a.createElement(j.a,{alt:"Icon",src:n(878)("./".concat(i,"_logo_white.svg")),variant:"square"}):"",o.a.createElement(O.a,{align:"center",className:"".concat(p.mr12," ").concat(p.mlAuto," ").concat(p.mrAuto)},h.user_attributes.brand),o.a.createElement(I.a,{badgeContent:3,color:"error",className:"".concat(p.mr12," ")},o.a.createElement(R.a,null)),o.a.createElement(le,{lookerUser:h,switchLookerUser:b,onLogoutSuccess:y,lookerUserAttributeBrandOptions:f,switchUserAttributeBrand:g}))),o.a.createElement(N.a,{className:p.drawer,variant:"persistent",anchor:"left",open:r,classes:{paper:p.drawerPaper}},o.a.createElement("div",{className:p.drawerHeader}),Object.keys(P).length?o.a.createElement(Dn,Object.assign({},this.props,{classes:p,activeUsecase:i,orderedDemoComponentsForMenuObj:P,selectedMenuItem:s,handleMenuItemSelect:m})):"",o.a.createElement(gn,{className:p.highlightLegend}),o.a.createElement(Tn,{switchLookerUser:b})),o.a.createElement("main",{className:Object(E.a)(p.content,Object(C.a)({},p.contentShift,r))},o.a.createElement("div",{className:p.drawerHeader}),i?se[i].demoComponents.map((function(t,n){var a=t.lookerContent[0].id?Sn(t.type+t.lookerContent[0].id):Sn(t.type),r=e[a];return o.a.createElement(o.a.Fragment,{key:Sn("outerFragment-".concat(t.type,"-").concat(n))},c.indexOf(a)>-1?o.a.createElement(F.a,{key:Sn("box-".concat(t.type,"-").concat(n)),className:a===s?"":"".concat(p.hide)},o.a.createElement(r,{key:Sn("demoComponent-".concat(t.type,"-").concat(n)),staticContent:t,handleMenuItemSelect:m,activeTabValue:l,handleTabChange:d,lookerUser:h,activeUsecase:i,lookerHost:k,userProfile:_})):"")})):""))))}}]),a}(a.Component),Fn=Object(_.a)((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),zIndex:1201,backgroundColor:"#605E57"},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerHeader:Object(c.a)(Object(c.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},title:{flexGrow:1},tabs:{borderRight:"1px solid ".concat(e.palette.divider)},dNone:{display:"none"},dBlock:{display:"block"},relative:{position:"relative"},absolute:{position:"absolute"},right0:{right:0},top0:{top:0},right24:{right:24},top24:{top:24},ml12:{marginLeft:12},mr12:{marginRight:12},mt12:{marginTop:12},highlightLegend:{position:"fixed",bottom:e.spacing(2),left:e.spacing(2),zIndex:1200},tree:{height:240,flexGrow:1,maxWidth:400},parentHoverVisibility:{"&:hover $childHoverVisibility":{visibility:"visible"}},childHoverVisibility:{visibility:"hidden"},fontSize1em:{fontSize:"1em"},padding10:{padding:10},mt5:{marginTop:5},mb5:{marginBottom:5},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},list:{width:"100%",maxWidth:360,backgroundColor:e.palette.background.paper},nested:{paddingLeft:e.spacing(4)},mlAuto:{marginLeft:"auto"},mrAuto:{marginRight:"auto"}}}))(Nn);function Dn(e){var t=e.classes,n=e.activeUsecase,a=e.orderedDemoComponentsForMenuObj,r=e.selectedMenuItem,l=e.handleMenuItemSelect,i={splashpage19:z.a,simpledashboard5:U.a,simpledashboard9:B.a,customfilter1:L.a,customvis:$.a,querybuilderexplorelite:M.a,reportbuilder14:q.a};return o.a.createElement(D.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:t.list},n?Object.keys(a).map((function(e,n){return o.a.createElement(o.a.Fragment,{key:"".concat(Sn(e+"-menuList-"+n))},o.a.createElement(P.a,{button:!0,key:"".concat(Sn(e+"-outerListItem-"+n))},o.a.createElement(H.a,{primary:x.a.capitalize(e)})),o.a.createElement(D.a,{component:"div",disablePadding:!0,key:"".concat(Sn(e+"-innerList-"+n))},a[e].map((function(n,a){var s=n.lookerContent[0].id?Sn(n.type+n.lookerContent[0].id):Sn(n.type),c=i[s];return o.a.createElement(P.a,{button:!0,className:t.nested,key:"".concat(Sn(e+"-innerListItem-"+a)),onClick:function(){return l(Sn(n.lookerContent[0].id?n.type+n.lookerContent[0].id:n.type))},selected:Sn(n.lookerContent[0].id?n.type+n.lookerContent[0].id:n.type)===r},o.a.createElement(A.a,null,o.a.createElement(c,null)),o.a.createElement(H.a,{primary:x.a.capitalize(n.label)}))}))))})):"")}var Pn=n(42).validIdHelper,Hn=Q.a[200],An=Object(Y.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},card:{minWidth:350,minHeight:500,left:"75%",top:"50%",transform:"translate(-75%, -50%)",position:"absolute",textAlign:"center",backgroundColor:Hn},h100:{height:"100%"},title:{fontSize:14},pos:{marginBottom:12},actions:{alignItems:"center",justifyContent:"center"},cardCopy:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",width:"80%"}}}));function Rn(e){var t=e.googleClientId,a=e.onSuccess,r=(e.onFailure,An()),l=window.location.pathname.replace(/^\/([^\/]*).*$/,"$1"),i=Math.floor(4*Math.random())+1,s=n(880)("./".concat(l,"_background").concat(i,".jpg")),c=n(885)("./".concat(l,"_logo_black.svg"));return o.a.createElement("div",{className:"".concat(r.root," demoComponent ").concat(r.h100)},o.a.createElement(me.a,{container:!0,key:Pn("sign in page"),className:"".concat(r.h100)},o.a.createElement(me.a,{item:!0,sm:12,className:"sign-in-background-img",style:{backgroundImage:"url(".concat(s,")"),backgroundSize:"cover"}},o.a.createElement(ue.a,{className:r.card},o.a.createElement("div",{className:r.cardCopy},o.a.createElement("img",{src:c}),o.a.createElement(vn.a,null,o.a.createElement(O.a,{variant:"h5",component:"h2"},"Welcome"),o.a.createElement(O.a,{variant:"body2",component:"p"},"Please sign in to access ",o.a.createElement("br",null)," your merchant portal")),o.a.createElement(kn.a,{className:"".concat(r.actions)},o.a.createElement(g.GoogleLogin,{clientId:t,buttonText:"Login",onSuccess:a,onFailure:a,cookiePolicy:"single_host_origin"})))))))}var Un=n(117),Bn=n(390),Ln=n.n(Bn),$n=(o.a.Component,n(60));o.a.Component;var Mn=n(275),qn=n(392),Gn=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).responseGoogle=function(e){e.error?console.log("response.error",e.error):a.props.applySession(e.profileObj)},a}return Object(p.a)(n,[{key:"render",value:function(){var e=(this.props.location.state||{from:{pathname:"/home"}}).from,t=(this.props.location.pathname,this.props.activeCustomization,this.props.userProfile),n="".concat("610722499102-hqo4cena1n453n11mqk88jj5arv4p3ft",".apps.googleusercontent.com");return Object.keys(t).length?o.a.createElement("div",{className:"App"},o.a.createElement(y.a,{to:e})):o.a.createElement(Rn,{googleClientId:n,onSuccess:this.responseGoogle,onFailure:this.responseGoogle})}}]),n}(o.a.Component),zn=function(e){var t=e.component,n=e.customizations,a=e.activeCustomization,r=e.applyCustomization,l=e.editCustomization,i=e.indexOfCustomizationToEdit,s=e.saveCustomization,c=e.cancelIndexOfCustomizationToEdit,d=e.lookerContent,u=e.saveLookerContent,p=e.userProfile,b=e.lookerUser,h=e.lookerHost,f=e.switchLookerUser,g=e.applySession,C=e.lookerUserAttributeBrandOptions,v=e.switchUserAttributeBrand,k=Object(m.a)(e,["component","customizations","activeCustomization","applyCustomization","editCustomization","indexOfCustomizationToEdit","saveCustomization","cancelIndexOfCustomizationToEdit","lookerContent","saveLookerContent","userProfile","lookerUser","lookerHost","switchLookerUser","applySession","lookerUserAttributeBrandOptions","switchUserAttributeBrand"]);return o.a.createElement(y.b,Object.assign({},k,{render:function(e){return Object.keys(p).length?o.a.createElement(t,Object.assign({},e,{customizations:n,activeCustomization:a,applyCustomization:r,editCustomization:l,indexOfCustomizationToEdit:i,saveCustomization:s,cancelIndexOfCustomizationToEdit:c,lookerContent:d,saveLookerContent:u,userProfile:p,lookerUser:b,lookerHost:h,switchLookerUser:f,applySession:g,lookerUserAttributeBrandOptions:C,switchUserAttributeBrand:v})):o.a.createElement(y.a,{to:{pathname:"/",state:{from:e.location}}})}}))},Vn=function(e){Object(b.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).checkSession=Object(d.a)(s.a.mark((function e(){var t,n,o,r,l,i,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/readsession",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o=n.session.userProfile,r=n.session.customizations,l=n.session.activeCustomization?n.session.activeCustomization:0,i=n.session.lookerUser?n.session.lookerUser:a.state.lookerUser,d=n.session.lookerHost?n.session.lookerHost:a.state.lookerHost,o&&Object.keys(o).length&&a.setState((function(e){return{userProfile:o,customizations:r,lookerUser:Object(c.a)(Object(c.a)({},e.lookerUser),{},{external_user_id:o.googleId,first_name:o.givenName,last_name:o.familyName,permissions:xn[i.permission_level]||xn.basic,permission_level:i.permission_level||"basic",user_attributes:Object(c.a)({},i.user_attributes||{locale:"en_US",country:"USA",brand:"Calvin Klein"})}),lookerHost:d}}),(function(){a.applyCustomization(l)}));case 12:case"end":return e.stop()}}),e)}))),a.applySession=function(){var e=Object(d.a)(s.a.mark((function e(t){var n,o,r,l,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(t).length){e.next=7;break}return e.next=3,fetch("/endsession",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}});case 3:e.sent,a.setState({userProfile:{},lookerUser:Object(c.a)({},Mn)}),e.next=17;break;case 7:return e.next=9,fetch("/writesession",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userProfile:t,lookerUser:a.state.lookerUser})});case 9:return n=e.sent,e.next=12,n.json();case 12:o=e.sent,r=o.session.customizations,l=o.session.lookerUser?o.session.lookerUser:a.state.lookerUser,i=o.session.lookerHost?o.session.lookerHost:a.state.lookerHost,a.setState((function(e){return{userProfile:t,customizations:r,lookerUser:Object(c.a)(Object(c.a)({},e.lookerUser),{},{external_user_id:t.googleId,first_name:t.givenName,last_name:t.familyName,permissions:xn[l.permission_level]||xn.basic,permission_level:l.permission_level||"basic",user_attributes:Object(c.a)({},l.user_attributes||{locale:"en_US",country:"USA",brand:"Calvin Klein",time_horizon:"last 6 months"})}),lookerHost:i}}),(function(){a.applyCustomization(0)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.applyCustomization=function(){var e=Object(d.a)(s.a.mark((function e(t){var n,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/applyactivecustomziation",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({customizationIndex:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:e.sent,o=[],a.state.customizations[t].industry,a.state.customizations[t].lookerContent,a.setState({activeCustomization:a.state.customizations[t],lookerContent:o},(function(){}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.editCustomization=function(e){var t="undefined"===typeof a.state.customizations[e]?null:e;a.setState({indexOfCustomizationToEdit:t},(function(){}))},a.saveCustomization=function(){var e=Object(d.a)(s.a.mark((function e(t){var n,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/savecustomization",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:o=e.sent,a.setState({customizations:o.customizations},(function(){a.applyCustomization(t.customizationIndex)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.cancelIndexOfCustomizationToEdit=function(){a.setState({indexOfCustomizationToEdit:null})},a.saveLookerContent=function(){var e=Object(d.a)(s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.switchLookerUser=function(e){var t=Object(c.a)({},a.state.lookerUser.user_attributes);t.time_horizon={basic:"last 6 months",advanced:"last 12 months",premium:"last 24 months"}[e],a.setState((function(n){return{lookerUser:Object(c.a)(Object(c.a)({},n.lookerUser),{},{permissions:xn[e],permission_level:e,user_attributes:t})}}),Object(d.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/updatelookeruser",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a.state.lookerUser)});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)}))))},a.switchUserAttributeBrand=function(e){var t=Object(c.a)({},a.state.lookerUser.user_attributes);t.brand=e,a.setState((function(e){return{lookerUser:Object(c.a)(Object(c.a)({},e.lookerUser),{},{user_attributes:t})}}),Object(d.a)(s.a.mark((function e(){var t;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/updatelookeruser",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a.state.lookerUser)});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)}))))},a.state={userProfile:{},customizations:[],activeCustomization:{},indexOfCustomizationToEdit:null,lookerContent:[],lookerUser:Object(c.a)({},Mn),lookerHost:"",activeUsecase:""},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.checkSession()}},{key:"render",value:function(){var e=this,t=this.state,n=t.userProfile,a=(t.customizations,t.activeCustomization),r=(t.indexOfCustomizationToEdit,t.lookerContent),l=t.lookerUser,i=t.lookerHost,s=window.location.pathname.replace(/^\/([^\/]*).*$/,"$1");return console.log("usecaseFromUrl",s),s.length?se.hasOwnProperty(s)||(window.location.href=window.location.href.replace(s,"atom")):window.location.href=window.location.href+"atom",o.a.createElement(f.a,{basename:s},o.a.createElement("div",null,o.a.createElement(y.b,{path:"",render:function(t){return o.a.createElement(Gn,Object.assign({},t,{applySession:e.applySession,userProfile:n,activeCustomization:a,lookerUser:l,switchLookerUser:e.switchLookerUser,lookerHost:i}))}}),o.a.createElement(zn,{path:"*/home",component:Fn,activeCustomization:a,lookerContent:r,saveLookerContent:this.saveLookerContent,userProfile:n,lookerUser:l,applySession:this.applySession,lookerHost:i,switchLookerUser:this.switchLookerUser,lookerUserAttributeBrandOptions:qn,switchUserAttributeBrand:this.switchUserAttributeBrand})))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(o.a.createElement(Vn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[428,1,2]]]);
//# sourceMappingURL=main.3cefb340.chunk.js.map