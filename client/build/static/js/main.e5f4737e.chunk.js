(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{256:function(e,t,n){},272:function(e){e.exports=JSON.parse('{"external_user_id":"","first_name":"","last_name":"","session_length":86400,"force_logout_login":true,"external_group_id":"","group_ids":[4],"permissions":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit"],"models":["atom_fashion"],"user_attributes":{"locale":"en_US","country":"USA","brand":"Calvin Klein","time_horizon":"last 182 days","permission_level":"basic"}}')},361:function(e,t,n){e.exports=n.p+"static/media/atom_splash_blog.57457a86.jpg"},362:function(e,t,n){e.exports=n.p+"static/media/atom_splash_inventory.6bbb655e.jpg"},363:function(e,t,n){e.exports=n.p+"static/media/atom_splash_trends.dbd4fdc6.jpg"},365:function(e,t,n){e.exports=n.p+"static/media/atom_logo_black.a213ea2a.svg"},394:function(e){e.exports=JSON.parse('[{"label":"Columbia"},{"label":"Calvin Klein"},{"label":"Carhartt"},{"label":"Levi\'s"},{"label":"Dockers"}]')},430:function(e,t,n){e.exports=n(890)},435:function(e,t,n){},437:function(e,t,n){},48:function(e,t){e.exports={makeid:function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*a));return t},validIdHelper:function(e){return e.replace(/[^a-zA-Z0-9-.#]/g,"")},prettifyString:function(e){var t,n=e.split("_");for(t=0;t<n.length;t++)n[t]=n[t].charAt(0).toUpperCase()+n[t].slice(1);return n.join(" ")},getUrlVars:function(e){for(var t,n={},a=e.slice(e.indexOf("?")+1).split("&"),o=0;o<a.length;o++)n[(t=a[o].split("="))[0]]=t[1];return n},decodeHtml:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}}},62:function(e){e.exports=JSON.parse('{"atom":{"label":"Atom Fashion","vignette":{"name":"Atom","logo_url":"../images/atom_logo.png"},"layout":"right-appbar","demoComponents":[{"type":"splash page","label":"Home","description":"We\'re thrilled to have you on Atom Fashion - the premiere third party fashion marketplace for today\'s leading brands. Throughout this portal you will find a series of analytic content designed to help you maximize your performance.","icon":"fa-home","menuCategory":"home","lookerContent":[{"id":"19","gridWidth":6,"height":225,"type":"welcome","inlineQueries":[{"model":"atom_fashion","view":"order_items","fields":["order_items.total_sale_price","order_items.created_week","products.category"],"pivots":["order_items.created_week"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"2 weeks ago for 2 weeks"},"filter_expression":null,"sorts":["order_items.total_sale_price desc 1","order_items.created_week 0"],"limit":"1","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(pivot_index(${order_items.total_sale_price},2)-pivot_index(${order_items.total_sale_price},1))/pivot_index(${order_items.total_sale_price},1\\\\n  )\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"supermeasure\\",\\"_type_hint\\":\\"number\\"}]"},{"model":"atom_fashion","view":"order_items","fields":["order_items.total_sale_price","order_items.created_week","products.category"],"pivots":["order_items.created_week"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"2 weeks ago for 2 weeks"},"filter_expression":null,"sorts":["order_items.total_sale_price 1","order_items.created_week 0"],"limit":"1","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(pivot_index(${order_items.total_sale_price},2)-pivot_index(${order_items.total_sale_price},1))/pivot_index(${order_items.total_sale_price},1\\\\n  )\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"supermeasure\\",\\"_type_hint\\":\\"number\\"}]"}],"inlineQueriesMap":["best","worst"],"resultFormat":"json"},{"id":"17","gridWidth":6,"height":225,"type":"carousel"},{"id":"18","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_week","order_items.total_gross_margin"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"12 weeks ago for 12 weeks"},"sorts":["order_items.created_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"Week over Week %25 Change\\",\\"expression\\":\\"(${order_items.total_gross_margin}-offset(${order_items.total_gross_margin},1))/offset(${order_items.total_gross_margin},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Revenue by Week","visColor":"#4595EC","chipFormat":"revenue"},{"id":"20","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","events.sessions_count"],"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${events.sessions_count}-offset(${events.sessions_count},1))/offset(${events.sessions_count},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Visits by Week","visColor":"#F3A759","chipFormat":"integer"},{"id":"21","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","events.bounce_rate"],"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"filter_expression":null,"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${events.bounce_rate}-offset(${events.bounce_rate},1))/offset(${events.bounce_rate},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Bounce Rate by Week","visColor":"#E24E3A","chipFormat":"percent"},{"id":"22","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","sessions.average_duration"],"pivots":null,"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"filter_expression":null,"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${sessions.average_duration}-offset(${sessions.average_duration},1))/offset(${sessions.average_duration},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Average Time on Site by Week","visColor":"#65AB5A","chipFormat":"integer"},{"gridWidth":8,"height":400,"type":"dashboard","id":"12","slug":"3ytMWYFKKbofCDFkpAG46z"},{"gridWidth":4,"height":400,"type":"popular analysis","vectors":[{"id":"9","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Analytics","gridWidth":"4"},{"id":"5","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Sales","gridWidth":"4"},{"id":"1","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Inventory","gridWidth":"4"}],"label":"Popular analysis"}]},{"type":"simple dashboard","label":"Web Analytics","menuCategory":"marketing","description":"Overview of all your web traffic","icon":"fa-chart-line","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"9","label":"Web Analytics","isNext":false,"theme":"atom_fashion_filters"}]},{"type":"simple dashboard","label":"Sales Overview","menuCategory":"sales","description":"Overview of all your sales!","icon":"fa-tachometer-alt","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"5","label":"Sales Overview","isNext":true,"filters":[{"label":"Select Category","filterName":"Category","lookerMethod":"runInlineQuery"},{"label":"Select region","filterName":"State Region","lookerMethod":"runInlineQuery"}],"inlineQueries":[{"model":"atom_fashion","view":"order_items","fields":["this_period","last_period","products.category"],"filters":{"order_items.created_date":"60 days ago for 60 days","order_items.count":">5"},"sorts":["products.category"],"limit":500,"dynamic_fields":"[{\\"table_calculation\\":\\"trend\\",\\"label\\":\\"trend\\",\\"expression\\":\\"${this_period} / ${last_period} - 1\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"},{\\"measure\\":\\"this_period\\",\\"based_on\\":\\"order_items.total_sale_price\\",\\"type\\":\\"count_distinct\\",\\"label\\":\\"This Period\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\",\\"filter_expression\\":\\"matches_filter(${order_items.created_date},`30 days ago for 30 days`)\\"},{\\"measure\\":\\"last_period\\",\\"based_on\\":\\"order_items.total_gross_margin\\",\\"label\\":\\"Last Period\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\",\\"filter_expression\\":\\"matches_filter(${order_items.created_date},`60 days ago for 30 days`)\\"}]","theme":"atom_fashion"},{"model":"atom_fashion","view":"order_items","fields":["users.state_region"],"limit":"500"}],"desiredFilterName":["products.brand","users.state_region"],"filterComponents":["autocomplete","togglebutton"]}]},{"type":"custom filter","label":"Inventory Overview","menuCategory":"operations","description":"Overview of your inventory","icon":"fa-tshirt","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"1","isNext":false,"label":"Inventory Overview","filters":[{"label":"Select Product Name","filterName":"Product Name","lookerMethod":"runInlineQuery"}],"inlineQueries":[{"model":"atom_fashion","view":"order_items","fields":["products.item_name"],"query_timezone":"America/Los_Angeles"}],"desiredFilterNames":["products.brand"],"filterComponents":["autocomplete"],"dynamicFieldLookUp":{"Inventory":[118,124,123,122,121],"Orders":[6,7,8,2,127]},"theme":"atom_fashion"}]},{"type":"custom vis","label":"Sales Calendar","menuCategory":"sales","description":"Ayeeeeeee","icon":"fa-calendar","lookerContent":[{"type":"custom vis","lookerMethod":"runInlineQuery","label":"Sales Calendar","inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_date","products.category","order_items.order_count","order_items.total_sale_price"],"query_timezone":"America/Los_Angeles","limit":"-1"},"desiredFilterName":"products.brand","desiredFields":["order_items.order_count","order_items.total_sale_price"],"resultFormat":"json"}]},{"type":"report builder","label":"Saved Reports","menuCategory":"operations","description":"Give users the ability to explore existing reports as well as create new ones all from within your application","icon":"fa-sticky-note","lookerContent":[{"type":"folder","id":"14","label":"Saved Reports"},{"type":"explore","id":"atom_fashion::order_items","label":"Create New Report"}]},{"type":"query builder","label":"Query Builder","menuCategory":"operations","description":"Enable business users to self serve on data and answer their own questions","icon":"fa-search","lookerContent":[{"type":"explorelite","id":"explorelite","label":"Build & Run Queries","queryBody":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_month","order_items.created_date","order_items.created_week","users.city","users.state","users.country","products.category_type","products.category","products.brand","order_items.total_sale_price","order_items.total_tax_amount"],"filters":{"users.state":"","users.city":"","users.country":"","order_items.created_date":"6 months"},"limit":500},"resultFormat":"json","fieldType":{"order_items.created_month":"dimension","order_items.created_date":"dimension","order_items.created_week":"dimension","users.city":"dimension","users.state":"dimension","users.country":"dimension","products.category_type":"dimension","products.category":"dimension","products.brand":"dimension","order_items.total_sale_price":"measure","order_items.total_tax_amount":"measure"},"filterType":{"users.state":"string","users.city":"string","users.country":"string","order_items.created_date":"date"}}]}],"groupIds":{"Calvin Klein":4,"Carhartt":5,"Columbia":6,"Levis":7,"Dockers":8}},"vidly":{"label":"Vidly Media","vignette":{"name":"Vidly","logo":""},"layout":"right-appbar","demoComponents":[]}}')},67:function(e){e.exports=JSON.parse('{"basic":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit"],"advanced":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit","schedule_look_emails","schedule_external_look_emails","create_alerts","see_drill_overlay"],"premium":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit","schedule_look_emails","schedule_external_look_emails","create_alerts","see_drill_overlay","save_content","embed_browse_spaces","schedule_look_emails","send_to_sftp","send_to_s3","send_outgoing_webhook","see_sql","send_to_integration","download_without_limit","explore"]}')},880:function(e,t,n){var a={"./atom.svg":881,"./atom_logo_black.svg":365,"./atom_logo_white.svg":882};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=880},881:function(e,t,n){e.exports=n.p+"static/media/atom.e208988c.svg"},882:function(e,t,n){e.exports=n.p+"static/media/atom_logo_white.89cfe3df.svg"},883:function(e,t,n){var a={"./atom_background1.jpg":884,"./atom_background2.jpg":885,"./atom_background3.jpg":886,"./atom_background4.jpg":887,"./atom_splash_blog.jpg":361,"./atom_splash_inventory.jpg":362,"./atom_splash_trends.jpg":363};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=883},884:function(e,t,n){e.exports=n.p+"static/media/atom_background1.9ed7593f.jpg"},885:function(e,t,n){e.exports=n.p+"static/media/atom_background2.c5efc290.jpg"},886:function(e,t,n){e.exports=n.p+"static/media/atom_background3.b9aecb61.jpg"},887:function(e,t,n){e.exports=n.p+"static/media/atom_background4.1acd6c1b.jpg"},888:function(e,t,n){var a={"./atom_logo_black.svg":365};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=888},890:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(23),i=n.n(r),s=(n(435),n(20)),l=n(12),c=n.n(l),d=n(26),m=n(61),u=n(39),p=n(36),h=n(87),g=n(86),b=(n(437),n(101)),f=n(130),y=n(257),C=n(41),v=n(38),k=n(43),w=n.n(k),x=n(3),E=n(5),_=n(1039),S=n(1067),j=n(892),O=n(1050),T=n(1026),I=n(1025),N=n(1057),F=n(1042),D=n(954),H=n(893),P=n(1036),R=n(1035),A=n(1040),B=n(1041),L=n(1043),U=n(1044),$=n(1045),M=n(1046),G=n(1047),q=n(1031),z=n(1048),V=n(391),W=n.n(V),Q=n(395),K=n(1038),J=n(206),Y=n(209),X=n(7),Z=n(950),ee=n(135),te=n(397),ne=n(955),ae=n(956),oe=n(1060),re=n(1051),ie=o.a.createContext(null),se=(n(48).validIdHelper,Object(Z.a)((function(e){return{zIndex1500:{zIndex:1500},mr12:{marginRight:12}}})));function le(e){var t=e.lookerUser,n=e.onLogoutSuccess,r=e.lookerUserAttributeBrandOptions,i=e.handleUserMenuSwitch,s=se(),l=Object(a.useContext)(ie),c=l.togglePayWallModal,d=(l.codeShow,l.toggleShow,l.userProfile),m=o.a.useState(null),u=Object(X.a)(m,2),p=u[0],h=u[1],g=o.a.useState(t.user_attributes.brand||""),b=Object(X.a)(g,2),f=b[0],y=b[1],C=function(e,t){h(null),null==e?n({}):"modal"===e?c({show:!0,permissionNeeded:"explore"}):"string"===typeof e&&i(e,t)};return Object(a.useEffect)((function(){y(t.user_attributes.brand||"")}),[t]),o.a.createElement("div",{className:"".concat(s.zIndex1500)},o.a.createElement(j.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){h(e.currentTarget)},color:"inherit"},o.a.createElement(N.a,{alt:d.name,src:d.imageUrl,className:s.mr12}),o.a.createElement(ee.a,null,"string"===typeof t.user_attributes.permission_level?t.user_attributes.permission_level.charAt(0).toUpperCase()+t.user_attributes.permission_level.substring(1):"")),o.a.createElement(te.a,{id:"simple-menu",anchorEl:p,keepMounted:!0,open:Boolean(p),onClose:C},o.a.createElement(ne.a,{autoFocus:!1},"Select User Level"),o.a.createElement(ne.a,{autoFocus:!1,onClick:function(){return C("basic","permission")}},"Basic"),o.a.createElement(ne.a,{autoFocus:!1,onClick:function(){return C("advanced","permission")}},"Advanced"),o.a.createElement(ne.a,{autoFocus:!1,onClick:function(){return C("premium","permission")}},"Premium"),o.a.createElement(ae.a,{className:s.divider}),o.a.createElement(ne.a,{onClick:function(){return C(null)}},"Sign Out"),o.a.createElement(ae.a,{className:s.divider}),o.a.createElement(ne.a,{onClick:function(){return C("modal")}},"Show Modal"),o.a.createElement(ae.a,{className:s.divider}),o.a.createElement(ne.a,null,"Current brand: ",f),o.a.createElement(ne.a,null,o.a.createElement(re.a,{id:"combo-box-usermenu",options:r,getOptionLabel:function(e){return e.label},style:{width:300},onChange:function(e){return C(e.target.innerText||"","brand")},renderInput:function(e){return o.a.createElement(oe.a,Object.assign({},e,{label:"Change merchant brand",variant:"outlined"}))},loadingText:"Loading...",disableautofocus:"true",onKeyDown:function(e){return e.stopPropagation()}}))))}var ce=n(37),de=n(62),me=n(35),ue=n.n(me),pe=n(1007),he=n(961),ge=n(1008),be=n(960),fe=n(894),ye=n(367),Ce=n.n(ye),ve=n(1055),ke=n(962);function we(e){var t=Object(a.useContext)(ie).toggleCodeShow,n=Object(a.useContext)(ie).codeShow,r=e.classes,i=(e.lookerContent,e.clientSideCode,e.serverSideCode,e.lookerUser),s=(e.permissionNeededCode,e.height);return o.a.createElement(be.a,{onClickAway:function(){t()}},o.a.createElement(fe.a,{in:n||!1},Object.keys(i).length?o.a.createElement(he.a,{container:!0,spacing:3,className:"".concat(r.padding20," ").concat(r.codeFlyoutContainer),style:{height:s}},o.a.createElement(he.a,{item:!0,sm:11},o.a.createElement(ee.a,{variant:"h6",className:" ".concat(r.mrAuto),style:{color:"white"}},"Looker User Object")),o.a.createElement(he.a,{item:!0,sm:1,style:{textAlign:"right"}},o.a.createElement(Ce.a,{style:{color:"white",cursor:"pointer"},onClick:function(){return t()}})),o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(xe,{code:i}))):""))}function xe(e){var t=e.code;return o.a.createElement(ve.a,{language:"json",style:ke.a,showLineNumbers:!0},"object"===typeof t?JSON.stringify(t,!0,4):t)}var Ee=n(207),_e=n(210),Se=Ee.a[500],je=_e.a[500],Oe=(Ee.a[900],_e.a[900],Ee.a[100]),Te=_e.a[100],Ie=Object(Z.a)((function(e){var t;return t={root:{flexGrow:1,backgroundColor:e.palette.background.paper,overflow:"scroll",borderRadius:8},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275},maxHeight200:{maxHeight:200,height:200,overflow:"hidden"},mt30:{marginTop:30},mb30:{marginBottom:30},textCenter:{textAlign:"center"},cursorPointer:{cursor:"pointer"},border:{border:"1px solid black"},height800:{height:800},maxHeight100:{maxHeight:100,height:100},maxHeight400:{maxHeight:400,height:400},minHeight200:{minHeight:200,overflow:"scroll"},redNeg:{backgroundColor:Oe,color:Se,fontWeight:800},greenPos:{backgroundColor:Te,color:je,fontWeight:800},padding30:{padding:30},mb12:{marginBottom:12},overflowScroll:{overflow:"scroll"},overflowHidden:{overflow:"hidden"},overflowVisible:{overflow:"visible"},maxHeight150:{maxHeight:150,height:150},minHeight150:{minHeight:150,overflow:"scroll"},carouselLegend:{backgroundColor:"rgb(192,192,192, .5)\t !important",textAlign:"center !important",opacity:"100 !important",fontWeight:800},carouselLegendTitle:{fontSize:"24px !important"},carouselLegendBody:{fontSize:"16px !important"},positionRelative:{position:"relative"},padding15:{padding:15},maxHeight75:{maxHeight:75,height:75},overflowYScroll:{overflowY:"scroll",overflowX:"hidden"},drawerHeader:Object(s.a)(Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),padding20:{padding:20},positionFixedTopRight:{position:"fixed",top:88,right:24,bottom:0,zIndex:100},codeFlyoutContainer:{backgroundColor:"rgb(40, 42, 54)",overflow:"scroll",borderRadius:"0 8px 8px 0"}},Object(C.a)(t,"overflowScroll",{overflow:"scroll"}),Object(C.a)(t,"overflowHidden",{overflow:"hidden"}),Object(C.a)(t,"height100Percent",{height:"100%"}),Object(C.a)(t,"noContainerScroll",{width:"100%",margin:0}),t}));var Ne=n(1059);function Fe(e){var t=e.children,n=e.color,r=e.height,i=e.width,l=e.margin,c=e.id,d=e.backgroundColor,u=Object(m.a)(e,["children","color","height","width","margin","id","backgroundColor"]),p={};return p=Object(a.useContext)(ie).show?Object(s.a)(Object(s.a)({},p),{},{border:"3px solid ".concat(n),backgroundColor:"".concat(d),borderRadius:"4px",position:"relative"}):{border:"3px solid transparent",backgroundColor:"transparent"},r&&(p.height=r),i&&(p.width=i),l&&(p.margin=l),o.a.createElement("div",Object.assign({id:c,style:p},u),t)}function De(e){var t=Object.assign({},e),n=Object(a.useContext)(ie).show,r=t.classes,i=t.children;return o.a.createElement(Fe,Object.assign({},t,{color:"#A142F4",backgroundColor:"rgba(161, 66, 244, 0.1)"}),o.a.createElement(Ne.a,{size:"small",label:"API",className:n?"test":"".concat(r.hidden),display:"inline",align:"right",style:{backgroundColor:"#A142F4",color:"#fff",top:"-10px",left:"-10px",position:"absolute"}}),i)}function He(e){var t=Object.assign({},e),n=Object(a.useContext)(ie).show,r=t.classes,i=t.children;return o.a.createElement(Fe,Object.assign({},t,{color:"#12B5CB",backgroundColor:"rgba(18, 181, 203, 0.1)"}),o.a.createElement(Ne.a,{size:"small",label:"Embed",className:n?"test":"".concat(r.hidden),display:"inline",align:"right",style:{backgroundColor:"#12B5CB",color:"#fff",top:"-10px",left:"-10px",position:"absolute"}}),i)}var Pe=n(258),Re=n(48),Ae=Re.validIdHelper,Be=Re.decodeHtml;function Le(e){var t=e.lookerContent,n=e.classes,r=Object(a.useState)([]),i=Object(X.a)(r,2),s=i[0],l=i[1],m=Object(a.useContext)(ie),u=(m.userProfile,m.lookerUser),p=(m.show,{});Object(a.useEffect)((function(){var e=!0;return h().then((function(t){e&&l(t)})),function(){return e=!1}}),[t,u]);var h=function(){var e=Object(d.a)(c.a.mark((function e(){var n,a,o,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l([]),n=encodeURIComponent(JSON.stringify(t.inlineQuery)),e.next=4,fetch("/runinlinequery/".concat(n,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 4:return a=e.sent,e.next=7,a.json();case 7:return o=e.sent,p.id=Ae("singleVisValue-".concat(t.id)),p.data=[],r=[],o.queryResults.map((function(e){if(e[t.inlineQuery.fields[0]]){var n={x:e[t.inlineQuery.fields[0]].toString(),y:e[t.inlineQuery.fields[1]]||0,change:e.change};n&&"null"!==n.y&&r.push(n)}})),p.data=[].concat(r),e.abrupt("return",[p]);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=s.length?isNaN((100*s[0].data[0].change).toFixed(2))?"":parseInt((100*s[0].data[0].change).toFixed(0))>=0?"&uarr;":"&darr;":"",b=s.length?"revenue"===t.chipFormat?"$".concat((s[0].data&&s[0].data[0]?s[0].data[0].y.toFixed(2):"").replace(/\d(?=(\d{3})+\.)/g,"$&,")):"integer"===t.chipFormat?parseInt(s[0].data&&s[0].data[0]?s[0].data[0].y.toFixed(2):""):"percent"===t.chipFormat?"".concat(100*(s[0].data&&s[0].data[0]?s[0].data[0].y.toFixed(2):""),"% "):"":"";return o.a.createElement(pe.a,{className:"".concat(n.padding15," ").concat(n.overflowHidden," "),variant:"outlined"},o.a.createElement("div",{style:{height:t.height}},s.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(De,{height:140,classes:n},o.a.createElement(he.a,{container:!0,className:"".concat(n.textCenter," ")},o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(ee.a,{variant:"body2",align:"left",color:"secondary"},t.label)),o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(ee.a,{variant:"subtitle1",align:"left"},o.a.createElement("b",null,b))),o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(Ne.a,{size:"small",label:"".concat(Be(g)," ").concat(parseInt(100*s[0].data[0].change).toFixed(0),"% "),className:isNaN((100*s[0].data[0].change).toFixed(2))?"":parseInt((100*s[0].data[0].change).toFixed(0))>=0?n.greenPos:n.redNeg,display:"inline",align:"right"}))),o.a.createElement(Pe.a,{data:s,margin:{top:25,right:25,bottom:25,left:25},xScale:{type:"time",format:"%Y-%m-%d",precision:"day"},yScale:{type:"linear",min:"auto",max:"auto",stacked:!0,reverse:!1},axisLeft:{orient:"left",tickSize:0,tickPadding:5,tickRotation:0,format:function(){return null}},axisBottom:{orient:"bottom",tickSize:0,tickPadding:5,tickRotation:0,format:function(){return null}},enablePoints:!1,enableGridX:!1,enableGridY:!1,height:100,colors:t.visColor,animate:!0}))):o.a.createElement(he.a,{item:!0,sm:12,className:"".concat(n.flexCentered," "),style:{height:t.height}},o.a.createElement(ge.a,{className:n.circularProgress,style:{color:"".concat(t.visColor," ")}}))))}n(355);var Ue=n(48),$e=(Ue.validIdHelper,Ue.decodeHtml);function Me(e){var t=e.lookerContent,n=e.item,r=e.index,i=e.classes,s=Object(a.useState)(void 0),l=Object(X.a)(s,2),m=l[0],u=l[1],p=Object(a.useContext)(ie),h=(p.userProfile,p.lookerUser);p.show;Object(a.useEffect)((function(){var e=!0;return g().then((function(t){e&&u(t)})),function(){return e=!1}}),[n,h]);var g=function(){var e=Object(d.a)(c.a.mark((function e(){var a,o,r,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(void 0),a=n,o=encodeURIComponent(JSON.stringify(a)),e.next=5,fetch("/runinlinequery/".concat(o,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return r=e.sent,e.next=8,r.json();case 8:return i=e.sent,e.abrupt("return",i.queryResults[0]);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=m?m.change>0?"&uarr;":"&darr;":"";return o.a.createElement(he.a,{item:!0,sm:12},m?o.a.createElement(o.a.Fragment,null,o.a.createElement(De,{classes:i},o.a.createElement(ee.a,{variant:"subtitle1",display:"inline"},"Your ",t.inlineQueriesMap[r]," category, ",o.a.createElement("b",null,m["products.category"]),", is ",m.change>0?"up ":"down "),o.a.createElement(Ne.a,{size:"small",label:"".concat($e(b)," ").concat(parseInt(100*m.change).toFixed(0),"% "),className:m.change>0?i.greenPos:i.redNeg,display:"inline"}),o.a.createElement(ee.a,{variant:"subtitle1",display:"inline"},"\xa0over the past week."))):o.a.createElement("div",{style:{height:"56px"}}))}var Ge=n(48).validIdHelper;function qe(e){var t=e.lookerContent,n=e.classes,r=Object(a.useContext)(ie),i=r.userProfile,s=r.lookerUser;return Object(a.useEffect)((function(){}),[t,s]),o.a.createElement("div",{className:"".concat(n.overflowScroll," ").concat(n.padding15),style:{maxHeight:t.height}},o.a.createElement(ee.a,{variant:"h4"},"Welcome back"),o.a.createElement("br",null),o.a.createElement(ee.a,{variant:"subtitle1",display:"inline"},"Hi ",o.a.createElement("b",null,i.givenName),", hope you're having a good day. Here are a few things you might want to know."),o.a.createElement("br",null),o.a.createElement(o.a.Fragment,null,t.inlineQueries.map((function(e,a){return o.a.createElement(Me,Object.assign({key:"".concat(Ge("naturalLanguage-splashPage-"+a))},{lookerContent:t,item:e,index:a,classes:n}))}))))}function ze(e){e.lookerContent;var t=e.classes,n=e.item,r=e.handleMenuItemSelect,i=e.index,s=Object(a.useState)(void 0),l=Object(X.a)(s,2),m=l[0],u=l[1],p=Object(a.useContext)(ie),h=(p.userProfile,p.lookerUser);p.show;Object(a.useEffect)((function(){var e=!0;return g().then((function(t){e&&u(t)})),function(){return e=!1}}),[n,h]);var g=function(){var e=Object(d.a)(c.a.mark((function e(){var t,a,o,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/getthumbnail/".concat(n.resourceType,"/").concat(n.id),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,o=new Blob([a.svg],{type:"image/svg+xml"}),r=URL.createObjectURL(o),e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(he.a,{container:!0,onClick:function(){return r(n.id,1)},className:"".concat(t.cursorPointer),spacing:3},m?o.a.createElement(o.a.Fragment,null,o.a.createElement(he.a,{item:!0,sm:1}),o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(De,{classes:t},o.a.createElement("div",{className:" ".concat(t.maxHeight75," ").concat(t.textCenter," ").concat(t.cursorPointer," ").concat(t.overflowHidden)},o.a.createElement("img",{onClick:function(){return r(n.id,1)},src:m,style:{width:"100%"}})))),o.a.createElement(he.a,{item:!0,sm:4},o.a.createElement(ee.a,{variant:"subtitle1"},n.label)),i<2?o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(ae.a,{className:"".concat(t.divider," ").concat(t.mb12," ").concat(t.mt12)})):""):"")}var Ve=n(48).validIdHelper;function We(e){var t=e.lookerContent,n=e.classes,r=e.handleMenuItemSelect,i=Object(a.useState)([]),s=Object(X.a)(i,2);s[0],s[1];return o.a.createElement(pe.a,{className:n.padding15,variant:"outlined"},o.a.createElement("div",{className:"".concat(n.overflowYScroll),style:{height:t.height}},o.a.createElement(he.a,{container:!0,spacing:3},o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(ee.a,{variant:"h6",align:"center",color:"secondary"},"Helpful Dashboards")),t.vectors.map((function(e,a){return o.a.createElement(ze,Object.assign({key:"".concat(Ve("vectorThumbnail-splashPage-"+a))},{lookerContent:t,item:e,classes:n,handleMenuItemSelect:r,index:a}))})))))}function Qe(e){var t=e.lookerContent,n=e.classes,r=e.id,i=e.lookerHost,s=Object(a.useState)(0),l=Object(X.a)(s,2),c=l[0],d=l[1],m=Object(a.useContext)(ie),u=(m.userProfile,m.lookerUser);m.show;return Object(a.useEffect)((function(){ue()("#".concat(r)).html(""),d(0),ce.LookerEmbedSDK.createDashboardWithId(t.slug).appendTo(document.getElementById(r)).withClassName("dashboard").withClassName("splashPage").withClassName(t.id).withTheme("atom_fashion").build().connect().then((function(e){d(1),ce.LookerEmbedSDK.init("https://".concat(i,".looker.com"))})).catch((function(e){console.error("Connection error",e)}))}),[u]),o.a.createElement(pe.a,{className:n.padding15,variant:"outlined"},o.a.createElement("div",{style:{height:t.height}},c?"":o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(pe.a,{className:"".concat(n.card," ").concat(n.flexCentered," ").concat(n.maxHeight400," ").concat(n.overflowHidden),elevation:0},o.a.createElement(ge.a,{className:n.circularProgress}))),o.a.createElement(he.a,{container:!0,spacing:3},o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(He,{classes:n,height:c?380:0},o.a.createElement("div",{className:"embedContainer embedContainerNoHeader splashPage",id:r,key:r}))))))}var Ke=n(384);n(48).validIdHelper;function Je(e){var t=e.lookerContent,r=e.classes,i=Object(a.useContext)(ie),s=(i.userProfile,i.lookerUser);Object(a.useEffect)((function(){}),[t,s]);var l=n(361),c=n(362),d=n(363);return o.a.createElement("div",{className:"".concat(r.overflowHidden,"  MuiPaper-rounded"),style:{maxHeight:t.height,borderRadius:"4px"}},o.a.createElement(Ke.Carousel,{infiniteLoop:!0,autoPlay:!0,showThumbs:!1},o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:l}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},o.a.createElement("span",{className:"".concat(r.carouselLegendTitle)},"Blog"),o.a.createElement("br",null),o.a.createElement("span",{className:"".concat(r.carouselLegendBody)},"".concat("Read our latest thoughts on the ecommerce landscape".substring(0,50),"...")))),o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:c}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},o.a.createElement("span",{className:"".concat(r.carouselLegendTitle)},"Inventory Best Practices"),o.a.createElement("br",null),o.a.createElement("span",{className:"".concat(r.carouselLegendBody)},"".concat("McKinsey & Co found in a recent study that retailers who implement JIT inventory and fulfillment practices can result in 5 - 15% longer run operating margin vs similar competitors that don\u2019t while maintaining similar CSAT scores".substring(0,50),"...")))),o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:d}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},o.a.createElement("span",{className:"".concat(r.carouselLegendTitle)},"Macro Trends"),o.a.createElement("br",null),o.a.createElement("span",{className:"".concat(r.carouselLegendBody)},"".concat("Online and brick and mortar retailers are rapidly converging on Omni Channel where the traditional walls of retail vs online are blurred. Amazon partners with Kohls to create in person returns and Walmart acquires Jet.com to boost its reach and  ability to execute an online strategy. As a brand partner how do you capitalize on these trends?".substring(0,50),"..."))))))}var Ye=n(1009),Xe=n(1010),Ze=n(1011);function et(e){var t=e.classes,n=Object(a.useContext)(ie).toggleShow,r=Object(a.useContext)(ie).toggleCodeShow;return o.a.createElement(he.a,{container:!0,className:"".concat(t.mtAuto," ").concat(t.mb10)},o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(Ye.a,{display:"inline",startIcon:o.a.createElement(Xe.a,null),onClick:n},"Source")),o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(Ye.a,{className:"".concat(t.ml12),display:"inline",startIcon:o.a.createElement(Ze.a,null),onClick:r},"Code")))}var tt=n(48).validIdHelper;function nt(e){var t=Object(a.useState)(0),n=Object(X.a)(t,2),r=(n[0],n[1],Object(a.useState)(1)),i=Object(X.a)(r,2),s=i[0],l=(i[1],Object(a.useState)("")),c=Object(X.a)(l,2),d=(c[0],c[1],Object(a.useState)("")),m=Object(X.a)(d,2),u=(m[0],m[1],Object(a.useState)(window.innerHeight-112)),p=Object(X.a)(u,2),h=p[0],g=p[1],b=(Object(a.useContext)(ie).toggleShow,Object(a.useContext)(ie).show,Object(a.useContext)(ie).codeShow),f=Ie(),y=(e.staticContent,e.staticContent.lookerContent),C=e.staticContent.type,v=(e.handleTabChange,e.handleMenuItemSelect),k=e.lookerUser,w=e.lookerHost,x=C||"code flyout";return Object(a.useEffect)((function(){window.addEventListener("resize",(function(){return g(window.innerHeight-112)}))}),[y]),o.a.createElement("div",{className:"".concat(f.root," demoComponent"),style:{height:h}},o.a.createElement(pe.a,{elevation:1,className:"".concat(f.padding30," \n      ").concat(f.height100Percent,"\n      ").concat(f.overflowScroll)},o.a.createElement(he.a,{container:!0,key:tt(C)},o.a.createElement("div",{className:f.root},s?"":o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(pe.a,{className:"".concat(f.card," ").concat(f.flexCentered)},o.a.createElement(ge.a,{className:f.circularProgress}))),o.a.createElement(O.a,{className:s?"":"".concat(f.hidden)},o.a.createElement(he.a,{container:!0,spacing:3,key:"".concat(tt(x+"-outerFragment")),className:"".concat(f.noContainerScroll)},b?o.a.createElement(he.a,{item:!0,sm:6,className:"".concat(f.positionFixedTopRight)},o.a.createElement(we,Object.assign({},e,{classes:f,lookerUser:k,height:h}))):"",y.map((function(e,t){return o.a.createElement(he.a,{key:"".concat(tt(x+"-innerFragment-"+t)),item:!0,sm:parseInt(e.gridWidth)},"welcome"===e.type&&o.a.createElement(qe,{lookerContent:e,classes:f,demoComponentType:x,lookerHost:w}),"carousel"===e.type&&o.a.createElement(Je,{lookerContent:e,classes:f,demoComponentType:x,lookerHost:w}),"single value"===e.type&&o.a.createElement(Le,{lookerContent:e,classes:f,demoComponentType:x,lookerHost:w}),"dashboard"===e.type&&o.a.createElement(Qe,Object.assign({lookerContent:e,classes:f,lookerHost:w},{id:tt("embedContainer-".concat(x,"-").concat(e.id))})),"popular analysis"===e.type&&o.a.createElement(We,{lookerContent:e,classes:f,demoComponentType:x,handleMenuItemSelect:v,lookerHost:w}))}))))))))}var at=n(1063),ot=n(1013),rt=n(1016),it=n(1012),st=n(1068),lt=n(1017),ct=n(1014),dt=n(1015),mt=Object(Z.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,overflow:"scroll",borderRadius:"8px"},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden"},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},mrAuto:{marginRight:"auto"},card:{minWidth:275},padding30:{padding:30},minHeight680:{minHeight:680},positionRelative:{position:"relative"},skeleton:{height:160,width:"100%"},height100Percent:{height:"100%"},ml12:{marginLeft:12},padding20:{padding:20},positionFixedTopRight:{position:"fixed",top:88,right:24,bottom:0,zIndex:100},codeFlyoutContainer:{backgroundColor:"rgb(40, 42, 54)",overflow:"scroll",borderRadius:"0 8px 8px 0"},padding10:{padding:10},noContainerScroll:{width:"100%",margin:0}}}));function ut(e){var t=e.val,n=e.positive_good,a=(e.abs_val,{up:n?"green":"red",down:n?"red":"green"}),r=t<0?a.down:t>0?a.up:"black",i=Math.abs(t).toLocaleString("en",{style:"percent",minimumFractionDigits:2}),s=t<0?"\u25bc":t>0?"\u25b2":"\u2014";return o.a.createElement(o.a.Fragment,null,o.a.createElement("font",{color:r},"".concat(s," ").concat(i)))}var pt=n(48).validIdHelper;function ht(e){var t=Object(a.useState)(0),n=Object(X.a)(t,2),r=(n[0],n[1],Object(a.useState)(0)),i=Object(X.a)(r,2),l=i[0],m=i[1],u=Object(a.useState)([]),p=Object(X.a)(u,2),h=p[0],g=p[1],b=Object(a.useState)({}),f=Object(X.a)(b,2),y=f[0],k=f[1],x=Object(a.useState)(""),E=Object(X.a)(x,2),_=(E[0],E[1]),S=Object(a.useState)(""),j=Object(X.a)(S,2),T=j[0],I=j[1],N=Object(a.useState)(""),F=Object(X.a)(N,2),D=F[0],H=F[1],P=Object(a.useState)({}),R=Object(X.a)(P,2),A=R[0],B=R[1],L=Object(a.useState)("All"),U=Object(X.a)(L,2),$=U[0],M=U[1],G=Object(a.useContext)(ie),q=G.codeShow,z=(G.toggleCodeShow,Object(a.useState)(window.innerHeight-112)),V=Object(X.a)(z,2),W=V[0],Q=V[1],K=mt(),J=e.staticContent.lookerContent,Y=e.staticContent.type,Z=(e.activeTabValue,e.handleTabChange,e.lookerUser),ee=e.lookerHost,te=Y||"code flyout",ne=function(e,t){H(t);var n=w.a.filter(A.dashboard_layout_components,(function(e){return J[0].dynamicFieldLookUp[t].indexOf(e.dashboard_element_id)>-1})),a=Object(s.a)(Object(s.a)({},A),{},{dashboard_layout_components:n});y.setOptions({layouts:[a]})};Object(a.useEffect)((function(){setTimeout((function(){return ae(Object(v.a)(J))}),1e3),_("import $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, TextField, Toolbar, FormControlLabel, Switch, Chip,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails\n} from '@material-ui/core'\nimport { Autocomplete, ToggleButton, ToggleButtonGroup, Skeleton } from '@material-ui/lab'\nimport { ExpandMore, FilterList } from '@material-ui/icons';\n\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./Dashboard.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport BottomBar from '../../Material/BottomBar.js'\nimport { ApiHighlight, EmbedHighlight } from '../../Highlights/Highlight';\nimport { NumberToColoredPercent } from '../../Accessories/NumberToColoredPercent';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\nexport default function Dashboard(props) {\n  const topBarBottomBarHeight = 112;\n  const [value, setValue] = useState(0);\n  const [iFrameExists, setIFrame] = useState(0);\n  const [apiContent, setApiContent] = useState([]);\n  const [dashboardObj, setDashboardObj] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const [toggleValue, setToggleValue] = useState('');\n  const [dashboardLayout, setDashboardLayout] = useState({});\n  const [regionValue, setRegionValue] = useState('All');\n  const { codeShow, toggleCodeShow } = useContext(AppContext)\n  const [height, setHeight] = useState((window.innerHeight - topBarBottomBarHeight));\n\n  const classes = useStyles();\n  const { staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser, lookerHost } = props;\n  const demoComponentType = type || 'code flyout';\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  const handleToggle = (event, newValue) => {\n    setToggleValue(newValue)\n    const filteredLayout = _.filter(dashboardLayout.dashboard_layout_components, (row) => {\n      return (lookerContent[0].dynamicFieldLookUp[newValue].indexOf(row.dashboard_element_id) > -1)\n    })\n    const newDashboardLayout = {\n      ...dashboardLayout,\n      dashboard_layout_components: filteredLayout\n    }\n    dashboardObj.setOptions({ \"layouts\": [newDashboardLayout] })\n  };\n\n  useEffect(() => {\n    setTimeout(() => performLookerApiCalls([...lookerContent]), 1000)\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent, lookerUser]);\n\n\n  useEffect(() => {\n    if (Object.keys(dashboardLayout).length && Object.keys(dashboardObj).length && lookerContent[0].dynamicFieldLookUp) {\n      handleToggle(null, Object.keys(lookerContent[0].dynamicFieldLookUp)[0])\n    }\n  }, [dashboardLayout]);\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", () => setHeight((window.innerHeight - topBarBottomBarHeight)));\n  })\n\n  const performLookerApiCalls = function (lookerContent) {\n    $(`.embedContainer.${validIdHelper(demoComponentType)}:visible`).html('')\n    setIFrame(0)\n    setApiContent([])\n    lookerContent.map(async lookerContent => {\n      let dashboardId = lookerContent.id;\n      // let dashboardSlug = lookerContent.slug;\n      LookerEmbedSDK.createDashboardWithId(dashboardId) //dashboardSlug\n        .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${dashboardId}`))\n        .withClassName('iframe')\n        .withNext()\n        // .withNext(lookerContent.isNext || false) //how can I make this dynamic based on prop??\n        .withTheme(lookerContent.theme || 'atom_fashion')\n        .withParams({ 'schedule_modal': 'true' })\n        .on('page:property:change', (event) => {\n          // console.log('page property is changing!!!!')\n          changeHeight(event)\n        }) // dashboards-next\n        .on('dashboard:loaded', (event) => {\n          setDashboardLayout(event.dashboard.options.layouts[0])\n        })\n        // .on('drillmenu:click', (event) => {\n        //   drillMenuClick(event)\n        // })\n        .build()\n        .connect()\n        .then((dashboard) => {\n          setIFrame(1)\n          setDashboardObj(dashboard)\n          LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n\n        })\n        .catch((error) => {\n          // console.error('Connection error', error)\n        })\n\n      if (lookerContent.hasOwnProperty('filters')) {\n        //get inline query from usecase file & set user attribute dynamically\n        //iterating over filters\n        let orderedArrayForApiContent = []\n        lookerContent.filters.map(async (item, index) => {\n          // console.log('item', item)\n          let jsonQuery = lookerContent.inlineQueries[index];\n          jsonQuery.filters = {\n            ...jsonQuery.filters,\n            [item.desiredFilterName]: lookerUser.user_attributes.brand\n          };\n          let stringifiedQuery = encodeURIComponent(JSON.stringify(jsonQuery))\n          let lookerResponse = await fetch('/runinlinequery/' + stringifiedQuery + '/json', {\n            method: 'GET',\n            headers: {\n              Accept: 'application/json',\n              'Content-Type': 'application/json'\n            }\n          })\n          let lookerResponseData = await lookerResponse.json();\n          let queryResultsForDropdown = [];\n          let desiredProperty = Object.keys(lookerResponseData.queryResults[0])[0];\n\n          for (let i = 0; i < lookerResponseData.queryResults.length; i++) {\n            queryResultsForDropdown.push({\n              'label': lookerResponseData.queryResults[i][desiredProperty],\n              'trend': (lookerResponseData.queryResults[i]['trend']) ? lookerResponseData.queryResults[i]['trend'] : undefined\n            })\n          }\n\n\n          // setApiContent(apiContent => {\n          //   return [...apiContent, queryResultsForDropdown]\n          // });\n          //needed solution for ordering apiContent to match order\n          //of content from usecaseContent\n\n          orderedArrayForApiContent[index] = queryResultsForDropdown\n          setApiContent([...orderedArrayForApiContent])\n\n          if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n        })\n      }\n\n    })\n  }\n\n  const customFilterAction = (dashboardId, filterName, newFilterValue) => {\n    if (Object.keys(dashboardObj).length) {\n      dashboardObj.updateFilters({ [filterName]: newFilterValue })\n      dashboardObj.run()\n    }\n  }\n\n  // const drillMenuClick = (event) => {\n  //   const basicLookerUser = lookerUser.user_attributes.permission_level === 'basic' ? true : false;\n  //   if (basicLookerUser) {\n  //     togglePayWallModal()\n  //     return { cancel: (basicLookerUser) ? true : false }\n  //   }\n  // }\n\n  const changeHeight = (event) => {\n    // console.log('changeHeight')\n    // console.log('event', event)\n  }\n\n  return (\n    <div className={`${classes.root} demoComponent`}\n      style={{ height }}>\n      <Card elevation={1} className={`${classes.padding30} ${classes.height100Percent}`}>\n        <Grid container>\n          <div className={`${classes.root}`}>\n            {lookerContent[0].hasOwnProperty(\"filters\") &&\n              apiContent.length === lookerContent[0].filters.length ?\n              <Grid item\n                sm={12}\n                key={validIdHelper(`${demoComponentType}-FilterBar-${lookerContent[0].id}`)}\n              >\n                <FilterBar {...props}\n                  classes={classes}\n                  apiContent={apiContent}\n                  customFilterAction={customFilterAction}\n                  regionValue={regionValue}\n                  setRegionValue={setRegionValue}\n                  toggleValue={toggleValue}\n                  handleToggle={handleToggle}\n                />\n              </Grid> :\n              lookerContent[0].hasOwnProperty(\"filters\") ?\n                <Skeleton variant=\"rect\" animation=\"wave\" className={classes.skeleton} /> :\n                ''}\n\n\n            {\n              iFrameExists\n                ? ''\n                :\n                <Grid item sm={12} style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                  <Card className={`${classes.card} ${classes.flexCentered}`}\n                    elevation={0}\n                    mt={2}\n                    style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                    <CircularProgress className={classes.circularProgress} />\n                  </Card>\n                </Grid>\n            }\n            <Box\n              className={iFrameExists ? ` ` : `${classes.hidden} `}\n              style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}\n            >\n              <Grid container\n                spacing={3}\n                className={`${classes.noContainerScroll}`}>\n                {codeShow ?\n                  <Grid item sm={6}\n                    className={`${classes.positionFixedTopRight}`}\n                  >\n                    <CodeFlyout {...props}\n                      classes={classes}\n                      lookerUser={lookerUser}\n                      height={height}\n                    />\n                  </Grid>\n                  : ''}\n                <Grid item sm={12}>\n\n                  <Box className={`${classes.w100} ${classes.padding10}`} mt={lookerContent[0].filter || lookerContent[0].dynamicFieldLookUp ? 2 : 0}>\n\n\n                    <EmbedHighlight classes={classes}>\n                      <div\n                        className={`embedContainer ${validIdHelper(demoComponentType)}`}\n                        id={validIdHelper(`embedContainer-${demoComponentType}-${lookerContent[0].id}`)}\n                        key={validIdHelper(`embedContainer-${demoComponentType}-${lookerContent[0].id}`)}\n                      >\n                      </div>\n                    </EmbedHighlight>\n                  </Box>\n                </Grid>\n              </Grid>\n            </Box>\n          </div>\n        </Grid>\n      </Card>\n    </div>\n  )\n}\n\n\n\n\nfunction FilterBar(props) {\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, classes,\n    apiContent, customFilterAction, regionValue, setRegionValue, toggleValue, handleToggle } = props;\n\n  const [expanded, setExpanded] = useState(true);\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n  return (\n\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel} className={classes.w100} elevation={0}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMore />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <FilterList /><Typography className={`${classes.heading} ${classes.ml12}`}>Filter:</Typography>\n\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        {\n          lookerContent[0].filters || lookerContent[0].dynamicFieldLookUp ?\n            <Grid\n              container>\n              {apiContent.map((item, index) => {\n                return (\n                  lookerContent[0].filterComponents[index] === 'autocomplete' ?\n                    <ApiHighlight classes={classes}\n                      key={validIdHelper(`dashEmbed-${type}${lookerContent.id}-${index}`)} >\n                      <Grid item sm={6}>\n                        <Autocomplete\n                          id={`combo-box-dashboard-${lookerContent.id}`}\n                          options={Array.isArray(apiContent[index]) ?\n                            apiContent[index] :\n                            []}\n                          renderOption={(option) => (\n                            <Grid container justify=\"space-between\">\n                              <Grid item>\n                                {option.label}\n                              </Grid>\n                              {option.trend && <Grid item>\n                                <NumberToColoredPercent\n                                  val={option.trend}\n                                  positive_good={true}\n                                  abs_val={Math.abs(option.trend)}\n                                />\n                              </Grid>}\n                            </Grid>\n                          )}\n                          getOptionLabel={(option) => option.label}\n                          style={{ width: 400 }}\n                          onChange={(event, newValue) => {\n                            customFilterAction(lookerContent[0].id,\n                              lookerContent[0].filters[index].filterName,\n                              (newValue) ? newValue.label : '')\n                          }}\n                          renderInput={(params) => <TextField {...params} label={lookerContent[0].filters[index].filterName} variant=\"outlined\" />}\n                          loadingText=\"Loading...\"\n                        />\n                      </Grid>\n                    </ApiHighlight>\n                    : lookerContent[0].filterComponents[index] === 'togglebutton' ?\n\n                      <ApiHighlight classes={classes}\n                        key={validIdHelper(`dashEmbed-${type}${lookerContent.id}-${index}`)} >\n                        <Grid item sm={12}>\n                          <ToggleButtonGroup\n                            value={regionValue}\n                            exclusive\n                            onChange={(event, newValue) => {\n                              setRegionValue(newValue)\n                              customFilterAction(lookerContent[0].id,\n                                lookerContent[0].filters[index].filterName,\n                                (newValue) ? newValue : '')\n                            }}\n                            aria-label=\"region\"\n                          >\n                            {apiContent[index].map((region, index) => {\n                              return (\n                                <ToggleButton\n                                  key={validIdHelper(`${type}-FilterBar-ToggleButton-${lookerContent[0].id}-${index}`)}\n                                  value={region.label} aria-label={region.label}>\n                                  {region.label}\n                                </ToggleButton>\n                              )\n                            })}\n                          </ToggleButtonGroup>\n                        </Grid>\n                      </ApiHighlight>\n                      : 'ooooopppp')\n              })}\n              <Grid item sm={1} />\n              {lookerContent[0].dynamicFieldLookUp ?\n                <EmbedHighlight classes={classes} >\n                  <Grid item sm={5}>\n                    <ToggleButtonGroup\n                      value={toggleValue}\n                      exclusive\n                      onChange={handleToggle}\n                      aria-label=\"text alignment\"\n                    >\n                      {Object.keys(lookerContent[0].dynamicFieldLookUp).map(key => {\n                        return (\n                          <ToggleButton\n                            key={validIdHelper(`dynamicDashToggle-${key}`)}\n                            value={key} aria-label=\"left aligned\">\n                            {key}\n                          </ToggleButton>\n                        )\n                      })}\n                    </ToggleButtonGroup>\n                  </Grid>\n                </EmbedHighlight>\n                : ''\n              }\n            </Grid> : ''\n        }\n      </ExpansionPanelDetails>\n    </ExpansionPanel >\n  )\n}")}),[J,Z]),Object(a.useEffect)((function(){Object.keys(A).length&&Object.keys(y).length&&J[0].dynamicFieldLookUp&&ne(0,Object.keys(J[0].dynamicFieldLookUp)[0])}),[A]),Object(a.useEffect)((function(){window.addEventListener("resize",(function(){return Q(window.innerHeight-112)}))}));var ae=function(e){ue()(".embedContainer.".concat(pt(te),":visible")).html(""),m(0),g([]),e.map(function(){var e=Object(d.a)(c.a.mark((function e(t){var n,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,ce.LookerEmbedSDK.createDashboardWithId(n).appendTo(pt("#embedContainer-".concat(te,"-").concat(n))).withClassName("iframe").withNext().withTheme(t.theme||"atom_fashion").withParams({schedule_modal:"true"}).on("page:property:change",(function(e){oe(e)})).on("dashboard:loaded",(function(e){B(e.dashboard.options.layouts[0])})).build().connect().then((function(e){m(1),k(e),ce.LookerEmbedSDK.init("https://".concat(ee,".looker.com"))})).catch((function(e){})),t.hasOwnProperty("filters")&&(a=[],t.filters.map(function(){var e=Object(d.a)(c.a.mark((function e(n,o){var r,i,l,d,m,u,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.inlineQueries[o]).filters=Object(s.a)(Object(s.a)({},r.filters),{},Object(C.a)({},n.desiredFilterName,Z.user_attributes.brand)),i=encodeURIComponent(JSON.stringify(r)),e.next=5,fetch("/runinlinequery/"+i+"/json",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return l=e.sent,e.next=8,l.json();case 8:for(d=e.sent,m=[],u=Object.keys(d.queryResults[0])[0],p=0;p<d.queryResults.length;p++)m.push({label:d.queryResults[p][u],trend:d.queryResults[p].trend?d.queryResults[p].trend:void 0});a[o]=m,g([].concat(a)),0===T.length&&I(d.code);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},oe=function(e){};return o.a.createElement("div",{className:"".concat(K.root," demoComponent"),style:{height:W}},o.a.createElement(pe.a,{elevation:1,className:"".concat(K.padding30," ").concat(K.height100Percent)},o.a.createElement(he.a,{container:!0},o.a.createElement("div",{className:"".concat(K.root)},J[0].hasOwnProperty("filters")&&h.length===J[0].filters.length?o.a.createElement(he.a,{item:!0,sm:12,key:pt("".concat(te,"-FilterBar-").concat(J[0].id))},o.a.createElement(gt,Object.assign({},e,{classes:K,apiContent:h,customFilterAction:function(e,t,n){Object.keys(y).length&&(y.updateFilters(Object(C.a)({},t,n)),y.run())},regionValue:$,setRegionValue:M,toggleValue:D,handleToggle:ne}))):J[0].hasOwnProperty("filters")?o.a.createElement(it.a,{variant:"rect",animation:"wave",className:K.skeleton}):"",l?"":o.a.createElement(he.a,{item:!0,sm:12,style:{height:W-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(pe.a,{className:"".concat(K.card," ").concat(K.flexCentered),elevation:0,mt:2,style:{height:W-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(ge.a,{className:K.circularProgress}))),o.a.createElement(O.a,{className:l?" ":"".concat(K.hidden," "),style:{height:W-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(he.a,{container:!0,spacing:3,className:"".concat(K.noContainerScroll)},q?o.a.createElement(he.a,{item:!0,sm:6,className:"".concat(K.positionFixedTopRight)},o.a.createElement(we,Object.assign({},e,{classes:K,lookerUser:Z,height:W}))):"",o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(O.a,{className:"".concat(K.w100," ").concat(K.padding10),mt:J[0].filter||J[0].dynamicFieldLookUp?2:0},o.a.createElement(He,{classes:K},o.a.createElement("div",{className:"embedContainer ".concat(pt(te)),id:pt("embedContainer-".concat(te,"-").concat(J[0].id)),key:pt("embedContainer-".concat(te,"-").concat(J[0].id))}))))))))))}function gt(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.staticContent.type,r=e.classes,i=e.apiContent,s=e.customFilterAction,l=e.regionValue,c=e.setRegionValue,d=e.toggleValue,m=e.handleToggle,u=Object(a.useState)(!0),p=Object(X.a)(u,2),h=p[0],g=p[1];return o.a.createElement(at.a,{expanded:h,onChange:function(e,t){g(!h)},className:r.w100,elevation:0},o.a.createElement(ot.a,{expandIcon:o.a.createElement(ct.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(dt.a,null),o.a.createElement(ee.a,{className:"".concat(r.heading," ").concat(r.ml12)},"Filter:")),o.a.createElement(rt.a,null,t[0].filters||t[0].dynamicFieldLookUp?o.a.createElement(he.a,{container:!0},i.map((function(e,a){return"autocomplete"===t[0].filterComponents[a]?o.a.createElement(De,{classes:r,key:pt("dashEmbed-".concat(n).concat(t.id,"-").concat(a))},o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(re.a,{id:"combo-box-dashboard-".concat(t.id),options:Array.isArray(i[a])?i[a]:[],renderOption:function(e){return o.a.createElement(he.a,{container:!0,justify:"space-between"},o.a.createElement(he.a,{item:!0},e.label),e.trend&&o.a.createElement(he.a,{item:!0},o.a.createElement(ut,{val:e.trend,positive_good:!0,abs_val:Math.abs(e.trend)})))},getOptionLabel:function(e){return e.label},style:{width:400},onChange:function(e,n){s(t[0].id,t[0].filters[a].filterName,n?n.label:"")},renderInput:function(e){return o.a.createElement(oe.a,Object.assign({},e,{label:t[0].filters[a].filterName,variant:"outlined"}))},loadingText:"Loading..."}))):"togglebutton"===t[0].filterComponents[a]?o.a.createElement(De,{classes:r,key:pt("dashEmbed-".concat(n).concat(t.id,"-").concat(a))},o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(st.a,{value:l,exclusive:!0,onChange:function(e,n){c(n),s(t[0].id,t[0].filters[a].filterName,n||"")},"aria-label":"region"},i[a].map((function(e,a){return o.a.createElement(lt.a,{key:pt("".concat(n,"-FilterBar-ToggleButton-").concat(t[0].id,"-").concat(a)),value:e.label,"aria-label":e.label},e.label)}))))):"ooooopppp"})),o.a.createElement(he.a,{item:!0,sm:1}),t[0].dynamicFieldLookUp?o.a.createElement(He,{classes:r},o.a.createElement(he.a,{item:!0,sm:5},o.a.createElement(st.a,{value:d,exclusive:!0,onChange:m,"aria-label":"text alignment"},Object.keys(t[0].dynamicFieldLookUp).map((function(e){return o.a.createElement(lt.a,{key:pt("dynamicDashToggle-".concat(e)),value:e,"aria-label":"left aligned"},e)}))))):""):""))}var bt=n(959),ft=n(1062),yt=n(1054),Ct=n(1056),vt=n(1019),kt=n(1023),wt=n(1022),xt=n(1018),Et=n(1020),_t=n(1021),St=n(399),jt=n(48),Ot=jt.validIdHelper,Tt=jt.prettifyString,It=Object(Z.a)((function(e){return{paper:{position:"absolute",width:800,maxHeight:450,overflow:"scroll",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},table:{maxHeight:310},card:{minWidth:275,minHeight:"10rem",boxShadow:"none"},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"}}}));function Nt(){return{top:"".concat(10,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(10,"%)")}}function Ft(e){var t=It(),n=e.open,a=e.onClose,r=e.modalContent,i=o.a.useState(Nt),s=Object(X.a)(i,1)[0];return o.a.createElement(Ct.a,{open:n,onClose:a,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:s,className:t.paper},o.a.createElement("h2",{id:"simple-modal-title"},r.title),r.body?o.a.createElement(xt.a,{component:St.a,className:t.table},o.a.createElement(vt.a,{stickyHeader:!0,className:t.table,size:"small","aria-label":"a dense table"},o.a.createElement(Et.a,null,o.a.createElement(_t.a,null,Object.keys(r.body[0]).map((function(e,t){return o.a.createElement(wt.a,{align:"right",key:Ot(e+"-TableHead-TableCell-"+t),id:Ot(e+"-TableHead-TableCell-"+t)},Tt(e.substring(e.lastIndexOf(".")+1,e.length)))})))),o.a.createElement(kt.a,null,r.body.map((function(e,t){return o.a.createElement(_t.a,{key:Ot("TableRow-"+t),id:Ot("TableRow-"+t)},Object.keys(e).map((function(e){return o.a.createElement(wt.a,{align:"right",key:Ot(e+"-TableBody-TableCell-"+t),id:Ot(e+"-TableBody-TableCell-"+t)},r.body[t][e]?r.body[t][e].rendered?r.body[t][e].rendered:r.body[t][e].value?r.body[t][e].value:"number"===typeof r.body[t][e]?Math.round(100*r.body[t][e])/100:r.body[t][e]:"")})))}))))):o.a.createElement(pe.a,{className:"".concat(t.card," ").concat(t.flexCentered)},o.a.createElement(ge.a,{className:t.circularProgress}))))}var Dt=n(385),Ht=Object(Z.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,overflow:"scroll",borderRadius:"8px"},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},card:{minWidth:275,minHeight:400},height500:{height:500},height600:{height:600},height700:{height:700},height800:{height:800},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)},skeleton:{height:160,width:"100%"},padding30:{padding:30},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"},height100Percent:{height:"100%"},ml12:{marginLeft:12},padding20:{padding:20},positionFixedTopRight:{position:"fixed",top:88,right:24,bottom:0,zIndex:100},codeFlyoutContainer:{backgroundColor:"rgb(40, 42, 54)",overflow:"scroll",borderRadius:"0 8px 8px 0"},padding10:{padding:10},overflowScroll:{overflow:"scroll"},noContainerScroll:{width:"100%",margin:0}}})),Pt=n(396),Rt=n(270),At=n(273),Bt=n(47),Lt=n(1049),Ut=n(48).validIdHelper;function $t(e){var t=Object(a.useState)(0),n=Object(X.a)(t,2),r=(n[0],n[1],Object(a.useState)("")),i=Object(X.a)(r,2),l=i[0],m=i[1],u=Object(a.useState)(""),p=Object(X.a)(u,2),h=p[0],g=p[1],b=Object(a.useState)("All"),f=Object(X.a)(b,2),y=f[0],k=f[1],x=Object(a.useState)(""),E=Object(X.a)(x,2),_=E[0],S=E[1],j=Object(a.useState)([]),T=Object(X.a)(j,2),I=T[0],N=T[1],F=o.a.useState(!1),D=Object(X.a)(F,2),H=D[0],P=D[1],R=Object(a.useState)({}),A=Object(X.a)(R,2),B=A[0],L=A[1],U=Object(a.useState)(""),$=Object(X.a)(U,2),M=($[0],$[1]),G=Object(a.useState)(""),q=Object(X.a)(G,2),z=q[0],V=q[1],W=Object(a.useContext)(ie),Q=W.togglePayWallModal,K=(W.show,W.codeShow),J=Object(a.useState)(window.innerHeight-112),Y=Object(X.a)(J,2),Z=Y[0],ee=Y[1],te=Ht(),ne=(e.staticContent,e.staticContent.lookerContent),oe=e.staticContent.type,re=(e.activeTabValue,e.handleTabChange,e.lookerUser),se=(e.lookerHost,function(){var e=Object(d.a)(c.a.mark((function e(t){var n,a,o,r,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.day,(o=JSON.parse(JSON.stringify(ne[0].inlineQuery))).filters=Object(s.a)(Object(s.a)({},o.filters),{},(n={},Object(C.a)(n,o.fields[0],a),Object(C.a)(n,o.fields[1],"All"===y?"":y),n)),o.total=!0,o.limit="25",P(!0),e.next=8,fetch("/runinlinequery/"+encodeURIComponent(JSON.stringify(o))+"/json",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 8:return r=e.sent,e.next=11,r.json();case 11:i=e.sent,l={title:"Detail View for ".concat(a),body:i.queryResults},L(l);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),le=[];if(I.queryResults&&I.queryResults&&(le=(le=w.a.filter(I.queryResults,(function(e){return e[I.inlineQuery.fields[0]]>=l&&e[I.inlineQuery.fields[0]]<h&&("All"===y||e[I.inlineQuery.fields[1]]===y)}))).map((function(e){return{day:e[I.inlineQuery.fields[0]],category:e[I.inlineQuery.fields[1]],value:e[_]}})),"All"===y)){var ce=Object(v.a)(new Set(le.map((function(e){return e.day})))),de=[];ce.map((function(e){var t=w.a.filter(le,(function(t){return t.day===e})).reduce((function(e,t){return e+t.value}),0),n={day:e,value:t,category:"All"};de.push(n)})),le=de}Object(a.useEffect)((function(){ne.length&&(setTimeout((function(){return me(ne)}),100),S(ne[0].desiredFields[0]),M("import $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, TextField,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails, Divider, InputLabel, MenuItem,\n  FormControl, Select, Modal\n} from '@material-ui/core'\nimport { Skeleton } from '@material-ui/lab';\nimport { ExpandMore, FilterList } from '@material-ui/icons';\nimport ModalTable from '../../Material/ModalTable';\nimport { ResponsiveCalendar } from '@nivo/calendar'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./CustomVis.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { ApiHighlight } from '../../Highlights/Highlight';\n//new date pickers\nimport { format, endOfDay, addDays } from 'date-fns';\nimport DateFnsUtils from '@date-io/date-fns';\nimport { MuiPickersUtilsProvider, KeyboardTimePicker, KeyboardDatePicker } from '@material-ui/pickers';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\nexport default function CustomVis(props) {\n  // console.log('CustomVis')\n  const topBarBottomBarHeight = 112;\n  const [value, setValue] = useState(0);\n  const [fromDate, setFromDate] = useState('');\n  const [toDate, setToDate] = useState('');\n  const [category, setCategory] = useState('All')\n  const [desiredField, setDesiredField] = useState('')\n  const [apiContent, setApiContent] = useState([]);\n  const [open, setOpen] = React.useState(false);\n  const [modalContent, setModalContent] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const { togglePayWallModal, show, codeShow } = useContext(AppContext)\n  const [height, setHeight] = useState((window.innerHeight - topBarBottomBarHeight));\n\n  //declare constants\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser, lookerHost } = props;\n\n  //handle opening of modal for advanced and premium users\n  const handleModalOpen = async ({ day }) => {\n    let originalInlineQueryCopy = JSON.parse(JSON.stringify(lookerContent[0].inlineQuery));\n    originalInlineQueryCopy.filters = {\n      ...originalInlineQueryCopy.filters,\n      [originalInlineQueryCopy.fields[0]]: day,\n      [originalInlineQueryCopy.fields[1]]: category === \"All\" ? '' : category\n    }\n    originalInlineQueryCopy.total = true;\n    originalInlineQueryCopy.limit = \"25\";\n\n    setOpen(true);\n    let lookerResponse = await fetch('/runinlinequery/' + encodeURIComponent(JSON.stringify(originalInlineQueryCopy)) + '/json', {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n    let lookerResponseData = await lookerResponse.json();\n    let modalObj = {\n      \"title\": `Detail View for ${day}`,\n      \"body\": lookerResponseData.queryResults\n    }\n    setModalContent(modalObj);\n  };\n\n  //handle modal close\n  const handleModalClose = () => {\n    setModalContent({})\n    setOpen(false);\n  };\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  const handleFromDate = newValue => {\n    let validDate = Date.parse(newValue);\n    if (validDate > 0) {\n      let newValueAsDate = format(addDays(new Date(newValue), 1), 'yyyy-MM-dd');\n      setFromDate(newValueAsDate);\n    }\n  }\n  const handleToDate = newValue => {\n    let validDate = Date.parse(newValue);\n    if (validDate > 0) {\n      let newValueAsDate = format(addDays(new Date(newValue), 1), 'yyyy-MM-dd');\n      setToDate(newValueAsDate);\n    }\n  }\n\n  const handleCategory = newValue => {\n    setCategory(newValue)\n  }\n\n  const handleDesiredField = newValue => {\n    setDesiredField(newValue)\n  }\n\n  //format response from initial api call based on LookerContent array\n  //to match format required by Nivo Calendar component\n  let filterData = [];\n  if (apiContent.queryResults && apiContent.queryResults) {\n    //filtering for fromDate, toDate and category\n    filterData = _.filter(apiContent.queryResults, (row) => {\n      return (row[apiContent.inlineQuery.fields[0]] >= fromDate\n        && row[apiContent.inlineQuery.fields[0]] < toDate\n        && (category === 'All' ? true : row[apiContent.inlineQuery.fields[1]] === category)\n      )\n    })\n    //converting filterDAta to desired format for vis\n    filterData = filterData.map(item => {\n      return {\n        'day': item[apiContent.inlineQuery.fields[0]],\n        'category': item[apiContent.inlineQuery.fields[1]],\n        'value': item[desiredField]\n      }\n    })\n\n    //special exception for category all\n    //need to reduce array by day across categories\n    //destructuing in reduce of value would not work for dynamic var\n    if (category === 'All') {\n      //create array of all unique dates\n      const uniqueDates = [...new Set(filterData.map(item => item.day))];\n      let filteredAndReducedForAll = []\n      //iterate over unique date\n      uniqueDates.map(uniqueDate => {\n        //filter filterData for current unique date\n        let value = _.filter(filterData, row => {\n          return row.day === uniqueDate\n        }).reduce((acc, { value }) => acc + value, 0)\n        let thisObj = {\n          day: uniqueDate,\n          value: value,\n          category: 'All'\n        }\n        filteredAndReducedForAll.push(thisObj)\n\n      })\n      filterData = filteredAndReducedForAll;\n    }\n  }\n\n  useEffect(() => {\n    if (lookerContent.length) {\n      setTimeout(() => performLookerApiCalls(lookerContent), 100);\n      setDesiredField(lookerContent[0].desiredFields[0])\n      setClientSideCode(rawSampleCode)\n    }\n  }, [lookerContent, lookerUser])\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", () => setHeight((window.innerHeight - topBarBottomBarHeight)));\n  })\n\n  const performLookerApiCalls = function (lookerContent) {\n    setApiContent([]); //set to empty array to show progress bar and skeleton\n    lookerContent.map(async lookerContent => {\n      let inlineQuery = lookerContent.inlineQuery;\n      inlineQuery.filters = {\n        // ...inlineQuery.filters,\n        // [Object.keys(inlineQuery.filters)[0]]: lookerUser.user_attributes.time_horizon,\n        [lookerContent.desiredFilterName]: lookerUser.user_attributes.brand\n      };\n      let stringifiedQuery = encodeURIComponent(JSON.stringify(inlineQuery));\n      // console.log('stringifiedQuery', stringifiedQuery)\n      let lookerResponse = await fetch(`/runinlinequery/${stringifiedQuery}/${lookerContent.resultFormat}`, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })\n      let lookerResponseData = await lookerResponse.json();\n      // console.log('lookerResponseData', lookerResponseData)\n      lookerResponseData.queryResults = lookerResponseData.queryResults.filter(item => {\n        return item[inlineQuery.fields[0]]\n      })\n      let uniqueCategories = ['All'];\n      for (let i = 0; i < lookerResponseData.queryResults.length; i++) {\n        if (uniqueCategories.indexOf(lookerResponseData.queryResults[i][inlineQuery.fields[1]]) === -1) {\n          uniqueCategories.push(lookerResponseData.queryResults[i][inlineQuery.fields[1]])\n        }\n      }\n      lookerResponseData.inlineQuery = inlineQuery;\n      lookerResponseData.uniqueCategories = uniqueCategories;\n      setFromDate(lookerResponseData.queryResults[lookerResponseData.queryResults.length - 1][lookerResponseData.inlineQuery.fields[0]]);\n      setToDate(incrementDate(lookerResponseData.queryResults[0][lookerResponseData.inlineQuery.fields[0]], 1));\n      setApiContent(lookerResponseData)\n      if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n    })\n  }\n\n  let nivoColorScale = ['#61cdbb', '#97e3d5', '#e8c1a0', '#f47560']\n  let googleColorScale = ['#4595EC', '#F3A759', '#E24E3A', '#65AB5A'];\n\n  return (\n    <div className={`${classes.root} demoComponent`}\n      style={{ height }}>\n      <Card elevation={1} className={`\n      ${classes.padding30} \n      ${classes.height100Percent}\n      ${classes.overflowScroll}`\n      }\n      >\n        <Grid container\n          key={validIdHelper(type)} >\n          <div className={`${classes.root} `}>\n\n            {!apiContent.queryResults ?\n              <Skeleton variant=\"rect\" animation=\"wave\" className={classes.skeleton} />\n              :\n              <FilterBar {...props}\n                classes={classes}\n                apiContent={apiContent}\n                fromDate={fromDate}\n                toDate={toDate}\n                category={category}\n                desiredField={desiredField}\n                handleFromDate={handleFromDate}\n                handleToDate={handleToDate}\n                handleCategory={handleCategory}\n                handleDesiredField={handleDesiredField}\n              />\n            }\n\n\n            {!apiContent.queryResults ?\n              <Grid item sm={12} style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                <Card className={`${classes.card} ${classes.flexCentered}`}\n                  elevation={0}\n                  mt={2}\n                  style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                  <CircularProgress className={classes.circularProgress} />\n                </Card>\n              </Grid>\n\n              : apiContent.queryResults && apiContent.queryResults.length ?\n                <Box>\n                  <Grid container\n                    spacing={3}\n                    className={`${classes.noContainerScroll}`}>\n                    {codeShow ?\n                      <Grid item sm={6}\n                        className={`${classes.positionFixedTopRight}`}\n                      >\n                        <CodeFlyout {...props}\n                          classes={classes}\n                          lookerUser={lookerUser}\n                          height={height}\n                        />\n                      </Grid> : ''}\n                    <Divider className={classes.divider} />\n                    <Grid item sm={12} >\n\n                      <Box className={`${classes.w100} ${classes.padding10}`} mt={2}>\n\n                        <ApiHighlight height={400} classes={classes}>\n                          <ResponsiveCalendar\n                            data={filterData}\n                            align=\"top\"\n                            from={incrementDate(fromDate, 1)}\n                            to={incrementDate(toDate, 1)}\n                            emptyColor=\"#eeeeee\"\n                            colors={desiredField === lookerContent[0].desiredFields[0] ? googleColorScale : nivoColorScale}\n                            yearSpacing={40}\n                            monthBorderColor=\"#ffffff\"\n                            dayBorderWidth={2}\n                            dayBorderColor=\"#ffffff\"\n                            margin={{ bottom: 40, left: 40 }}\n                            legends={[\n                              {\n                                anchor: 'bottom-right',\n                                direction: 'row',\n                                translateY: 36,\n                                itemCount: 4,\n                                itemWidth: 42,\n                                itemHeight: 36,\n                                itemsSpacing: 14,\n                                itemDirection: 'right-to-left'\n                              }\n                            ]}\n                            onClick={(day, event) => {\n                              if (!day.value) {\n                              } else if (lookerUser.user_attributes.permission_level === 'basic') {\n                                togglePayWallModal({\n                                  'show': true,\n                                  'permissionNeeded': 'see_drill_overlay'\n                                });\n                              } else {\n                                handleModalOpen(day)\n                                event.stopPropagation();\n                              }\n                            }}\n                          />\n                        </ApiHighlight>\n                      </Box>\n                    </Grid>\n                  </Grid>\n                </Box> :\n                ''\n            }\n          </div>\n        </Grid >\n        {\n          open ?\n            <ModalTable\n              {...props}\n              open={open}\n              onClose={handleModalClose}\n              classes={classes}\n              modalContent={modalContent}\n            />\n\n            : ''\n        }\n      </Card>\n    </div >\n  )\n}\n//Filter Bar code\nfunction FilterBar(props) {\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, classes,\n    apiContent, fromDate, toDate, category, desiredField, handleFromDate, handleToDate, handleCategory, handleDesiredField } = props;\n\n  const [expanded, setExpanded] = useState(true);\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n\n  // console.log('FilterBar')\n  // console.log('fromDate', fromDate)\n  // console.log('toDate', toDate)\n\n  return (\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel} className={classes.w100} elevation={0}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMore />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <FilterList /><Typography className={`${classes.heading} ${classes.ml12}`}>Filter:</Typography>\n\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <Grid container spacing={3}>\n          {apiContent.queryResults ?\n            <>\n              <Grid item sm={3}>\n\n                <ApiHighlight classes={classes}>\n                  <FormControl className={classes.formControl}>\n                    <InputLabel\n                      id={`${validIdHelper(type + '-FilterBar-DataPropery-SelectLabel')}`}\n                    >\n                      Metric</InputLabel>\n                    <Select\n                      labelId={`${validIdHelper(type + '-FilterBar-DataPropery-SelectLabel')}`}\n                      id={`${validIdHelper(type + '-FilterBar-DataPropery-Select')}`}\n                      value={desiredField}\n                      onChange={(event) => handleDesiredField(event.target.value)}\n                    >\n                      {lookerContent[0].desiredFields.map((item, index) => (\n\n                        <MenuItem\n                          id={validIdHelper(`${item}-${index}`)}\n                          key={validIdHelper(`${item}-${index}`)}\n                          value={item}\n                        >{item.substring(item.lastIndexOf(\".\") + 1, item.length).split(\"_\").map(item => item.charAt(0).toUpperCase() + item.substring(1)).join(\" \")}</MenuItem>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </ApiHighlight>\n              </Grid>\n              <Grid item sm={3}>\n                <ApiHighlight classes={classes}>\n                  <FormControl className={classes.formControl}>\n                    <InputLabel\n                      id={`${validIdHelper(type + '-FilterBar-Category-SelectLabel')}`}\n                    >\n                      Category</InputLabel>\n                    <Select\n                      labelId={`${validIdHelper(type + '-FilterBar-Category-SelectLabel')}`}\n                      id={`${validIdHelper(type + '-FilterBar-Category-Select')}`}\n                      value={category}\n                      onChange={(event) => handleCategory(event.target.value)}\n                    >\n                      {apiContent.uniqueCategories.map((item, index) => (\n\n                        <MenuItem\n                          id={validIdHelper(`${item}-${index}`)}\n                          key={validIdHelper(`${item}-${index}`)}\n                          value={item}>{item}</MenuItem>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </ApiHighlight>\n              </Grid>\n\n              <Grid item sm={3}>\n\n                <ApiHighlight classes={classes}>\n                  <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                    <KeyboardDatePicker\n                      disableToolbar\n                      variant=\"inline\"\n                      format=\"MM/dd/yyyy\"\n                      margin=\"normal\"\n                      id=\"fromDate\"\n                      label=\"From date\"\n                      value={fromDate}\n                      onChange={handleFromDate}\n                      KeyboardButtonProps={{\n                        'aria-label': 'change date',\n                      }}\n                      minDate={fromDate}\n                      maxDate={toDate}\n                    />\n                  </MuiPickersUtilsProvider>\n                </ApiHighlight>\n              </Grid>\n              <Grid item sm={3}>\n                <ApiHighlight classes={classes}>\n                  <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                    <KeyboardDatePicker\n                      disableToolbar\n                      variant=\"inline\"\n                      format=\"MM/dd/yyyy\"\n                      margin=\"normal\"\n                      id=\"toDate\"\n                      label=\"To date\"\n                      value={toDate}\n                      onChange={handleToDate}\n                      KeyboardButtonProps={{\n                        'aria-label': 'change date',\n                      }}\n                      minDate={fromDate}\n                      maxDate={toDate}\n                    />\n                  </MuiPickersUtilsProvider>\n                </ApiHighlight>\n              </Grid>\n            </>\n            : ''}\n        </Grid>\n      </ExpansionPanelDetails>\n    </ExpansionPanel >\n  )\n}\n\nfunction incrementDate(dateInput, increment) {\n  var dateFormatTotime = new Date(dateInput);\n  var increasedDate = new Date(dateFormatTotime.getTime() + (increment * 86400000));\n  return increasedDate.toISOString().split('T')[0];\n}"))}),[ne,re]),Object(a.useEffect)((function(){window.addEventListener("resize",(function(){return ee(window.innerHeight-112)}))}));var me=function(e){N([]),e.map(function(){var e=Object(d.a)(c.a.mark((function e(t){var n,a,o,r,i,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.inlineQuery).filters=Object(C.a)({},t.desiredFilterName,re.user_attributes.brand),a=encodeURIComponent(JSON.stringify(n)),e.next=5,fetch("/runinlinequery/".concat(a,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return o=e.sent,e.next=8,o.json();case 8:for((r=e.sent).queryResults=r.queryResults.filter((function(e){return e[n.fields[0]]})),i=["All"],s=0;s<r.queryResults.length;s++)-1===i.indexOf(r.queryResults[s][n.fields[1]])&&i.push(r.queryResults[s][n.fields[1]]);r.inlineQuery=n,r.uniqueCategories=i,m(r.queryResults[r.queryResults.length-1][r.inlineQuery.fields[0]]),g(Gt(r.queryResults[0][r.inlineQuery.fields[0]],1)),N(r),0===z.length&&V(r.code);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return o.a.createElement("div",{className:"".concat(te.root," demoComponent"),style:{height:Z}},o.a.createElement(pe.a,{elevation:1,className:"\n      ".concat(te.padding30," \n      ").concat(te.height100Percent,"\n      ").concat(te.overflowScroll)},o.a.createElement(he.a,{container:!0,key:Ut(oe)},o.a.createElement("div",{className:"".concat(te.root," ")},I.queryResults?o.a.createElement(Mt,Object.assign({},e,{classes:te,apiContent:I,fromDate:l,toDate:h,category:y,desiredField:_,handleFromDate:function(e){if(Date.parse(e)>0){var t=Object(Pt.a)(Object(Rt.a)(new Date(e),1),"yyyy-MM-dd");m(t)}},handleToDate:function(e){if(Date.parse(e)>0){var t=Object(Pt.a)(Object(Rt.a)(new Date(e),1),"yyyy-MM-dd");g(t)}},handleCategory:function(e){k(e)},handleDesiredField:function(e){S(e)}})):o.a.createElement(it.a,{variant:"rect",animation:"wave",className:te.skeleton}),I.queryResults?I.queryResults&&I.queryResults.length?o.a.createElement(O.a,null,o.a.createElement(he.a,{container:!0,spacing:3,className:"".concat(te.noContainerScroll)},K?o.a.createElement(he.a,{item:!0,sm:6,className:"".concat(te.positionFixedTopRight)},o.a.createElement(we,Object.assign({},e,{classes:te,lookerUser:re,height:Z}))):"",o.a.createElement(ae.a,{className:te.divider}),o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(O.a,{className:"".concat(te.w100," ").concat(te.padding10),mt:2},o.a.createElement(De,{height:400,classes:te},o.a.createElement(Dt.a,{data:le,align:"top",from:Gt(l,1),to:Gt(h,1),emptyColor:"#eeeeee",colors:_===ne[0].desiredFields[0]?["#4595EC","#F3A759","#E24E3A","#65AB5A"]:["#61cdbb","#97e3d5","#e8c1a0","#f47560"],yearSpacing:40,monthBorderColor:"#ffffff",dayBorderWidth:2,dayBorderColor:"#ffffff",margin:{bottom:40,left:40},legends:[{anchor:"bottom-right",direction:"row",translateY:36,itemCount:4,itemWidth:42,itemHeight:36,itemsSpacing:14,itemDirection:"right-to-left"}],onClick:function(e,t){e.value&&("basic"===re.user_attributes.permission_level?Q({show:!0,permissionNeeded:"see_drill_overlay"}):(se(e),t.stopPropagation()))}})))))):"":o.a.createElement(he.a,{item:!0,sm:12,style:{height:Z-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(pe.a,{className:"".concat(te.card," ").concat(te.flexCentered),elevation:0,mt:2,style:{height:Z-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(ge.a,{className:te.circularProgress}))))),H?o.a.createElement(Ft,Object.assign({},e,{open:H,onClose:function(){L({}),P(!1)},classes:te,modalContent:B})):""))}function Mt(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.staticContent.type,r=e.classes,i=e.apiContent,s=e.fromDate,l=e.toDate,c=e.category,d=e.desiredField,m=e.handleFromDate,u=e.handleToDate,p=e.handleCategory,h=e.handleDesiredField,g=Object(a.useState)(!0),b=Object(X.a)(g,2),f=b[0],y=b[1];return o.a.createElement(at.a,{expanded:f,onChange:function(e,t){y(!f)},className:r.w100,elevation:0},o.a.createElement(ot.a,{expandIcon:o.a.createElement(ct.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(dt.a,null),o.a.createElement(ee.a,{className:"".concat(r.heading," ").concat(r.ml12)},"Filter:")),o.a.createElement(rt.a,null,o.a.createElement(he.a,{container:!0,spacing:3},i.queryResults?o.a.createElement(o.a.Fragment,null,o.a.createElement(he.a,{item:!0,sm:3},o.a.createElement(De,{classes:r},o.a.createElement(bt.a,{className:r.formControl},o.a.createElement(ft.a,{id:"".concat(Ut(n+"-FilterBar-DataPropery-SelectLabel"))},"Metric"),o.a.createElement(yt.a,{labelId:"".concat(Ut(n+"-FilterBar-DataPropery-SelectLabel")),id:"".concat(Ut(n+"-FilterBar-DataPropery-Select")),value:d,onChange:function(e){return h(e.target.value)}},t[0].desiredFields.map((function(e,t){return o.a.createElement(ne.a,{id:Ut("".concat(e,"-").concat(t)),key:Ut("".concat(e,"-").concat(t)),value:e},e.substring(e.lastIndexOf(".")+1,e.length).split("_").map((function(e){return e.charAt(0).toUpperCase()+e.substring(1)})).join(" "))})))))),o.a.createElement(he.a,{item:!0,sm:3},o.a.createElement(De,{classes:r},o.a.createElement(bt.a,{className:r.formControl},o.a.createElement(ft.a,{id:"".concat(Ut(n+"-FilterBar-Category-SelectLabel"))},"Category"),o.a.createElement(yt.a,{labelId:"".concat(Ut(n+"-FilterBar-Category-SelectLabel")),id:"".concat(Ut(n+"-FilterBar-Category-Select")),value:c,onChange:function(e){return p(e.target.value)}},i.uniqueCategories.map((function(e,t){return o.a.createElement(ne.a,{id:Ut("".concat(e,"-").concat(t)),key:Ut("".concat(e,"-").concat(t)),value:e},e)})))))),o.a.createElement(he.a,{item:!0,sm:3},o.a.createElement(De,{classes:r},o.a.createElement(Bt.a,{utils:At.a},o.a.createElement(Lt.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"fromDate",label:"From date",value:s,onChange:m,KeyboardButtonProps:{"aria-label":"change date"},minDate:s,maxDate:l})))),o.a.createElement(he.a,{item:!0,sm:3},o.a.createElement(De,{classes:r},o.a.createElement(Bt.a,{utils:At.a},o.a.createElement(Lt.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"toDate",label:"To date",value:l,onChange:u,KeyboardButtonProps:{"aria-label":"change date"},minDate:s,maxDate:l}))))):"")))}function Gt(e,t){var n=new Date(e);return new Date(n.getTime()+864e5*t).toISOString().split("T")[0]}var qt=n(1052),zt=n(1027),Vt=n(1028),Wt=n(1029),Qt=n(1030),Kt=n(388),Jt=n.n(Kt),Yt=n(389),Xt=n.n(Yt),Zt=Object(Z.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,overflow:"scroll",borderRadius:"8px"},card:{minWidth:275,minHeight:400},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},skeleton:{minWidth:275,minHeight:600},ml24:{marginLeft:24},parentHoverVisibility:{"&:hover $childHoverVisibility":{visibility:"visible"}},childHoverVisibility:{visibility:"hidden"},faSm:{fontSize:".75em"},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"},padding30:{padding:30},mr12:{marginRight:12},ml12:{marginLeft:12},height100Percent:{height:"100%"},padding20:{padding:20},positionFixedTopRight:{position:"fixed",top:88,right:24,bottom:0,zIndex:100},codeFlyoutContainer:{backgroundColor:"rgb(40, 42, 54)",overflow:"scroll",borderRadius:"0 8px 8px 0"},whiteSpaceNoWrap:{whiteSpace:"nowrap"},overflowHidden:{overflow:"hidden"},overflowScroll:{overflow:"scroll"},overflowYScroll:{overflowY:"scroll",overflowX:"hidden"},noContainerScroll:{width:"100%",margin:0}}}));function en(e){var t=e.children,n=e.value,a=e.index,r=Object(m.a)(e,["children","value","index"]);return o.a.createElement(ee.a,Object.assign({component:"div",role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),o.a.createElement(O.a,{p:3},t))}n(256);var tn=n(48).validIdHelper;function nn(e){var t=Object(a.useState)(0),n=Object(X.a)(t,2),r=n[0],i=n[1],l=Object(a.useState)([]),m=Object(X.a)(l,2),u=m[0],p=m[1],h=Object(a.useState)({}),g=Object(X.a)(h,2),b=g[0],f=g[1],y=Object(a.useState)(""),C=Object(X.a)(y,2),k=(C[0],C[1]),w=Object(a.useState)(""),x=Object(X.a)(w,2),E=x[0],_=x[1],S=Object(a.useState)(window.innerHeight-112),j=Object(X.a)(S,2),I=j[0],N=j[1],F=Object(a.useContext)(ie),D=F.togglePayWallModal,H=F.codeShow,P=Zt(),R=Object(a.useState)(0),A=Object(X.a)(R,2),B=A[0],L=A[1],U=Object(a.useState)(null),$=Object(X.a)(U,2),M=$[0],G=$[1],q=(e.staticContent,e.staticContent.lookerContent),z=e.staticContent.type,V=e.activeTabValue,W=e.handleTabChange,Q=e.lookerUser,K=e.lookerHost,J=z,Y=Object(v.a)(q),Z=function(e,t){L(t)};Object(a.useEffect)((function(){V>B&&L(V),setTimeout((function(){return te(q,1)}),100),k("import $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport { AppBar, Tabs, Tab, Typography, Box, Grid, Icon, CircularProgress, Card, Button } from '@material-ui/core'\nimport { TreeView, TreeItem } from '@material-ui/lab';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./ReportBuilder.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport '../../Home.css';\nimport { ApiHighlight, EmbedHighlight } from '../../Highlights/Highlight';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of ReportBuilder Component\nexport default function ReportBuilder(props) {\n  const topBarBottomBarHeight = 112;\n  const [iFrameExists, setIFrame] = useState(0);\n  const [apiContent, setApiContent] = useState([]);\n  const [exploreObj, setExploreObj] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const [height, setHeight] = useState((window.innerHeight - topBarBottomBarHeight));\n  const { togglePayWallModal, codeShow } = useContext(AppContext)\n  const classes = useStyles();\n  const [value, setValue] = useState(0);\n  const [qid, setQid] = useState(null);\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser, lookerHost } = props;\n\n  const demoComponentType = type;\n  const tabContent = [...lookerContent]\n\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  useEffect(() => {\n    if (activeTabValue > value) {\n      setValue(activeTabValue)\n    }\n    setTimeout(() => performLookerApiCalls(lookerContent, 1), 100)\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent, lookerUser]);\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", () => setHeight((window.innerHeight - topBarBottomBarHeight)));\n  })\n\n  useEffect(() => {\n    if (value == 1 && lookerUser.user_attributes.permission_level != 'premium') {\n      togglePayWallModal({\n        'show': true,\n        'permissionNeeded': 'explore'\n      });\n    } else {\n      handleTabChange(value); //this could go\n      performLookerApiCalls(lookerContent);\n    }\n  }, [value])\n\n  const action = async (contentType, contentId, secondaryAction, qid, exploreId, newReportEmbedContainer) => {\n\n    let iFrameArray = $(\".embedContainer:visible > iframe\")\n\n    let matchingIndex = 0;\n    for (let i = 0; i < iFrameArray.length; i++) {\n      if (iFrameArray[i].classList.contains(contentType) && iFrameArray[i].classList.contains(contentId)) {\n        iFrameArray[i].classList.remove('dNone')\n        matchingIndex = i;\n      } else {\n        iFrameArray[i].classList.add('dNone')\n      }\n    }\n\n    if (secondaryAction === 'edit' || secondaryAction === 'explore') {\n      //save qid to state and use in perform looker api calls\n      setQid(qid);\n      handleChange('edit', 1)\n    } else if (secondaryAction === 'delete') {\n      //remove iframe associated with content that was deleted\n      let indexOfDeletedContent;\n      for (let i = 0; i < iFrameArray.length; i++) {\n        if (iFrameArray[i].classList.contains(contentId)) {\n          indexOfDeletedContent = i;\n        }\n      }\n      let updatedIFrameArray = iFrameArray.slice()\n      updatedIFrameArray.splice(indexOfDeletedContent, 1)\n      for (let i = 0; i < updatedIFrameArray.length; i++) {\n        if (i === 0) {\n          updatedIFrameArray[i].classList.remove('dNone')\n          matchingIndex = i;\n        } else {\n          updatedIFrameArray[i].classList.add('dNone')\n        }\n      }\n      //append updated array\n      $(`#embedContainer-reportbuilder-14`).empty();\n      $(`#embedContainer-reportbuilder-14`).html(updatedIFrameArray);\n\n      let lookerResponse = await fetch('/deletelook/' + contentId, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      if (lookerResponse.status === 200) {\n        performLookerApiCalls(lookerContent, 1)\n      }\n    }\n  }\n\n  const performLookerApiCalls = function (lookerContent, animateLoad) {\n    // console.log('performLookerApiCalls')\n    if (animateLoad) {\n      handleChange('refresh', 0)\n      setIFrame(0)\n      setApiContent([])\n    }\n\n    lookerContent.map(async lookerContent => {\n      if (lookerContent.type === 'folder' && value === 0) {\n        let lookerResponse = await fetch('/fetchfolder/' + lookerContent.id, {\n          method: 'GET',\n          headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json'\n          }\n        })\n\n        let lookerResponseData = await lookerResponse.json();\n        if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n\n        let looksToUse = [...lookerResponseData.sharedFolder.looks];\n        if (lookerUser.user_attributes.permission_level === 'premium' &&\n          Object.keys(lookerResponseData.embeddedUserFolder).length) {\n          looksToUse = [\n            ...looksToUse, ...lookerResponseData.embeddedUserFolder.looks\n          ]\n\n        }\n        let dashboardsToUse = [...lookerResponseData.sharedFolder.dashboards]\n        let objToUse = {\n          looks: looksToUse,\n          dashboards: dashboardsToUse\n        }\n        let iFrameArray = $(`.embedContainer.${validIdHelper(demoComponentType)} > iframe`);\n        if (objToUse.looks.length) {\n          objToUse.looks.map((item, index) => {\n\n            let lookId = item.id;\n            let lookIsRendered = false;\n            for (let i = 0; i < iFrameArray.length; i++) {\n              if (iFrameArray[i].classList.contains('look') && iFrameArray[i].classList.contains(lookId)) {\n                lookIsRendered = true;\n              }\n            }\n\n            if (!lookIsRendered) {\n              LookerEmbedSDK.createLookWithId(lookId)\n                .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n                .withClassName('iframe')\n                .withClassName('look')\n                .withClassName(lookerResponseData.sharedFolder.looks.indexOf(item) > -1 ? \"shared\" : \"personal\")\n                .withClassName(index > 0 ? 'dNone' : 'oops')\n                .withClassName(lookId)\n                .build()\n                .connect()\n                .then((look) => {\n                  // setIFrame(1)\n                  LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n                })\n                .catch((error) => {\n                  console.error('Connection error', error)\n                })\n            }\n\n            if (index === objToUse.looks.length - 1) {\n              setTimeout(() => setIFrame(1), 1000)\n            }\n          })\n        }\n\n        if (objToUse.dashboards.length) {\n          objToUse.dashboards.map((item, index) => {\n            let dashboardId = item.id\n            let dashboardIsRendered = false;\n            for (let i = 0; i < iFrameArray.length; i++) {\n              if (iFrameArray[i].classList.contains('dashboard') && iFrameArray[i].classList.contains(dashboardId)) {\n                dashboardIsRendered = true;\n              }\n            }\n            if (!dashboardIsRendered) {\n              LookerEmbedSDK.createDashboardWithId(dashboardId)\n                .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n                .withClassName('iframe')\n                .withClassName('dashboard')\n                .withClassName(lookerResponseData.sharedFolder.dashboards.indexOf(item) > -1 ? \"shared\" : \"personal\")\n                .withClassName('dNone')\n                .withClassName(dashboardId)\n                .build()\n                .connect()\n                .then((dashboard) => {\n                  setTimeout(() => {\n                    // setIFrame(1)\n                  }, 1000)\n                  LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n                })\n                .catch((error) => {\n                  console.error('Connection error', error)\n                })\n            }\n\n\n            if (index === objToUse.dashboards.length - 1) {\n              setTimeout(() => setIFrame(1), 1000)\n            }\n          })\n        }\n        setApiContent(objToUse)\n      } else if (lookerContent.type === 'explore' &&\n        lookerUser.user_attributes.permission_level === 'premium' &&\n        value === 1) {\n        let exploreId = lookerContent.id;\n        $(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`)).html('');\n        LookerEmbedSDK.createExploreWithId(exploreId)\n          .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n          .withClassName('exploreIframe')\n          .withParams({\n            qid: qid || ''\n          })\n          .on('explore:state:changed', (event) => {\n          })\n          .build()\n          .connect()\n          .then((explore) => {\n            setTimeout(() => setIFrame(1), 1000)\n            setExploreObj(exploreObj)\n            LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n            setQid(null)\n          })\n          .catch((error) => {\n            console.error('Connection error', error)\n          })\n      }\n    })\n  }\n\n  return (\n    <div className={`${classes.root} demoComponent`}\n      style={{ height }}>\n      <Card elevation={1} className={`\n      ${classes.padding30} \n      ${classes.height100Percent}\n      ${classes.overflowYScroll}`\n      }\n      >\n        <Grid container\n          key={validIdHelper(type)} >\n          <div className={classes.root}>\n            {iFrameExists ? '' :\n              <Grid item sm={12} style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                <Card className={`${classes.card} ${classes.flexCentered}`}\n                  elevation={0}\n                  mt={2}\n                  style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                  <CircularProgress className={classes.circularProgress} />\n                </Card>\n              </Grid>\n            }\n\n            {/* additional loading logic, need embedContainer to exist but want it hidden until iFrame has content...*/}\n            <Box className={iFrameExists ? `` : `${classes.hidden}`}>\n              <AppBar position=\"static\" elevation={0}>\n                <Tabs\n                  className={classes.tabs}\n                  value={value}\n                  onChange={handleChange}\n                  aria-label=\"simple tabs example\">\n                  {tabContent.map((item, index) => (\n                    <Tab\n                      key={`${validIdHelper(demoComponentType + '-tab-' + index)}`}\n                      label={index == 1 ?\n                        <div>\n\n                          {lookerUser.user_attributes.permission_level != 'premium' ?\n                            <Icon className={`fa fa-lock ${classes.faSm} ${classes.mr12}`} /> : <Icon className={`fa fa-plus ${classes.faSm} ${classes.mr12}`} />}\n                          {item.label}\n                        </div> :\n                        item.label}\n                      className={value === 1 && index === 1 ? `${classes.hidden}` : index == 1 ? `${classes.mlAuto}` : ``}\n                      style={index === 1 ? {\n                        backgroundColor: '#5896E6',\n                        borderRadius: '4px',\n                        color: '#fff',\n                        opacity: '1.0'\n                      } : {}}\n                      {...a11yProps(index)} />\n                  ))}\n                </Tabs>\n              </AppBar>\n              <Box className=\"tabPanelContainer\">\n                <Grid container\n                  spacing={3}\n                  className={`${classes.noContainerScroll}`}>\n                  {codeShow ?\n                    <Grid item sm={6}\n                      className={`${classes.positionFixedTopRight}`}\n                    >\n                      <CodeFlyout {...props}\n                        classes={classes}\n                        lookerUser={lookerUser}\n                        height={height}\n                      />\n                    </Grid> : ''}\n                  {tabContent.map((tabContentItem, tabContentItemIndex) => (\n                    <TabPanel\n                      key={`${validIdHelper(demoComponentType + '-tabPanel-' + tabContentItemIndex)}`}\n                      value={value}\n                      index={tabContentItemIndex}\n                      style={{ width: '100%' }} //weird\n                    >\n                      <Grid container>\n                        {\n                          tabContentItemIndex === 0\n                            ?\n                            <React.Fragment\n                              key={`${validIdHelper(demoComponentType + '-outerFragment-' + tabContentItemIndex)}`}>\n                              <Grid item sm={4} >\n                                <ApiHighlight height={500} classes={classes}>\n                                  <TreeSideBar {...{\n                                    togglePayWallModal,\n                                    classes,\n                                    demoComponentType,\n                                    tabContent,\n                                    tabContentItemIndex,\n                                    action,\n                                    apiContent,\n                                    ...props\n                                  }}\n                                  />\n                                </ApiHighlight>\n                              </Grid>\n                              <Grid item sm={8} >\n                                <EmbedHighlight classes={classes}>\n                                  <div\n                                    className={`embedContainer ${validIdHelper(demoComponentType)}`}\n                                    id={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                    key={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                  >\n                                  </div>\n                                </EmbedHighlight>\n                              </Grid>\n                            </React.Fragment>\n                            :\n                            <Grid item sm={12} >\n                              <EmbedHighlight classes={classes}>\n                                <div\n                                  className=\"embedContainer\"\n                                  id={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                  key={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                >\n                                </div>\n                              </EmbedHighlight>\n                            </Grid>\n                        }\n                      </Grid>\n                    </TabPanel>\n                  ))}</Grid>\n              </Box>\n            </Box >\n          </div>\n        </Grid >\n      </Card>\n    </div >\n  )\n}\n\n\nfunction TreeSideBar(props) {\n  const { staticContent, staticContent: { lookerContent }, classes, demoComponentType, tabContent, tabContentItemIndex, action, apiContent, lookerUser, togglePayWallModal } = props\n  const sharedFolderId = lookerContent[0].type === 'folder' ? lookerContent[0].id : '';\n  let treeCounter = 0;\n  const [selected, setSelected] = useState(2);\n  const expandedArr = Object.keys(apiContent).length ? [\"1\", \"\" + (2 + apiContent[Object.keys(apiContent)[0]].length)] : [];\n  const [expanded, setExpanded] = useState(expandedArr);\n\n  const handleToggle = (event, nodeIds) => {\n    setExpanded(nodeIds);\n  }\n\n  const handleSelect = (event, nodeIds) => {\n    setSelected(nodeIds);\n  };\n\n\n  useEffect(() => {\n    setExpanded(expandedArr);\n    if (selected !== 2) setSelected(2)\n    // let innerTreeItemArray = $(\".innerTreeItem\");\n    // console.log('innerTreeItemArray', innerTreeItemArray)\n    // for (let i = 0; i < innerTreeItemArray.length; i++) {\n    //   console.log('inside forrr', i)\n    //   if (innerTreeItemArray[i].classList.contains('Mui-selected')) {\n    //     console.log('inside iffff')\n    //     innerTreeItemArray[i].classList.remove('Mui-selected')\n    //   } else console.log('elllse')\n    // }\n  }, [apiContent]);\n\n\n  return (\n    <TreeView\n      className={classes.tree}\n      defaultCollapseIcon={<ExpandMoreIcon />}\n      defaultExpandIcon={<ChevronRightIcon />}\n      expanded={expanded}\n      onNodeToggle={handleToggle}\n      onNodeSelect={handleSelect}\n    // multiSelect={false}\n    >\n      {apiContent ? Object.keys(apiContent).map((key, outerIndex) => (\n        <React.Fragment\n          key={`${validIdHelper(demoComponentType + '-innerFragment-' + outerIndex)}`}>\n          <TreeItem\n            key={`${validIdHelper(demoComponentType + '-outerTreeItem-' + outerIndex)}`}\n            nodeId={\"\" + (treeCounter += 1)}\n            // treecounter={treeCounter}\n            label={_.capitalize(key)}\n            icon={<Icon className={`fa fa-folder ${classes.icon}`} />}\n            disabled={apiContent[key].length ? false : true}\n          >\n            {\n              apiContent[key].length ?\n                apiContent[key].map((item, index) => (\n                  <TreeItem\n                    key={`${validIdHelper(demoComponentType + '-innerTreeItem-' + treeCounter)}`}\n                    nodeId={\"\" + (treeCounter += 1)}\n                    treecounter={treeCounter}\n                    selected={selected === treeCounter}\n                    className={selected === treeCounter ? `Mui-selected innerTreeItem ${classes.whiteSpaceNoWrap}` : `innerTreeItem ${classes.whiteSpaceNoWrap}`}\n                    contentid={item.id}\n                    label={item.folder_id === sharedFolderId &&\n                      key === 'looks' ?\n                      <div\n                        id={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                        key={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                        className={`${classes.labelRoot} ${classes.parentHoverVisibility}`}\n                      >\n                        {/* {item.title.length > 15 ? item.title.substring(0, 15) + '...' : item.title} */}\n                        <Grid container>\n                          <Grid item sm={8} className={`${classes.overflowHidden}`}>\n                            {item.title}</Grid>\n                          <Grid item sm={4}>\n                            <Button\n                              id={`${validIdHelper(demoComponentType + '-innerTreeItem-Explore' + treeCounter)}`}\n                              key={`${validIdHelper(demoComponentType + '-innerTreeItem-Explore' + treeCounter)}`}\n                              size=\"small\"\n                              className={`${classes.ml12} ${classes.childHoverVisibility}`}\n                              onClick={(event) => {\n                                if (lookerUser.user_attributes.permission_level === 'premium') {\n                                  action(\n                                    key.substring(0, key.length - 1),\n                                    item.id,\n                                    'explore',\n                                    item.client_id,\n                                    tabContent[tabContentItemIndex + 1].id,\n                                    validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                                  );\n                                  event.stopPropagation();\n                                } else {\n                                  // togglePayWallModal();\n\n                                  togglePayWallModal({\n                                    'show': true,\n                                    'permissionNeeded': 'explore'\n                                  });\n                                }\n                              }\n                              }\n                              color=\"default\"\n                            >\n                              {lookerUser.user_attributes.permission_level === 'premium' ? 'Explore' : <div> <Icon className={`fa fa-lock ${classes.faSm} ${classes.mr12}`} />Explore</div>}\n                            </Button>\n                          </Grid>\n                        </Grid>\n\n\n                      </div>\n                      : key === 'looks' ?\n                        <div\n                          id={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                          key={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                          className={`${classes.labelRoot} ${classes.parentHoverVisibility}`}>\n                          <Grid container>\n                            <Grid item sm={6} className={`${classes.overflowHidden}`}>\n                              {/* {item.title.length > 15 ? item.title.substring(0, 15) + '...' : item.title} */}\n                              {item.title}\n                            </Grid>\n                            <Grid item sm={6}>\n                              <Button\n                                id={`${validIdHelper(demoComponentType + '-innerTreeItem-EditButton' + treeCounter)}`}\n                                key={`${validIdHelper(demoComponentType + '-innerTreeItem-EditButton' + treeCounter)}`}\n                                size=\"small\"\n                                className={`${classes.ml12} ${classes.childHoverVisibility}`}\n                                onClick={(event) => {\n                                  if (lookerUser.user_attributes.permission_level === 'premium') {\n                                    // setSelected(treeCounter);\n                                    action(\n                                      key.substring(0, key.length - 1),\n                                      item.id,\n                                      'edit',\n                                      item.client_id,\n                                      tabContent[tabContentItemIndex + 1].id,\n                                      validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                                    );\n                                    event.stopPropagation();\n                                  } else {\n                                    // togglePayWallModal();\n\n                                    togglePayWallModal({\n                                      'show': true,\n                                      'permissionNeeded': 'explore'\n                                    });\n                                  }\n                                }\n                                }\n                                color=\"primary\"\n                              >\n                                Edit\n                                                                                            </Button>\n                              <Button\n                                id={`${validIdHelper(demoComponentType + '-innerTreeItem-DeleteButton' + treeCounter)}`}\n                                key={`${validIdHelper(demoComponentType + '-innerTreeItem-DeleteButton' + treeCounter)}`}\n                                size=\"small\"\n                                className={`${classes.ml12} ${classes.childHoverVisibility}`}\n                                onClick={(event) => {\n                                  if (lookerUser.user_attributes.permission_level === 'premium') {\n                                    // setSelected(treeCounter);\n                                    action(\n                                      key.substring(0, key.length - 1),\n                                      item.id,\n                                      'delete',\n                                      item.client_id,\n                                      tabContent[tabContentItemIndex + 1].id,\n                                      validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                                    );\n                                    event.stopPropagation();\n                                  } else {\n                                    // togglePayWallModal();\n\n                                    togglePayWallModal({\n                                      'show': true,\n                                      'permissionNeeded': 'explore'\n                                    });\n                                  }\n                                }\n                                }\n                                color=\"secondary\"\n                              >\n                                Delete\n                                                                                            </Button>\n                            </Grid>\n                          </Grid>\n\n                        </div>\n                        : <Grid container><Grid item sm={12}>{item.title}</Grid></Grid>\n                    }\n                    onClick={() => {\n                      // setSelected(treeCounter)\n                      action(\n                        key.substring(0, key.length - 1), item.id)\n                    }} />\n\n                ))\n                :\n                ''\n            }\n          </TreeItem>\n\n        </React.Fragment>\n      )) : ''}\n    </TreeView>\n  )\n}")}),[q,Q]),Object(a.useEffect)((function(){window.addEventListener("resize",(function(){return N(window.innerHeight-112)}))})),Object(a.useEffect)((function(){1==B&&"premium"!=Q.user_attributes.permission_level?D({show:!0,permissionNeeded:"explore"}):(W(B),te(q))}),[B]);var ee=function(){var e=Object(d.a)(c.a.mark((function e(t,n,a,o,r,i){var s,l,d,m,u,p;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=ue()(".embedContainer:visible > iframe"),0,l=0;l<s.length;l++)s[l].classList.contains(t)&&s[l].classList.contains(n)?(s[l].classList.remove("dNone"),l):s[l].classList.add("dNone");if("edit"!==a&&"explore"!==a){e.next=8;break}G(o),Z(0,1),e.next=19;break;case 8:if("delete"!==a){e.next=19;break}for(m=0;m<s.length;m++)s[m].classList.contains(n)&&(d=m);for((u=s.slice()).splice(d,1),p=0;p<u.length;p++)0===p?(u[p].classList.remove("dNone"),p):u[p].classList.add("dNone");return ue()("#embedContainer-reportbuilder-14").empty(),ue()("#embedContainer-reportbuilder-14").html(u),e.next=17,fetch("/deletelook/"+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 17:200===e.sent.status&&te(q,1);case 19:case"end":return e.stop()}}),e)})));return function(t,n,a,o,r,i){return e.apply(this,arguments)}}(),te=function(e,t){t&&(Z(0,0),i(0),p([])),e.map(function(){var e=Object(d.a)(c.a.mark((function e(t){var n,a,o,r,s,l,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("folder"!==t.type||0!==B){e.next=18;break}return e.next=3,fetch("/fetchfolder/"+t.id,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,0===E.length&&_(a.code),o=Object(v.a)(a.sharedFolder.looks),"premium"===Q.user_attributes.permission_level&&Object.keys(a.embeddedUserFolder).length&&(o=[].concat(Object(v.a)(o),Object(v.a)(a.embeddedUserFolder.looks))),r=Object(v.a)(a.sharedFolder.dashboards),s={looks:o,dashboards:r},l=ue()(".embedContainer.".concat(tn(J)," > iframe")),s.looks.length&&s.looks.map((function(e,n){for(var o=e.id,r=!1,c=0;c<l.length;c++)l[c].classList.contains("look")&&l[c].classList.contains(o)&&(r=!0);r||ce.LookerEmbedSDK.createLookWithId(o).appendTo(tn("#embedContainer-".concat(J,"-").concat(t.id))).withClassName("iframe").withClassName("look").withClassName(a.sharedFolder.looks.indexOf(e)>-1?"shared":"personal").withClassName(n>0?"dNone":"oops").withClassName(o).build().connect().then((function(e){ce.LookerEmbedSDK.init("https://".concat(K,".looker.com"))})).catch((function(e){console.error("Connection error",e)})),n===s.looks.length-1&&setTimeout((function(){return i(1)}),1e3)})),s.dashboards.length&&s.dashboards.map((function(e,n){for(var o=e.id,r=!1,c=0;c<l.length;c++)l[c].classList.contains("dashboard")&&l[c].classList.contains(o)&&(r=!0);r||ce.LookerEmbedSDK.createDashboardWithId(o).appendTo(tn("#embedContainer-".concat(J,"-").concat(t.id))).withClassName("iframe").withClassName("dashboard").withClassName(a.sharedFolder.dashboards.indexOf(e)>-1?"shared":"personal").withClassName("dNone").withClassName(o).build().connect().then((function(e){setTimeout((function(){}),1e3),ce.LookerEmbedSDK.init("https://".concat(K,".looker.com"))})).catch((function(e){console.error("Connection error",e)})),n===s.dashboards.length-1&&setTimeout((function(){return i(1)}),1e3)})),p(s),e.next=19;break;case 18:"explore"===t.type&&"premium"===Q.user_attributes.permission_level&&1===B&&(d=t.id,ue()(tn("#embedContainer-".concat(J,"-").concat(t.id))).html(""),ce.LookerEmbedSDK.createExploreWithId(d).appendTo(tn("#embedContainer-".concat(J,"-").concat(t.id))).withClassName("exploreIframe").withParams({qid:M||""}).on("explore:state:changed",(function(e){})).build().connect().then((function(e){setTimeout((function(){return i(1)}),1e3),f(b),ce.LookerEmbedSDK.init("https://".concat(K,".looker.com")),G(null)})).catch((function(e){console.error("Connection error",e)})));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return o.a.createElement("div",{className:"".concat(P.root," demoComponent"),style:{height:I}},o.a.createElement(pe.a,{elevation:1,className:"\n      ".concat(P.padding30," \n      ").concat(P.height100Percent,"\n      ").concat(P.overflowYScroll)},o.a.createElement(he.a,{container:!0,key:tn(z)},o.a.createElement("div",{className:P.root},r?"":o.a.createElement(he.a,{item:!0,sm:12,style:{height:I-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(pe.a,{className:"".concat(P.card," ").concat(P.flexCentered),elevation:0,mt:2,style:{height:I-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(ge.a,{className:P.circularProgress}))),o.a.createElement(O.a,{className:r?"":"".concat(P.hidden)},o.a.createElement(T.a,{position:"static",elevation:0},o.a.createElement(qt.a,{className:P.tabs,value:B,onChange:Z,"aria-label":"simple tabs example"},Y.map((function(e,t){return o.a.createElement(zt.a,Object.assign({key:"".concat(tn(J+"-tab-"+t)),label:1==t?o.a.createElement("div",null,"premium"!=Q.user_attributes.permission_level?o.a.createElement(Vt.a,{className:"fa fa-lock ".concat(P.faSm," ").concat(P.mr12)}):o.a.createElement(Vt.a,{className:"fa fa-plus ".concat(P.faSm," ").concat(P.mr12)}),e.label):e.label,className:1===B&&1===t?"".concat(P.hidden):1==t?"".concat(P.mlAuto):"",style:1===t?{backgroundColor:"#5896E6",borderRadius:"4px",color:"#fff",opacity:"1.0"}:{}},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)))})))),o.a.createElement(O.a,{className:"tabPanelContainer"},o.a.createElement(he.a,{container:!0,spacing:3,className:"".concat(P.noContainerScroll)},H?o.a.createElement(he.a,{item:!0,sm:6,className:"".concat(P.positionFixedTopRight)},o.a.createElement(we,Object.assign({},e,{classes:P,lookerUser:Q,height:I}))):"",Y.map((function(t,n){return o.a.createElement(en,{key:"".concat(tn(J+"-tabPanel-"+n)),value:B,index:n,style:{width:"100%"}},o.a.createElement(he.a,{container:!0},0===n?o.a.createElement(o.a.Fragment,{key:"".concat(tn(J+"-outerFragment-"+n))},o.a.createElement(he.a,{item:!0,sm:4},o.a.createElement(De,{height:500,classes:P},o.a.createElement(an,Object(s.a)({togglePayWallModal:D,classes:P,demoComponentType:J,tabContent:Y,tabContentItemIndex:n,action:ee,apiContent:u},e)))),o.a.createElement(he.a,{item:!0,sm:8},o.a.createElement(He,{classes:P},o.a.createElement("div",{className:"embedContainer ".concat(tn(J)),id:tn("embedContainer-".concat(J,"-").concat(t.id)),key:tn("embedContainer-".concat(J,"-").concat(t.id))})))):o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(He,{classes:P},o.a.createElement("div",{className:"embedContainer",id:tn("embedContainer-".concat(J,"-").concat(t.id)),key:tn("embedContainer-".concat(J,"-").concat(t.id))})))))})))))))))}function an(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.classes,r=e.demoComponentType,i=e.tabContent,s=e.tabContentItemIndex,l=e.action,c=e.apiContent,d=e.lookerUser,m=e.togglePayWallModal,u="folder"===t[0].type?t[0].id:"",p=0,h=Object(a.useState)(2),g=Object(X.a)(h,2),b=g[0],f=g[1],y=Object.keys(c).length?["1",""+(2+c[Object.keys(c)[0]].length)]:[],C=Object(a.useState)(y),v=Object(X.a)(C,2),k=v[0],x=v[1];return Object(a.useEffect)((function(){x(y),2!==b&&f(2)}),[c]),o.a.createElement(Wt.a,{className:n.tree,defaultCollapseIcon:o.a.createElement(Jt.a,null),defaultExpandIcon:o.a.createElement(Xt.a,null),expanded:k,onNodeToggle:function(e,t){x(t)},onNodeSelect:function(e,t){f(t)}},c?Object.keys(c).map((function(e,t){return o.a.createElement(o.a.Fragment,{key:"".concat(tn(r+"-innerFragment-"+t))},o.a.createElement(Qt.a,{key:"".concat(tn(r+"-outerTreeItem-"+t)),nodeId:""+(p+=1),label:w.a.capitalize(e),icon:o.a.createElement(Vt.a,{className:"fa fa-folder ".concat(n.icon)}),disabled:!c[e].length},c[e].length?c[e].map((function(t,a){return o.a.createElement(Qt.a,{key:"".concat(tn(r+"-innerTreeItem-"+p)),nodeId:""+(p+=1),treecounter:p,selected:b===p,className:b===p?"Mui-selected innerTreeItem ".concat(n.whiteSpaceNoWrap):"innerTreeItem ".concat(n.whiteSpaceNoWrap),contentid:t.id,label:t.folder_id===u&&"looks"===e?o.a.createElement("div",{id:"".concat(tn(r+"-innerTreeItem-LabelContainer"+p)),key:"".concat(tn(r+"-innerTreeItem-LabelContainer"+p)),className:"".concat(n.labelRoot," ").concat(n.parentHoverVisibility)},o.a.createElement(he.a,{container:!0},o.a.createElement(he.a,{item:!0,sm:8,className:"".concat(n.overflowHidden)},t.title),o.a.createElement(he.a,{item:!0,sm:4},o.a.createElement(Ye.a,{id:"".concat(tn(r+"-innerTreeItem-Explore"+p)),key:"".concat(tn(r+"-innerTreeItem-Explore"+p)),size:"small",className:"".concat(n.ml12," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.user_attributes.permission_level?(l(e.substring(0,e.length-1),t.id,"explore",t.client_id,i[s+1].id,tn("embedContainer-".concat(r,"-").concat(i[s+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"default"},"premium"===d.user_attributes.permission_level?"Explore":o.a.createElement("div",null," ",o.a.createElement(Vt.a,{className:"fa fa-lock ".concat(n.faSm," ").concat(n.mr12)}),"Explore"))))):"looks"===e?o.a.createElement("div",{id:"".concat(tn(r+"-innerTreeItem-LabelContainer"+p)),key:"".concat(tn(r+"-innerTreeItem-LabelContainer"+p)),className:"".concat(n.labelRoot," ").concat(n.parentHoverVisibility)},o.a.createElement(he.a,{container:!0},o.a.createElement(he.a,{item:!0,sm:6,className:"".concat(n.overflowHidden)},t.title),o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(Ye.a,{id:"".concat(tn(r+"-innerTreeItem-EditButton"+p)),key:"".concat(tn(r+"-innerTreeItem-EditButton"+p)),size:"small",className:"".concat(n.ml12," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.user_attributes.permission_level?(l(e.substring(0,e.length-1),t.id,"edit",t.client_id,i[s+1].id,tn("embedContainer-".concat(r,"-").concat(i[s+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"primary"},"Edit"),o.a.createElement(Ye.a,{id:"".concat(tn(r+"-innerTreeItem-DeleteButton"+p)),key:"".concat(tn(r+"-innerTreeItem-DeleteButton"+p)),size:"small",className:"".concat(n.ml12," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.user_attributes.permission_level?(l(e.substring(0,e.length-1),t.id,"delete",t.client_id,i[s+1].id,tn("embedContainer-".concat(r,"-").concat(i[s+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"secondary"},"Delete")))):o.a.createElement(he.a,{container:!0},o.a.createElement(he.a,{item:!0,sm:12},t.title)),onClick:function(){l(e.substring(0,e.length-1),t.id)}})})):""))})):"")}var on=n(1064),rn=n(1033),sn=n(1065),ln=n(1066),cn=n(1032),dn=n(208),mn=(J.a[400],J.a[100],dn.a[400],dn.a[100],Object(Z.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper,overflow:"scroll",borderRadius:"8px"},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},ml12:{marginLeft:12},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},formControl:{margin:e.spacing(1),minWidth:120},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275,minHeight:400},textCenter:{textAlign:"center"},bluePrimary:{backgroundColor:"rgba(69, 149, 236, 1)"},blueSecondary:{backgroundColor:"rgba(69, 149, 236, .5)"},orangePrimary:{backgroundColor:"rgba(243, 167, 89, 1)"},orangeSecondary:{backgroundColor:"rgba(243, 167, 89, .5)"},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"},bottomBarSpacer:Object(s.a)(Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),maxHeight600:{maxHeight:600,overflow:"scroll"},padding30:{padding:30},m12:{margin:12},m6:{margin:6},height100Percent:{height:"100%",overflow:"scroll"},padding20:{padding:20},positionFixedTopRight:{position:"fixed",top:88,right:24,bottom:0,zIndex:100},codeFlyoutContainer:{backgroundColor:"rgb(40, 42, 54)",overflow:"scroll",borderRadius:"0 8px 8px 0"},padding10:{padding:10},overflowScroll:{overflow:"scroll"},overflowYScroll:{overflowY:"scroll",overflowX:"hidden"},noContainerScroll:{width:"100%",margin:0}}})));function un(e,t,n){return e[n]&&t[n]&&t[n].value<e[n].value?-1:e[n]&&t[n]&&t[n].value>e[n].value?1:0}var pn=n(48),hn=pn.validIdHelper,gn=pn.prettifyString;function bn(e){var t=Object(a.useState)(0),n=Object(X.a)(t,2),r=(n[0],n[1],Object(a.useState)({})),i=Object(X.a)(r,2),l=i[0],m=i[1],u=Object(a.useState)(""),p=Object(X.a)(u,2),h=(p[0],p[1]),g=Object(a.useState)(""),b=Object(X.a)(g,2),f=(b[0],b[1]),y=Object(a.useContext)(ie),C=(y.togglePayWallModal,y.show,y.codeShow),v=Object(a.useState)(window.innerHeight-112),k=Object(X.a)(v,2),w=k[0],x=k[1],E=Object(a.useState)(window.innerWidth-392),_=Object(X.a)(E,2),S=_[0],j=_[1],T=mn(),I=(e.staticContent,e.staticContent.lookerContent),N=e.staticContent.type,F=(e.activeTabValue,e.handleTabChange,e.lookerUser);Object(a.useEffect)((function(){h("import $ from 'jquery';\nimport _ from 'lodash';\nimport React, { useState, useEffect, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, Icon, CircularProgress, Card, Button,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails, InputLabel, MenuItem, FormControl,\n  Select, Table, TableBody, TableCell, TableContainer, TableHead, TablePagination, TableRow,\n  TableSortLabel, FormControlLabel, Switch, Chip, Divider\n} from '@material-ui/core'\nimport { ExpandMore, Search, Done } from '@material-ui/icons';\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./QueryBuilder.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { ApiHighlight } from '../../Highlights/Highlight';\nimport { TabPanel, a11yProps, descendingComparator, getComparator, stableSort } from './helpers.js';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper, prettifyString } = require('../../../tools');\n\nexport default function QueryBuilder(props) {\n  // console.log('QueryBuilder')\n\n  const topBarBottomBarHeight = 112;\n  const sideBarWidth = 240 + 152; //24 + 24 + 30 + 30 + 12 + 12 + 10 + 10\n  const [value, setValue] = useState(0);\n  const [apiContent, setApiContent] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const { togglePayWallModal, show, codeShow } = useContext(AppContext);\n  const [height, setHeight] = useState((window.innerHeight - topBarBottomBarHeight));\n  const [width, setWidth] = useState((window.innerWidth - sideBarWidth));\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser } = props;\n\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  useEffect(() => {\n    // call this is filterBar instead to make field chip dynamic\n    // lookerContent.map(lookerContent => {\n    //   setTimeout(() => performLookerApiCalls(lookerContent.queryBody, lookerContent.resultFormat), 100);\n    // })\n    setClientSideCode(rawSampleCode);\n    // setApiContent([])\n  }, [lookerContent, lookerUser])\n\n  useEffect(() => {\n    window.addEventListener(\"resize\", () => {\n      setHeight((window.innerHeight - topBarBottomBarHeight))\n      setWidth((window.innerWidth - sideBarWidth))\n    });\n  })\n\n  const performLookerApiCalls = async (newQuery, resultFormat) => {\n    // console.log('performLookerApiCalls')\n    let apiContentCopy = { ...apiContent }\n    apiContentCopy.status = 'running';\n    setApiContent(apiContentCopy)\n\n    let timer = Date.now();\n    console.log('timer', timer);\n\n    let lookerCreateTaskResposnse = await fetch('/createquerytask/' + JSON.stringify(newQuery), {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n    let lookerCreateTaskResponseData = await lookerCreateTaskResposnse.json();\n\n    let taskInterval = setInterval(async () => {\n      let lookerCheckTaskResposnse = await fetch('/checkquerytask/' + lookerCreateTaskResponseData.queryTaskId, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })\n      let lookerCheckTaskResponseData = await lookerCheckTaskResposnse.json();\n      if (lookerCheckTaskResponseData.queryResults.status === 'complete') {\n        clearInterval(taskInterval);\n        setApiContent(lookerCheckTaskResponseData.queryResults)\n        setServerSideCode(lookerCreateTaskResponseData.code)\n      }\n\n      //time out after 30 seconds\n      if ((timer + (30 * 1000)) < Date.now()) {\n        clearInterval()\n        setApiContent([])\n      }\n\n    }, 5000)\n\n\n\n  }\n\n  return (\n    <div className={`${classes.root} demoComponent`}\n      style={{ height }}>\n      <Card elevation={1} className={`\n      ${classes.padding30} \n      ${classes.height100Percent}\n      ${classes.overflowYScroll}`\n      }\n      >\n        <Grid container\n          key={validIdHelper(type)} >\n          <div className={`${classes.root}`}>\n            <Grid item sm={12}>\n              <FilterBar {...props}\n                classes={classes}\n                action={performLookerApiCalls}\n              />\n            </Grid>\n            {apiContent.status === 'running' ?\n              <Grid item sm={12} style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                <Card className={`${classes.card} ${classes.flexCentered}`}\n                  elevation={0}\n                  mt={2}\n                  style={{ height: height - 30 - ($('.MuiExpansionPanel-root:visible').innerHeight() || 0) }}>\n                  <CircularProgress className={classes.circularProgress} />\n                </Card>\n              </Grid>\n              : apiContent.data && apiContent.data.length ?\n                <Box>\n                  <Grid container\n                    spacing={3}\n                    className={`${classes.noContainerScroll}`}>\n                    {codeShow ?\n                      <Grid item sm={6}\n                        className={`${classes.positionFixedTopRight}`}\n                      >\n                        <CodeFlyout {...props}\n                          classes={classes}\n                          lookerUser={lookerUser}\n                          height={height}\n                        />\n                      </Grid> : ''}\n                    <Divider className={classes.divider} />\n                    <Grid item sm={12}>\n                      <Box className={`${classes.w100}`} mt={2}>\n                        < EnhancedTable\n                          {...props}\n                          classes={classes}\n                          rows={apiContent.data}\n                          lookerContent={lookerContent}\n                          width={width}\n                        />\n                      </Box>\n                    </Grid>\n                  </Grid>\n                </Box>\n                :\n                <Grid item sm={12} >\n                  <Typography variant=\"h6\" component=\"h6\" className={`${classes.gridTitle} ${classes.textCenter}`}>\n                    No results found, try a new query<br />\n                  </Typography>\n                </Grid>\n            }\n          </div >\n        </Grid >\n      </Card>\n    </div >\n  )\n}\n\n\nfunction FilterBar(props) {\n  // console.log('FilterBar');\n  const { staticContent, staticContent: { lookerContent }, classes, action, lookerUser } = props;\n  let measureCounter = 0;\n  let dimensionCounter = 0;\n\n\n  const initializeFieldChipDataHelper = () => {\n    let initializedFields = lookerContent[0].queryBody.fields.map((item, index) => {\n      return {\n        key: 'fieldChipData' + index,\n        label: prettifyString(item.substring(item.lastIndexOf('.') + 1, item.length)),\n        datalabel: item,\n        selected: item === 'users.state' || item === 'users.country' || item === 'order_items.total_sale_price' ? true : false,\n        fieldType: lookerContent[0].fieldType[item]\n      }\n    })\n    return initializedFields;\n  }\n\n  const [expanded, setExpanded] = useState(true);\n  const [fieldsChipData, setFieldsChipData] = useState(lookerContent[0].queryBody ? initializeFieldChipDataHelper() : '');\n  const [queryModified, setQueryModified] = useState(true); //set to true initially\n  const [queryShouldRun, setQueryShouldRun] = useState(false); //for lookerUser useEffect\n  const [filtersData, setFilterData] = useState(lookerContent[0].queryBody ? Object.keys(lookerContent[0].queryBody.filters).map((key, index) => {\n    return {\n      key: 'filter' + index,\n      label: key,\n      value: lookerContent[0].queryBody.filters[key],\n      type: lookerContent[0].filterType[key]\n    }\n  }) : '')\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n\n  const handleFieldChipClick = (chip, index) => {\n    let updatedFieldsChipData = [...fieldsChipData]\n    updatedFieldsChipData[index].selected = updatedFieldsChipData[index].selected === false ? true : false\n    setFieldsChipData(updatedFieldsChipData)\n    setQueryModified(true)\n  }\n\n  const handleSelectChange = (index, newValue) => {\n    let updatedFiltersData = [...filtersData]\n    updatedFiltersData[index].value = newValue;\n    setFilterData(updatedFiltersData)\n    setQueryModified(true)\n  }\n\n  const handleQuerySubmit = (event) => {\n    if (queryModified || queryShouldRun) {\n      let newFields = fieldsChipData.filter(chip => chip.selected).map(item => item.datalabel);\n      let currentFilters = {}; //needs to be object\n      filtersData.map((item, index) => {\n        currentFilters[item.label] = item.value\n      })\n      let newQueryObj = { ...lookerContent[0].queryBody };\n      newQueryObj.fields = newFields;\n      newQueryObj.filters = currentFilters;\n\n      action(newQueryObj, lookerContent[0].resultFormat);\n\n      setQueryModified(false)\n      setQueryShouldRun(false)\n    } //else console.log('elllse')\n  }\n\n\n\n  useEffect(() => {\n    // console.log('useEffect lookerUser')\n    const lookerUserTimeHorizonMap = {\n      'basic': 'last 182 days',\n      'advanced': 'last 365 days',\n      'premium': 'last 730 days' //before today\n    }\n    let updatedFiltersData = [...filtersData]\n    updatedFiltersData[3].value = lookerUserTimeHorizonMap[lookerUser.user_attributes.permission_level] || \"182 days\";\n    setFilterData(updatedFiltersData);\n    setFieldsChipData(initializeFieldChipDataHelper())\n\n    setQueryShouldRun(true);\n  }, [lookerUser]);\n\n  useEffect(() => {\n    // console.log('useEffect queryShouldRun')\n    if (queryShouldRun) {\n      handleQuerySubmit();\n      setQueryModified(false);\n      setQueryShouldRun(false);\n    }\n  }, [queryShouldRun])\n\n\n  const datePermissionMap = {\n    'basic': [\"1 week\", \"1 month\", \"3 months\", \"last 182 days\"]\n  }\n  datePermissionMap.advanced = [...datePermissionMap.basic, \"last 365 days\"]\n  datePermissionMap.premium = [...datePermissionMap.advanced, \"last 730 days\"]\n\n  return (\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel} elevation={0}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMore />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <Search /><Typography className={`${classes.heading} ${classes.ml12}`}>Build Query:</Typography>\n        {/* <Typography className={classes.heading}>Build Query:</Typography> */}\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <Grid container spacing={3}>\n          <Grid item sm={12}>\n            <Typography variant=\"subtitle1\">\n              Select Metrics:\n      {fieldsChipData.length ?\n                fieldsChipData.map((item, index) => {\n                  return (\n                    item.fieldType === 'measure' ?\n                      <Chip\n                        key={item.label}\n                        // key={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        measurecounter={measureCounter += 1}\n                        className={item.selected ? `${classes.orangePrimary} ${classes.m6}` : `${classes.m6}`}\n                        label={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        datalabel={item.label}\n                        onClick={() => handleFieldChipClick(item, index)}\n                        icon={item.selected ? <Done className={classes.dBlock} /> : <Done className={classes.dNone} />}\n                      /> : ''\n                  )\n                }) : ''\n              }<br />\n            </Typography>\n          </Grid>\n          <Grid item sm={12}>\n            <Typography variant=\"subtitle1\">\n              Group By:\n                          {fieldsChipData.length ?\n                fieldsChipData.map((item, index) => {\n                  return (\n                    item.fieldType === 'dimension' ?\n                      <Chip\n                        key={item.label}\n                        dimensioncounter={dimensionCounter += 1}\n                        className={item.selected ? `${classes.bluePrimary} ${classes.m6}` : `${classes.m6}`}\n                        label={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        datalabel={item.label}\n                        onClick={() => handleFieldChipClick(item, index)}\n                        icon={item.selected ? <Done className={classes.dBlock} /> : <Done className={classes.dNone} />}\n                      /> : ''\n                  )\n                }) : ''\n              }<br />\n            </Typography>\n          </Grid>\n\n          <Grid item sm={3}>\n            <Typography variant=\"subtitle1\">\n              Filter By:\n                      </Typography>\n            {filtersData.length ? filtersData.map((item, index) => {\n              return (\n                <FormControl className={item.value.length ? classes.formControl : classes.hidden} key={validIdHelper(`${item.label}FormControl`)}>\n                  {\n                    item.type === 'yesno' ?\n                      <>\n                        <InputLabel id={validIdHelper(`${item.label}FilterLabel`)}>{prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}:</InputLabel>\n                        <Select\n                          labelId={validIdHelper(`${item.label}FilterLabel`)}\n                          id={validIdHelper(`${item.label}FilterSelect`)}\n                          value={item.value}\n                          onChange={(event) => handleSelectChange(index, event.target.value)}\n                        >\n                          <MenuItem value=\"Yes\">Yes</MenuItem>\n                          <MenuItem value=\"No\">No</MenuItem>\n                          <MenuItem value=\"All\">All</MenuItem>\n                        </Select>\n                      </>\n                      : item.type === 'date' ?\n                        <>\n                          <InputLabel id={validIdHelper(`${item.label}FilterLabel`)}>{prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}:</InputLabel>\n\n                          <Select\n                            labelId={validIdHelper(`${item.label}FilterLabel`)}\n                            id={validIdHelper(`${item.label}FilterSelect`)}\n                            value={item.value || '6 months'}\n                            onChange={(event) => handleSelectChange(index, event.target.value)}\n                          >\n                            {lookerUser.user_attributes.permission_level ? datePermissionMap[lookerUser.user_attributes.permission_level].map(item => (\n                              <MenuItem key={validIdHelper(item)} value={item}>{_.capitalize(item)}</MenuItem>\n                            )) : ''}\n                          </Select>\n                        </>\n                        : ''\n                  }\n                </FormControl>\n              )\n            }) : ''}\n          </Grid>\n          <Grid item sm={9}>\n            <br />\n            <Button\n              color=\"primary\"\n              variant=\"contained\"\n              size=\"large\"\n              onClick={handleQuerySubmit}\n              disabled={queryModified ? false : true}\n            >Run Query</Button></Grid>\n        </Grid>\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  )\n}\n\nfunction EnhancedTableHead(props) {\n  const { classes, onSelectAllClick, order, orderBy, numSelected, rowCount, onRequestSort, rows } = props;\n  const createSortHandler = (property) => (event) => {\n    onRequestSort(event, property);\n  };\n\n  return (\n    <TableHead>\n      <TableRow>\n        {Object.keys(rows[0]).map((key, index) => (\n          <TableCell\n            key={validIdHelper(key + '-TableHead-TableCell-' + index)}\n            id={validIdHelper(key + '-TableHead-TableCell-' + index)}\n            align={key.numeric ? 'right' : 'left'}\n            padding={key.disablePadding ? 'none' : 'default'}\n            sortDirection={orderBy === key ? order : false}\n          >\n            <TableSortLabel\n              active={orderBy === key}\n              direction={orderBy === key ? order : 'asc'}\n              onClick={createSortHandler(key)}\n            >\n              {prettifyString(key.substring(key.lastIndexOf('.') + 1, key.length))}\n              {orderBy === key ? (\n                <span className={classes.visuallyHidden}>\n                  {order === 'desc' ? 'sorted descending' : 'sorted ascending'}\n                </span>\n              ) : null}\n            </TableSortLabel>\n          </TableCell>\n        ))}\n      </TableRow>\n    </TableHead>\n  );\n}\n\nEnhancedTableHead.propTypes = {\n  classes: PropTypes.object.isRequired,\n  // numSelected: PropTypes.number.isRequired,\n  onRequestSort: PropTypes.func.isRequired,\n  // onSelectAllClick: PropTypes.func.isRequired,\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\n  orderBy: PropTypes.string.isRequired,\n  rowCount: PropTypes.number.isRequired,\n};\n\nfunction EnhancedTable(props) {\n  const { rows, classes, lookerContent, width } = props;\n  const [order, setOrder] = React.useState('asc');\n  const [orderBy, setOrderBy] = React.useState(Object.keys(rows[0])[0]);\n  const [page, setPage] = React.useState(0);\n  const [dense, setDense] = React.useState(true);\n  const [rowsPerPage, setRowsPerPage] = React.useState(25);\n\n  const handleRequestSort = (event, property) => {\n    const isAsc = orderBy === property && order === 'asc';\n    setOrder(isAsc ? 'desc' : 'asc');\n    setOrderBy(property);\n  };\n\n  const handleChangePage = (event, newPage) => {\n    setPage(newPage);\n  };\n\n  const handleChangeRowsPerPage = (event) => {\n    setRowsPerPage(parseInt(event.target.value, 10));\n    setPage(0);\n  };\n\n  const handleChangeDense = (event) => {\n    setDense(event.target.checked);\n  };\n\n  const emptyRows = rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage);\n  return (\n    <div className={`${classes.root} ${classes.padding10}`}>\n      <ApiHighlight classes={classes} >\n        <TableContainer style={{ maxWidth: width }}>\n          <Table\n            className={classes.table}\n            aria-labelledby=\"tableTitle\"\n            size={dense ? 'small' : 'medium'}\n            aria-label=\"enhanced table\"\n          >\n            <EnhancedTableHead\n              {...props}\n              classes={classes}\n              order={order}\n              orderBy={orderBy}\n              onRequestSort={handleRequestSort}\n              rowCount={rows.length}\n            />\n            <TableBody>\n              {stableSort(rows, getComparator(order, orderBy))\n                .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)\n                .map((row, index) => {\n                  return (\n                    <TableRow\n                      hover\n                      key={validIdHelper('TableRow-' + index)}\n                      id={validIdHelper('TableRow-' + index)}>\n                      {Object.keys(row).map((key, index) => (\n                        <TableCell\n                          key={validIdHelper(key + '-TableBody-TableCell-' + index)}\n                          id={validIdHelper(key + '-TableBody-TableCell-' + index)}\n                          className={lookerContent[0].fieldType[key] === 'dimension' ? classes.blueSecondary : classes.orangeSecondary}\n                          align=\"right\">\n                          {row[key].rendered ? row[key].rendered : row[key].value}\n                        </TableCell>\n                      ))}\n                    </TableRow>\n                  );\n                })}\n              {emptyRows > 0 && (\n                <TableRow style={{ height: (dense ? 33 : 53) * emptyRows }}>\n                  <TableCell colSpan={6} />\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </TableContainer>\n      </ApiHighlight>\n      <Grid container>\n        <Grid item sm={6}>\n          <FormControlLabel\n            control={<Switch checked={dense} onChange={handleChangeDense} />}\n            label=\"Compact\"\n          /></Grid>\n        <Grid item sm={6}>\n          <TablePagination\n            rowsPerPageOptions={[5, 10, 25, 50]}\n            component=\"div\"\n            count={rows.length}\n            rowsPerPage={rowsPerPage}\n            page={page}\n            onChangePage={handleChangePage}\n            onChangeRowsPerPage={handleChangeRowsPerPage}\n          /></Grid>\n      </Grid>\n      <div className={classes.bottomBarSpacer} />\n    </div>\n  );\n}")}),[I,F]),Object(a.useEffect)((function(){window.addEventListener("resize",(function(){x(window.innerHeight-112),j(window.innerWidth-392)}))}));var D=function(){var e=Object(d.a)(c.a.mark((function e(t,n){var a,o,r,i,u;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=Object(s.a)({},l)).status="running",m(a),o=Date.now(),console.log("timer",o),e.next=7,fetch("/createquerytask/"+JSON.stringify(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 7:return r=e.sent,e.next=10,r.json();case 10:i=e.sent,u=setInterval(Object(d.a)(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/checkquerytask/"+i.queryTaskId,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:"complete"===(n=e.sent).queryResults.status&&(clearInterval(u),m(n.queryResults),f(i.code)),o+3e4<Date.now()&&(clearInterval(),m([]));case 8:case"end":return e.stop()}}),e)}))),5e3);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"".concat(T.root," demoComponent"),style:{height:w}},o.a.createElement(pe.a,{elevation:1,className:"\n      ".concat(T.padding30," \n      ").concat(T.height100Percent,"\n      ").concat(T.overflowYScroll)},o.a.createElement(he.a,{container:!0,key:hn(N)},o.a.createElement("div",{className:"".concat(T.root)},o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(fn,Object.assign({},e,{classes:T,action:D}))),"running"===l.status?o.a.createElement(he.a,{item:!0,sm:12,style:{height:w-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(pe.a,{className:"".concat(T.card," ").concat(T.flexCentered),elevation:0,mt:2,style:{height:w-30-(ue()(".MuiExpansionPanel-root:visible").innerHeight()||0)}},o.a.createElement(ge.a,{className:T.circularProgress}))):l.data&&l.data.length?o.a.createElement(O.a,null,o.a.createElement(he.a,{container:!0,spacing:3,className:"".concat(T.noContainerScroll)},C?o.a.createElement(he.a,{item:!0,sm:6,className:"".concat(T.positionFixedTopRight)},o.a.createElement(we,Object.assign({},e,{classes:T,lookerUser:F,height:w}))):"",o.a.createElement(ae.a,{className:T.divider}),o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(O.a,{className:"".concat(T.w100),mt:2},o.a.createElement(Cn,Object.assign({},e,{classes:T,rows:l.data,lookerContent:I,width:S})))))):o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(ee.a,{variant:"h6",component:"h6",className:"".concat(T.gridTitle," ").concat(T.textCenter)},"No results found, try a new query",o.a.createElement("br",null)))))))}function fn(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.classes,r=e.action,i=e.lookerUser,l=0,c=0,d=function(){return t[0].queryBody.fields.map((function(e,n){return{key:"fieldChipData"+n,label:gn(e.substring(e.lastIndexOf(".")+1,e.length)),datalabel:e,selected:"users.state"===e||"users.country"===e||"order_items.total_sale_price"===e,fieldType:t[0].fieldType[e]}}))},m=Object(a.useState)(!0),u=Object(X.a)(m,2),p=u[0],h=u[1],g=Object(a.useState)(t[0].queryBody?d():""),b=Object(X.a)(g,2),f=b[0],y=b[1],C=Object(a.useState)(!0),k=Object(X.a)(C,2),x=k[0],E=k[1],_=Object(a.useState)(!1),S=Object(X.a)(_,2),j=S[0],O=S[1],T=Object(a.useState)(t[0].queryBody?Object.keys(t[0].queryBody.filters).map((function(e,n){return{key:"filter"+n,label:e,value:t[0].queryBody.filters[e],type:t[0].filterType[e]}})):""),I=Object(X.a)(T,2),N=I[0],F=I[1],D=function(e,t){var n=Object(v.a)(f);n[t].selected=!1===n[t].selected,y(n),E(!0)},H=function(e,t){var n=Object(v.a)(N);n[e].value=t,F(n),E(!0)},P=function(e){if(x||j){var n=f.filter((function(e){return e.selected})).map((function(e){return e.datalabel})),a={};N.map((function(e,t){a[e.label]=e.value}));var o=Object(s.a)({},t[0].queryBody);o.fields=n,o.filters=a,r(o,t[0].resultFormat),E(!1),O(!1)}};Object(a.useEffect)((function(){var e=Object(v.a)(N);e[3].value={basic:"last 182 days",advanced:"last 365 days",premium:"last 730 days"}[i.user_attributes.permission_level]||"182 days",F(e),y(d()),O(!0)}),[i]),Object(a.useEffect)((function(){j&&(P(),E(!1),O(!1))}),[j]);var R={basic:["1 week","1 month","3 months","last 182 days"]};return R.advanced=[].concat(Object(v.a)(R.basic),["last 365 days"]),R.premium=[].concat(Object(v.a)(R.advanced),["last 730 days"]),o.a.createElement(at.a,{expanded:p,onChange:function(e,t){h(!p)},elevation:0},o.a.createElement(ot.a,{expandIcon:o.a.createElement(ct.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(q.a,null),o.a.createElement(ee.a,{className:"".concat(n.heading," ").concat(n.ml12)},"Build Query:")),o.a.createElement(rt.a,null,o.a.createElement(he.a,{container:!0,spacing:3},o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(ee.a,{variant:"subtitle1"},"Select Metrics:",f.length?f.map((function(e,t){return"measure"===e.fieldType?o.a.createElement(Ne.a,{key:e.label,measurecounter:l+=1,className:e.selected?"".concat(n.orangePrimary," ").concat(n.m6):"".concat(n.m6),label:gn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),datalabel:e.label,onClick:function(){return D(0,t)},icon:e.selected?o.a.createElement(cn.a,{className:n.dBlock}):o.a.createElement(cn.a,{className:n.dNone})}):""})):"",o.a.createElement("br",null))),o.a.createElement(he.a,{item:!0,sm:12},o.a.createElement(ee.a,{variant:"subtitle1"},"Group By:",f.length?f.map((function(e,t){return"dimension"===e.fieldType?o.a.createElement(Ne.a,{key:e.label,dimensioncounter:c+=1,className:e.selected?"".concat(n.bluePrimary," ").concat(n.m6):"".concat(n.m6),label:gn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),datalabel:e.label,onClick:function(){return D(0,t)},icon:e.selected?o.a.createElement(cn.a,{className:n.dBlock}):o.a.createElement(cn.a,{className:n.dNone})}):""})):"",o.a.createElement("br",null))),o.a.createElement(he.a,{item:!0,sm:3},o.a.createElement(ee.a,{variant:"subtitle1"},"Filter By:"),N.length?N.map((function(e,t){return o.a.createElement(bt.a,{className:e.value.length?n.formControl:n.hidden,key:hn("".concat(e.label,"FormControl"))},"yesno"===e.type?o.a.createElement(o.a.Fragment,null,o.a.createElement(ft.a,{id:hn("".concat(e.label,"FilterLabel"))},gn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),":"),o.a.createElement(yt.a,{labelId:hn("".concat(e.label,"FilterLabel")),id:hn("".concat(e.label,"FilterSelect")),value:e.value,onChange:function(e){return H(t,e.target.value)}},o.a.createElement(ne.a,{value:"Yes"},"Yes"),o.a.createElement(ne.a,{value:"No"},"No"),o.a.createElement(ne.a,{value:"All"},"All"))):"date"===e.type?o.a.createElement(o.a.Fragment,null,o.a.createElement(ft.a,{id:hn("".concat(e.label,"FilterLabel"))},gn(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),":"),o.a.createElement(yt.a,{labelId:hn("".concat(e.label,"FilterLabel")),id:hn("".concat(e.label,"FilterSelect")),value:e.value||"6 months",onChange:function(e){return H(t,e.target.value)}},i.user_attributes.permission_level?R[i.user_attributes.permission_level].map((function(e){return o.a.createElement(ne.a,{key:hn(e),value:e},w.a.capitalize(e))})):"")):"")})):""),o.a.createElement(he.a,{item:!0,sm:9},o.a.createElement("br",null),o.a.createElement(Ye.a,{color:"primary",variant:"contained",size:"large",onClick:P,disabled:!x},"Run Query")))))}function yn(e){var t=e.classes,n=(e.onSelectAllClick,e.order),a=e.orderBy,r=(e.numSelected,e.rowCount,e.onRequestSort),i=e.rows;return o.a.createElement(Et.a,null,o.a.createElement(_t.a,null,Object.keys(i[0]).map((function(e,i){return o.a.createElement(wt.a,{key:hn(e+"-TableHead-TableCell-"+i),id:hn(e+"-TableHead-TableCell-"+i),align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",sortDirection:a===e&&n},o.a.createElement(on.a,{active:a===e,direction:a===e?n:"asc",onClick:(s=e,function(e){r(e,s)})},gn(e.substring(e.lastIndexOf(".")+1,e.length)),a===e?o.a.createElement("span",{className:t.visuallyHidden},"desc"===n?"sorted descending":"sorted ascending"):null));var s}))))}function Cn(e){var t=e.rows,n=e.classes,a=e.lookerContent,r=e.width,i=o.a.useState("asc"),s=Object(X.a)(i,2),l=s[0],c=s[1],d=o.a.useState(Object.keys(t[0])[0]),m=Object(X.a)(d,2),u=m[0],p=m[1],h=o.a.useState(0),g=Object(X.a)(h,2),b=g[0],f=g[1],y=o.a.useState(!0),C=Object(X.a)(y,2),v=C[0],k=C[1],w=o.a.useState(25),x=Object(X.a)(w,2),E=x[0],_=x[1],S=E-Math.min(E,t.length-b*E);return o.a.createElement("div",{className:"".concat(n.root," ").concat(n.padding10)},o.a.createElement(De,{classes:n},o.a.createElement(xt.a,{style:{maxWidth:r}},o.a.createElement(vt.a,{className:n.table,"aria-labelledby":"tableTitle",size:v?"small":"medium","aria-label":"enhanced table"},o.a.createElement(yn,Object.assign({},e,{classes:n,order:l,orderBy:u,onRequestSort:function(e,t){c(u===t&&"asc"===l?"desc":"asc"),p(t)},rowCount:t.length})),o.a.createElement(kt.a,null,function(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))}(t,function(e,t){return"desc"===e?function(e,n){return un(e,n,t)}:function(e,n){return-un(e,n,t)}}(l,u)).slice(b*E,b*E+E).map((function(e,t){return o.a.createElement(_t.a,{hover:!0,key:hn("TableRow-"+t),id:hn("TableRow-"+t)},Object.keys(e).map((function(t,r){return o.a.createElement(wt.a,{key:hn(t+"-TableBody-TableCell-"+r),id:hn(t+"-TableBody-TableCell-"+r),className:"dimension"===a[0].fieldType[t]?n.blueSecondary:n.orangeSecondary,align:"right"},e[t].rendered?e[t].rendered:e[t].value)})))})),S>0&&o.a.createElement(_t.a,{style:{height:(v?33:53)*S}},o.a.createElement(wt.a,{colSpan:6})))))),o.a.createElement(he.a,{container:!0},o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(rn.a,{control:o.a.createElement(sn.a,{checked:v,onChange:function(e){k(e.target.checked)}}),label:"Compact"})),o.a.createElement(he.a,{item:!0,sm:6},o.a.createElement(ln.a,{rowsPerPageOptions:[5,10,25,50],component:"div",count:t.length,rowsPerPage:E,page:b,onChangePage:function(e,t){f(t)},onChangeRowsPerPage:function(e){_(parseInt(e.target.value,10)),f(0)}}))),o.a.createElement("div",{className:n.bottomBarSpacer}))}var vn=n(1034),kn=n(1037),wn=n(390),xn=n.n(wn),En=n(67),_n=n(48).validIdHelper,Sn=Object(Z.a)((function(e){return{paper:{position:"absolute",width:1e3,height:580,overflow:"scroll",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},card:{display:"flex",flexDirection:"column",justifyContent:"space-between",overflow:"scroll",cursor:"pointer","&:hover":{transform:"scale(1.05)",transition:"transform .2s"}},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},padding15:{padding:15},divider:{marginTop:15,marginBottom:15,color:"#fff"},basic:{},advanced:{},premium:{backgroundColor:"#5F6BD8",color:"#ffffff"},font75:{fontSize:".75em"},font875:{},padding30:{padding:30}}}));function jn(){return{top:"".concat(10,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(10,"%)")}}function On(e){e.props;var t=e.switchLookerUser,n=Object(a.useContext)(ie),r=n.payWallModal,i=n.togglePayWallModal,s=n.lookerUser,l=o.a.useState(jn),c=Object(X.a)(l,1)[0],d=Sn(),m={basic:["6 months of order data history","Atom Merchant Dashboards","Download PDFs, CSVs"],advanced:["Full year of order data history","Drill to row level information","Download row level information","Schedule dashboards for delivery (to you or others)","Set alerts and key threshold notifications"],premium:["2 Full years of order data history","Analyze your own data and save custom reports","View premium level, productivity enhancing reports","Share your reports with colleagues in Atom","Text message alerts"]};return o.a.createElement(Ct.a,{className:"".concat(d.modal," "),open:r.show||!1,onClose:i},o.a.createElement(fe.a,{in:r.show||!1},o.a.createElement("div",{style:c,className:"".concat(d.paper," ").concat(d.padding30)},o.a.createElement(he.a,{container:!0,spacing:3},Object.keys(En).map((function(e){return o.a.createElement(he.a,{item:!0,sm:4,key:_n("monetizationModal-gridItem-".concat(e))},o.a.createElement(pe.a,{className:"".concat(d.card," ").concat(d[e]),elevation:1,style:e===s.user_attributes.permission_level?{transform:"scale(1.05)",transition:"transform .2s",height:495}:{height:495},onClick:function(){t(e,"permission"),i()}},o.a.createElement(vn.a,null,o.a.createElement(ee.a,{variant:"h6"},w.a.capitalize(e)),o.a.createElement(ee.a,{variant:"subtitle1",style:{fontStyle:"italic"}},"basic"===e?"Drive your business with clear KPIs":"advanced"===e?"Deeper insights, operations":"Drive your business with Atom"),o.a.createElement(ae.a,{className:"".concat(d.divider," ")}),o.a.createElement(D.a,{className:d.root},m[e].map((function(t,n){return o.a.createElement(H.a,{dense:!0,className:d.font875,key:"monetizationModal-ListItem-".concat(e,"-").concat(n)},o.a.createElement(R.a,null,o.a.createElement(xn.a,{fontSize:"small"})),o.a.createElement(P.a,{primary:t}))})))),o.a.createElement(kn.a,{disableSpacing:!1},o.a.createElement(Ye.a,{color:"primary",variant:"outlined",disabled:e===s.user_attributes.permission_level,fullWidth:!0,onClick:function(){t(e,"permission"),i()}},Object.keys(m).indexOf(s.user_attributes.permission_level)<Object.keys(m).indexOf(e)?"Upgrade":"Switch"))))}))))))}var Tn=n(48).validIdHelper,In=Object(Q.a)({}),Nn=Object(Q.a)({palette:{primary:{main:J.a[900]},secondary:{main:J.a[400]}}}),Fn=Object(Q.a)({palette:{primary:{main:Y.a[500]}}}),Dn=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).togglePayWallModal=function(e){a.setState({payWallModal:Object(s.a)({},e)})},a.toggleHighlightShow=function(){a.state.codeShow&&a.toggleCodeShow(),a.setState({highlightShow:!a.state.highlightShow})},a.toggleCodeShow=function(){a.state.highlightShow&&a.toggleHighlightShow(),a.setState({codeShow:!a.state.codeShow})},a.handleTabChange=function(e){a.setState({activeTabValue:e})},a.handleDrawerChange=function(e){a.setState({drawerOpen:e})},a.handleMenuItemSelect=function(e,t){a.handleTabChange(0),a.state.highlightShow&&a.toggleHighlightShow(),a.state.codeShow&&a.toggleCodeShow();var n="";t?de[a.state.activeUsecase].demoComponents.map((function(t){"splash page"!==t.type&&t.lookerContent.map((function(a){a.id===e&&(n=Tn(t.type+a.id))}))})):n=e;var o=Object(v.a)(a.state.renderedDemoComponents);-1==o.indexOf(n)&&o.unshift(n),a.setState((function(e){return{selectedMenuItem:n,renderedDemoComponents:Object(v.a)(o)}}))},a.handleUserMenuSwitch=function(){var e=Object(d.a)(c.a.mark((function e(t,n){var o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=Object(s.a)({},a.props.lookerUser),"brand"===n?o.user_attributes.brand=t:"permission"===n&&(o.permissions=En[t]||En.basic,o.user_attributes.permission_level=t,o.user_attributes.time_horizon=Wn[t]),e.next=4,fetch("/updatelookeruser",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o)});case 4:e.sent,a.setState({renderedDemoComponents:[a.state.selectedMenuItem]},(function(){"brand"===n?a.props.switchUserAttributeBrand(t):"permission"===n&&a.props.switchLookerUser(t)}));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a.state={drawerOpen:window.innerWidth>768,drawerTabValue:0,activeTabValue:0,activeUsecase:"",appLayout:"",highlightShow:!1,payWallModal:{},selectedMenuItem:"",renderedDemoComponents:[],codeShow:!1},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(e){var t=this,n=(this.props||"atom").usecaseFromUrl;this.setState({activeUsecase:n,appLayout:de[n].layout||"left-sidebar"},(function(){ce.LookerEmbedSDK.init("https://".concat(t.props.lookerHost,".looker.com"),"/auth")})),window.addEventListener("resize",(function(){t.setState({drawerOpen:window.innerWidth>768})}))}},{key:"componentDidUpdate",value:function(e){var t=e.lookerUser.user_attributes.permission_level,n=this.props.lookerUser.user_attributes.permission_level,a=e.lookerUser.user_attributes.brand,o=this.props.lookerUser.user_attributes.brand;t===n&&a===o||(ce.LookerEmbedSDK.init("https://".concat(this.props.lookerHost,".looker.com"),"/auth"),this.setState({renderedDemoComponents:[this.state.selectedMenuItem]}))}},{key:"render",value:function(){var e={splashpage19:nt,simpledashboard5:ht,simpledashboard9:ht,customfilter1:ht,customvis:$t,querybuilderexplorelite:bn,reportbuilder14:nn},t={atom:Nn,vidly:Fn},n=this.state,a=(n.drawerTabValue,n.drawerOpen),r=n.activeTabValue,i=n.activeUsecase,s=n.selectedMenuItem,l=n.renderedDemoComponents,c=this.handleTabChange,d=this.handleMenuItemSelect,m=this.handleDrawerChange,u=this.props,p=u.classes,h=(u.activeCustomization,u.lookerUser),g=u.applySession,b=u.lookerUserAttributeBrandOptions,f=u.lookerHost,y=u.userProfile,k=i?w.a.orderBy(de[i].demoComponents,["menuCategory"],["asc"]):[],E={},T=[],I=0;if(k.map((function(e,t){E.hasOwnProperty(e.menuCategory)?E[e.menuCategory]=[].concat(Object(v.a)(E[e.menuCategory]),[e]):(E[e.menuCategory]=[e],I+=1,T.push(""+(t+I)))})),i&&!s.length){var N=de[i].demoComponents[0].lookerContent[0].id?Tn(de[i].demoComponents[0].type+de[i].demoComponents[0].lookerContent[0].id):Tn(de[i].demoComponents[0].type);this.setState({selectedMenuItem:N,renderedDemoComponents:[N]},(function(){}))}return o.a.createElement("div",{className:p.root},o.a.createElement(ie.Provider,{value:{show:this.state.highlightShow,toggleShow:this.toggleHighlightShow,payWallModal:this.state.payWallModal,togglePayWallModal:this.togglePayWallModal,lookerUser:h,userProfile:y,codeShow:this.state.codeShow,toggleCodeShow:this.toggleCodeShow}},o.a.createElement(K.a,{theme:i?t[i]:In},o.a.createElement(_.a,null),o.a.createElement(Pn,Object.assign({},this.props,{classes:p,activeUsecase:i,lookerUser:h,applySession:g,lookerUserAttributeBrandOptions:b,handleUserMenuSwitch:this.handleUserMenuSwitch,handleDrawerChange:this.handleDrawerChange,drawerOpen:a})),o.a.createElement(S.a,{className:p.drawer,variant:"persistent",anchor:"left",open:a,classes:{paper:p.drawerPaper}},o.a.createElement("div",{className:p.drawerHeader},o.a.createElement(j.a,{onClick:function(){return m(!1)}},o.a.createElement(A.a,null))),Object.keys(E).length?o.a.createElement(Rn,Object.assign({},this.props,{classes:p,activeUsecase:i,orderedDemoComponentsForMenuObj:E,selectedMenuItem:s,handleMenuItemSelect:d})):"",o.a.createElement(On,{switchLookerUser:this.handleUserMenuSwitch}),o.a.createElement(et,{classes:p,lookerUser:h})),o.a.createElement("main",{className:Object(x.a)(p.content,Object(C.a)({},p.contentShift,a))},o.a.createElement("div",{className:p.drawerHeader}),i?de[i].demoComponents.map((function(t,n){var a=t.lookerContent[0].id?Tn(t.type+t.lookerContent[0].id):Tn(t.type),m=e[a];return o.a.createElement(o.a.Fragment,{key:Tn("outerFragment-".concat(t.type,"-").concat(n))},l.indexOf(a)>-1?o.a.createElement(O.a,{key:Tn("box-".concat(t.type,"-").concat(n)),className:a===s?"":"".concat(p.hide)},o.a.createElement(m,{key:Tn("demoComponent-".concat(t.type,"-").concat(n)),staticContent:t,handleMenuItemSelect:d,activeTabValue:r,handleTabChange:c,lookerUser:h,activeUsecase:i,lookerHost:f,userProfile:y})):"")})):""))))}}]),n}(a.Component),Hn=Object(E.a)((function(e){return{root:{display:"flex",backgroundColor:"rgb(229, 229, 229)"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),zIndex:1201,backgroundColor:"#343D4E"},appBarShift:{width:"calc(100% - ".concat(240,"px)"),marginLeft:240,transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0,borderRight:"none",backgroundColor:"transparent"},drawerPaper:{width:240,borderRight:"none",backgroundColor:"transparent"},drawerHeader:Object(s.a)(Object(s.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},title:{flexGrow:1},tabs:{borderRight:"1px solid ".concat(e.palette.divider)},dNone:{display:"none"},dBlock:{display:"block"},relative:{position:"relative"},absolute:{position:"absolute"},right0:{right:0},top0:{top:0},right24:{right:24},top24:{top:24},ml12:{marginLeft:12},mr12:{marginRight:12},mt12:{marginTop:12},highlightLegend:{position:"fixed",bottom:e.spacing(2),left:e.spacing(2),zIndex:1200},tree:{height:240,flexGrow:1,maxWidth:400},parentHoverVisibility:{"&:hover $childHoverVisibility":{visibility:"visible"}},childHoverVisibility:{visibility:"hidden"},fontSize1em:{fontSize:"1em"},padding10:{padding:10},mt5:{marginTop:5},mb5:{marginBottom:5},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},list:{width:"100%",maxWidth:360,backgroundColor:"transparent"},nested:{paddingLeft:e.spacing(4)},mlAuto:{marginLeft:"auto"},mrAuto:{marginRight:"auto"},appBarBottom:{top:"auto",bottom:0},hidden:{visibility:"hidden"},roundedTab:{borderRadius:"0 100px 100px 0"},paddingBottom30:{paddingBottom:30},mtAuto:{marginTop:"auto"},mb10:{marginBottom:10}}}))(Dn);function Pn(e){var t=e.classes,a=e.activeUsecase,r=e.lookerUser,i=e.applySession,s=e.lookerUserAttributeBrandOptions,l=e.handleUserMenuSwitch,c=e.drawerOpen,d=e.handleDrawerChange;return o.a.createElement(T.a,{position:"fixed",className:Object(x.a)(t.appBar)},o.a.createElement(I.a,null,o.a.createElement(j.a,{color:"inherit","aria-label":"open drawer",onClick:function(){return d(!c)},edge:"start"},c?o.a.createElement(A.a,null):o.a.createElement(B.a,null)),a?o.a.createElement(N.a,{alt:"Icon",src:n(880)("./".concat(a,".svg")),variant:"square"}):"",o.a.createElement(F.a,{badgeContent:3,color:"error",className:"".concat(t.mlAuto," ").concat(t.mr12," ")},o.a.createElement(L.a,null)),o.a.createElement(le,{lookerUser:r,onLogoutSuccess:i,lookerUserAttributeBrandOptions:s,handleUserMenuSwitch:l})))}function Rn(e){var t=e.classes,n=e.activeUsecase,a=e.orderedDemoComponentsForMenuObj,r=e.selectedMenuItem,i=e.handleMenuItemSelect,s=(e.lookerUser,e.show,e.toggleShow,e.codeShow,e.toggleCodeShow,{splashpage19:W.a,simpledashboard5:U.a,simpledashboard9:$.a,customfilter1:M.a,customvis:G.a,querybuilderexplorelite:q.a,reportbuilder14:z.a});return o.a.createElement(D.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:t.list},n?Object.keys(a).map((function(e,n){return o.a.createElement(o.a.Fragment,{key:"".concat(Tn(e+"-menuList-"+n))},o.a.createElement(H.a,{key:"".concat(Tn(e+"-outerListItem-"+n))},o.a.createElement(P.a,{primary:"home"===e?"":w.a.capitalize(e)})),o.a.createElement(D.a,{component:"div",disablePadding:!0,key:"".concat(Tn(e+"-innerList-"+n))},a[e].map((function(n,a){var l=n.lookerContent[0].id?Tn(n.type+n.lookerContent[0].id):Tn(n.type),c=s[l];return o.a.createElement(H.a,{button:!0,className:"".concat(t.nested," ").concat(t.roundedTab),key:"".concat(Tn(e+"-innerListItem-"+a)),onClick:function(){return i(Tn(n.lookerContent[0].id?n.type+n.lookerContent[0].id:n.type))},selected:Tn(n.lookerContent[0].id?n.type+n.lookerContent[0].id:n.type)===r},o.a.createElement(R.a,null,o.a.createElement(c,null)),o.a.createElement(P.a,{primary:w.a.capitalize(n.label)}))}))))})):"")}var An=n(48).validIdHelper,Bn=J.a[200],Ln=Object(Z.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},card:{minWidth:350,minHeight:500,left:"75%",top:"50%",transform:"translate(-75%, -50%)",position:"absolute",textAlign:"center",backgroundColor:Bn},h100:{height:"100%"},title:{fontSize:14},pos:{marginBottom:12},actions:{alignItems:"center",justifyContent:"center"},cardCopy:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",width:"80%"}}}));function Un(e){var t=e.googleClientId,a=e.onSuccess,r=(e.onFailure,e.usecaseFromUrl),i=Ln(),s=Math.floor(4*Math.random())+1,l=n(883)("./".concat(r,"_background").concat(s,".jpg")),c=n(888)("./".concat(r,"_logo_black.svg"));return o.a.createElement("div",{className:"".concat(i.root," demoComponent ").concat(i.h100)},o.a.createElement(he.a,{container:!0,key:An("sign in page"),className:"".concat(i.h100)},o.a.createElement(he.a,{item:!0,sm:12,className:"sign-in-background-img",style:{backgroundImage:"url(".concat(l,")"),backgroundSize:"cover"}},o.a.createElement(pe.a,{className:i.card},o.a.createElement("div",{className:i.cardCopy},o.a.createElement("img",{src:c}),o.a.createElement(vn.a,null,o.a.createElement(ee.a,{variant:"h5",component:"h2"},"Welcome"),o.a.createElement(ee.a,{variant:"body2",component:"p"},"Please sign in to access ",o.a.createElement("br",null)," your merchant portal")),o.a.createElement(kn.a,{className:"".concat(i.actions)},o.a.createElement(y.GoogleLogin,{clientId:t,buttonText:"Login",onSuccess:a,onFailure:a,cookiePolicy:"single_host_origin"})))))))}var $n=n(117),Mn=n(392),Gn=n.n(Mn),qn=(o.a.Component,n(60));o.a.Component;var zn=n(272),Vn=n(394),Wn={basic:"last 182 days",advanced:"last 365 days",premium:"last 730 days"},Qn=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).responseGoogle=function(e){e.error?console.log("response.error",e.error):a.props.applySession(e.profileObj)},a}return Object(p.a)(n,[{key:"render",value:function(){var e=(this.props.location.state||{from:{pathname:"/analytics"}}).from,t=(this.props.location.pathname,this.props.activeCustomization,this.props.userProfile),n="".concat("610722499102-hqo4cena1n453n11mqk88jj5arv4p3ft",".apps.googleusercontent.com");return Object.keys(t).length?o.a.createElement("div",{className:"App"},o.a.createElement(b.a,{to:e})):o.a.createElement(Un,{googleClientId:n,onSuccess:this.responseGoogle,onFailure:this.responseGoogle,usecaseFromUrl:Yn()})}}]),n}(o.a.Component),Kn=function(e){var t=e.component,n=e.customizations,a=e.activeCustomization,r=e.applyCustomization,i=e.editCustomization,s=e.indexOfCustomizationToEdit,l=e.saveCustomization,c=e.cancelIndexOfCustomizationToEdit,d=e.lookerContent,u=e.saveLookerContent,p=e.userProfile,h=e.lookerUser,g=e.lookerHost,f=e.switchLookerUser,y=e.applySession,C=e.lookerUserAttributeBrandOptions,v=e.switchUserAttributeBrand,k=e.usecaseFromUrl,w=Object(m.a)(e,["component","customizations","activeCustomization","applyCustomization","editCustomization","indexOfCustomizationToEdit","saveCustomization","cancelIndexOfCustomizationToEdit","lookerContent","saveLookerContent","userProfile","lookerUser","lookerHost","switchLookerUser","applySession","lookerUserAttributeBrandOptions","switchUserAttributeBrand","usecaseFromUrl"]);return o.a.createElement(b.b,Object.assign({},w,{render:function(e){return Object.keys(p).length?o.a.createElement(t,Object.assign({},e,{customizations:n,activeCustomization:a,applyCustomization:r,editCustomization:i,indexOfCustomizationToEdit:s,saveCustomization:l,cancelIndexOfCustomizationToEdit:c,lookerContent:d,saveLookerContent:u,userProfile:p,lookerUser:h,lookerHost:g,switchLookerUser:f,applySession:y,lookerUserAttributeBrandOptions:C,switchUserAttributeBrand:v,usecaseFromUrl:k})):o.a.createElement(b.a,{to:{pathname:"/",state:{from:e.location}}})}}))},Jn=function(e){Object(h.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).logoutTimer=function(){var e=setInterval(Object(d.a)(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=Date.now(),348e4,n>a.state.tokenLastRefreshed+348e4&&(a.applySession({}),clearInterval(e));case 3:case"end":return t.stop()}}),t)}))),1e3)},a.checkSession=Object(d.a)(c.a.mark((function e(){var t,n,o,r,i,l,d;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/readsession",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o=n.session.userProfile,r=n.session.customizations,i=n.session.activeCustomization?n.session.activeCustomization:0,l=n.session.lookerUser?n.session.lookerUser:a.state.lookerUser,d=n.session.lookerHost?n.session.lookerHost:a.state.lookerHost,o&&Object.keys(o).length&&a.setState((function(e){return{userProfile:o,customizations:r,lookerUser:Object(s.a)(Object(s.a)({},e.lookerUser),{},{external_user_id:o.email,first_name:o.givenName,last_name:o.familyName,permissions:En[l.user_attributes.permission_level]||En.basic,user_attributes:Object(s.a)({},l.user_attributes||{locale:"en_US",country:"USA",brand:"Calvin Klein",permission_level:"basic"})}),lookerHost:d,tokenLastRefreshed:n.session.mongoInfo.api_token_last_refreshed||Date.now()}}),(function(){a.applyCustomization(i),a.logoutTimer()}));case 12:case"end":return e.stop()}}),e)}))),a.applySession=function(){var e=Object(d.a)(c.a.mark((function e(t){var n,o,r,i,l;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(t).length){e.next=7;break}return e.next=3,fetch("/endsession",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}});case 3:e.sent,a.setState({userProfile:{},lookerUser:Object(s.a)({},zn)}),e.next=17;break;case 7:return e.next=9,fetch("/writesession",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userProfile:t,lookerUser:a.state.lookerUser})});case 9:return n=e.sent,e.next=12,n.json();case 12:o=e.sent,r=o.session.customizations,i=o.session.lookerUser?o.session.lookerUser:a.state.lookerUser,l=o.session.lookerHost?o.session.lookerHost:a.state.lookerHost,a.setState((function(e){return{userProfile:t,customizations:r,lookerUser:Object(s.a)(Object(s.a)({},e.lookerUser),{},{external_user_id:t.email,first_name:t.givenName,last_name:t.familyName,permissions:En[i.user_attributes.permission_level]||En.basic,user_attributes:Object(s.a)({},i.user_attributes||{locale:"en_US",country:"USA",brand:"Calvin Klein",time_horizon:"last 6 months",permission_level:"basic"})}),lookerHost:l,tokenLastRefreshed:o.session.mongoInfo.api_token_last_refreshed||Date.now()}}),(function(){a.applyCustomization(0),a.logoutTimer()}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.applyCustomization=function(){var e=Object(d.a)(c.a.mark((function e(t){var n,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/applyactivecustomziation",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({customizationIndex:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:e.sent,o=[],a.state.customizations[t].industry,a.state.customizations[t].lookerContent,a.setState({activeCustomization:a.state.customizations[t],lookerContent:o},(function(){}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.editCustomization=function(e){var t="undefined"===typeof a.state.customizations[e]?null:e;a.setState({indexOfCustomizationToEdit:t},(function(){}))},a.saveCustomization=function(){var e=Object(d.a)(c.a.mark((function e(t){var n,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/savecustomization",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:o=e.sent,a.setState({customizations:o.customizations},(function(){a.applyCustomization(t.customizationIndex)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.cancelIndexOfCustomizationToEdit=function(){a.setState({indexOfCustomizationToEdit:null})},a.saveLookerContent=function(){var e=Object(d.a)(c.a.mark((function e(t){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.switchLookerUser=function(e){var t=Object(s.a)(Object(s.a)({},a.state.lookerUser.user_attributes),{},{permission_level:e});t.time_horizon=Wn[e],a.setState((function(n){return{lookerUser:Object(s.a)(Object(s.a)({},n.lookerUser),{},{permissions:En[e],user_attributes:t})}}),Object(d.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/updatelookeruser",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a.state.lookerUser)});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)}))))},a.switchUserAttributeBrand=function(e){var t=Object(s.a)({},a.state.lookerUser.user_attributes);t.brand=e;var n=Yn();a.setState((function(a){return{lookerUser:Object(s.a)(Object(s.a)({},a.lookerUser),{},{user_attributes:t,group_ids:[de[n].groupIds[e.replace("'","")]]})}}),Object(d.a)(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/updatelookeruser",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a.state.lookerUser)});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)}))))},a.state={userProfile:{},customizations:[],activeCustomization:{},indexOfCustomizationToEdit:null,lookerUser:Object(s.a)({},zn),lookerHost:"",activeUsecase:"",tokenLastRefreshed:""},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.checkSession()}},{key:"render",value:function(){var e=this,t=this.state,n=t.userProfile,a=(t.customizations,t.activeCustomization),r=(t.indexOfCustomizationToEdit,t.lookerContent),i=t.lookerUser,s=t.lookerHost,l=Yn();return o.a.createElement(f.a,null,o.a.createElement("div",null,o.a.createElement(b.b,{path:"",render:function(t){return o.a.createElement(Qn,Object.assign({},t,{applySession:e.applySession,userProfile:n,activeCustomization:a,lookerUser:i,switchLookerUser:e.switchLookerUser,lookerHost:s}))}}),o.a.createElement(Kn,{path:"/analytics",component:Hn,activeCustomization:a,lookerContent:r,saveLookerContent:this.saveLookerContent,userProfile:n,lookerUser:i,applySession:this.applySession,lookerHost:s,switchLookerUser:this.switchLookerUser,lookerUserAttributeBrandOptions:Vn,switchUserAttributeBrand:this.switchUserAttributeBrand,usecaseFromUrl:l})))}}]),n}(o.a.Component);function Yn(){for(var e=Object.keys(de),t=window.location.href,n=0;n<e.length;n++)if(t.indexOf(e[n])>-1)return e[n];return"atom"}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(Jn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[430,1,2]]]);
//# sourceMappingURL=main.e5f4737e.chunk.js.map