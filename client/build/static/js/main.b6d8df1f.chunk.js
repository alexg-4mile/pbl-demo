(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{103:function(e){e.exports=JSON.parse('{"basic":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit"],"advanced":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit","schedule_look_emails","schedule_external_look_emails","create_alerts","see_drill_overlay"],"premium":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit","schedule_look_emails","schedule_external_look_emails","create_alerts","see_drill_overlay","save_content","embed_browse_spaces","schedule_look_emails","send_to_sftp","send_to_s3","send_outgoing_webhook","see_sql","send_to_integration","download_without_limit","explore"]}')},257:function(e,t,n){e.exports=n.p+"static/media/atom_splash_blog.89cd1730.jpg"},258:function(e,t,n){e.exports=n.p+"static/media/atom_splash_inventory.5ac8518d.jpg"},259:function(e,t,n){e.exports=n.p+"static/media/atom_splash_trends.3591acf3.jpg"},260:function(e,t,n){},276:function(e){e.exports=JSON.parse('{"external_user_id":"","first_name":"","last_name":"","session_length":86400,"force_logout_login":true,"external_group_id":"","group_ids":[4],"permissions":["access_data","see_looks","see_user_dashboards","see_lookml_dashboards","download_with_limit"],"models":["atom_fashion"],"user_attributes":{"locale":"en_US","country":"USA","brand":"Calvin Klein","time_horizon":"last 182 days","permission_level":"basic"}}')},394:function(e){e.exports=JSON.parse('[{"label":"Columbia"},{"label":"Calvin Klein"},{"label":"Carhartt"},{"label":"Levi\'s"},{"label":"Dockers"}]')},430:function(e,t,n){e.exports=n(890)},435:function(e,t,n){},437:function(e,t,n){},46:function(e,t){e.exports={makeid:function(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",a=n.length,o=0;o<e;o++)t+=n.charAt(Math.floor(Math.random()*a));return t},validIdHelper:function(e){return e.replace(/[^a-zA-Z0-9-.#]/g,"")},prettifyString:function(e){var t,n=e.split("_");for(t=0;t<n.length;t++)n[t]=n[t].charAt(0).toUpperCase()+n[t].slice(1);return n.join(" ")},getUrlVars:function(e){for(var t,n={},a=e.slice(e.indexOf("?")+1).split("&"),o=0;o<a.length;o++)n[(t=a[o].split("="))[0]]=t[1];return n},decodeHtml:function(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}}},57:function(e){e.exports=JSON.parse('{"atom":{"label":"Atom Fashion","vignette":{"name":"Atom","logo_url":"../images/atom_logo.png"},"layout":"right-appbar","demoComponents":[{"type":"splash page","label":"Home","description":"We\'re thrilled to have you on Atom Fashion - the premiere third party fashion marketplace for today\'s leading brands. Throughout this portal you will find a series of analytic content designed to help you maximize your performance.","icon":"fa-home","menuCategory":"home","lookerContent":[{"id":"19","gridWidth":6,"height":225,"type":"welcome","inlineQueries":[{"model":"atom_fashion","view":"order_items","fields":["order_items.total_sale_price","order_items.created_week","products.category"],"pivots":["order_items.created_week"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"2 weeks ago for 2 weeks"},"filter_expression":null,"sorts":["order_items.total_sale_price desc 1","order_items.created_week 0"],"limit":"1","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(pivot_index(${order_items.total_sale_price},2)-pivot_index(${order_items.total_sale_price},1))/pivot_index(${order_items.total_sale_price},1\\\\n  )\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"supermeasure\\",\\"_type_hint\\":\\"number\\"}]"},{"model":"atom_fashion","view":"order_items","fields":["order_items.total_sale_price","order_items.created_week","products.category"],"pivots":["order_items.created_week"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"2 weeks ago for 2 weeks"},"filter_expression":null,"sorts":["order_items.total_sale_price 1","order_items.created_week 0"],"limit":"1","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(pivot_index(${order_items.total_sale_price},2)-pivot_index(${order_items.total_sale_price},1))/pivot_index(${order_items.total_sale_price},1\\\\n  )\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"supermeasure\\",\\"_type_hint\\":\\"number\\"}]"}],"inlineQueriesMap":["best","worst"],"resultFormat":"json"},{"id":"17","gridWidth":6,"height":225,"type":"carousel"},{"id":"18","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_week","order_items.total_gross_margin"],"fill_fields":["order_items.created_week"],"filters":{"order_items.created_date":"12 weeks ago for 12 weeks"},"sorts":["order_items.created_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"Week over Week %25 Change\\",\\"expression\\":\\"(${order_items.total_gross_margin}-offset(${order_items.total_gross_margin},1))/offset(${order_items.total_gross_margin},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Revenue by Week","visColor":"#4595EC"},{"id":"20","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","events.sessions_count"],"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${events.sessions_count}-offset(${events.sessions_count},1))/offset(${events.sessions_count},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Visits by Week","visColor":"#F3A759"},{"id":"21","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","events.bounce_rate"],"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"filter_expression":null,"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${events.bounce_rate}-offset(${events.bounce_rate},1))/offset(${events.bounce_rate},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Bounce Rate by Week","visColor":"#E24E3A"},{"id":"22","gridWidth":3,"type":"single value","height":150,"inlineQuery":{"model":"atom_fashion","view":"web_events","fields":["events.event_week","sessions.average_duration"],"pivots":null,"fill_fields":["events.event_week"],"filters":{"events.event_date":"12 weeks ago for 12 weeks"},"filter_expression":null,"sorts":["events.event_week desc"],"limit":"500","dynamic_fields":"[{\\"table_calculation\\":\\"change\\",\\"label\\":\\"%25 Change\\",\\"expression\\":\\"(${sessions.average_duration}-offset(${sessions.average_duration},1))/offset(${sessions.average_duration},1)\\",\\"value_format\\":null,\\"value_format_name\\":\\"percent_2\\",\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"}]"},"resultFormat":"json","label":"Average Time on Site by Week","visColor":"#65AB5A"},{"gridWidth":8,"height":400,"type":"dashboard","id":"12","slug":"3ytMWYFKKbofCDFkpAG46z"},{"gridWidth":4,"height":400,"type":"popular analysis","vectors":[{"id":"9","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Analytics","gridWidth":"4"},{"id":"5","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Sales","gridWidth":"4"},{"id":"1","type":"thumbnail","resourceType":"dashboard","lookerMethod":"vector_thumbnail","label":"Inventory","gridWidth":"4"}],"label":"Popular analysis"}]},{"type":"simple dashboard","label":"Web Analytics","menuCategory":"marketing","description":"Overview of all your web traffic","icon":"fa-chart-line","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"9","label":"Web Analytics","isNext":false,"theme":"atom_fashion_filters"}]},{"type":"simple dashboard","label":"Sales Overview","menuCategory":"sales","description":"Overview of all your sales!","icon":"fa-tachometer-alt","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"5","label":"Sales Overview","isNext":true,"filters":[{"label":"Select Category","filterName":"Category","lookerMethod":"runInlineQuery"},{"label":"Select region","filterName":"State Region","lookerMethod":"runInlineQuery"}],"inlineQueries":[{"model":"atom_fashion","view":"order_items","fields":["this_period","last_period","products.category"],"filters":{"order_items.created_date":"60 days ago for 60 days","order_items.count":">5"},"sorts":["products.category"],"limit":500,"dynamic_fields":"[{\\"table_calculation\\":\\"trend\\",\\"label\\":\\"trend\\",\\"expression\\":\\"${this_period} / ${last_period} - 1\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\"},{\\"measure\\":\\"this_period\\",\\"based_on\\":\\"order_items.total_sale_price\\",\\"type\\":\\"count_distinct\\",\\"label\\":\\"This Period\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\",\\"filter_expression\\":\\"matches_filter(${order_items.created_date},`30 days ago for 30 days`)\\"},{\\"measure\\":\\"last_period\\",\\"based_on\\":\\"order_items.total_gross_margin\\",\\"label\\":\\"Last Period\\",\\"value_format\\":null,\\"value_format_name\\":null,\\"_kind_hint\\":\\"measure\\",\\"_type_hint\\":\\"number\\",\\"filter_expression\\":\\"matches_filter(${order_items.created_date},`60 days ago for 30 days`)\\"}]","theme":"atom_fashion"},{"model":"atom_fashion","view":"order_items","fields":["users.state_region"],"limit":"500"}],"desiredFilterName":["products.brand","users.state_region"],"filterComponents":["autocomplete","togglebutton"]}]},{"type":"custom filter","label":"Inventory Overview","menuCategory":"operations","description":"Overview of your inventory","icon":"fa-tshirt","lookerContent":[{"type":"dashboard","lookerMethod":"embedDashboard","id":"1","isNext":false,"label":"Inventory Overview","filters":[{"label":"Select Product Name","filterName":"Product Name","lookerMethod":"runInlineQuery"}],"inlineQueries":[{"model":"atom_fashion","view":"order_items","fields":["products.item_name"],"query_timezone":"America/Los_Angeles"}],"desiredFilterNames":["products.brand"],"filterComponents":["autocomplete"],"dynamicFieldLookUp":{"Inventory":[118,124,123,122,121],"Orders":[6,7,8,2,127]},"theme":"atom_fashion"}]},{"type":"custom vis","label":"Sales Calendar","menuCategory":"sales","description":"Ayeeeeeee","icon":"fa-calendar","lookerContent":[{"type":"custom vis","lookerMethod":"runInlineQuery","label":"Sales Calendar","inlineQuery":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_date","products.category","order_items.order_count","order_items.total_sale_price"],"query_timezone":"America/Los_Angeles","limit":"-1"},"desiredFilterName":"products.brand","desiredFields":["order_items.order_count","order_items.total_sale_price"],"resultFormat":"json"}]},{"type":"report builder","label":"Saved Reports","menuCategory":"operations","description":"Give users the ability to explore existing reports as well as create new ones all from within your application","icon":"fa-sticky-note","lookerContent":[{"type":"folder","id":"14","label":"Saved Reports"},{"type":"explore","id":"atom_fashion::order_items","label":"Create New Report"}]},{"type":"query builder","label":"Query Builder","menuCategory":"operations","description":"Enable business users to self serve on data and answer their own questions","icon":"fa-search","lookerContent":[{"type":"explorelite","id":"explorelite","label":"Build & Run Queries","queryBody":{"model":"atom_fashion","view":"order_items","fields":["order_items.created_month","order_items.created_date","order_items.created_week","users.city","users.state","users.country","products.category_type","products.category","products.brand","order_items.total_sale_price","order_items.total_tax_amount"],"filters":{"users.state":"","users.city":"","users.country":"","order_items.created_date":"6 months"},"limit":500},"resultFormat":"json","fieldType":{"order_items.created_month":"dimension","order_items.created_date":"dimension","order_items.created_week":"dimension","users.city":"dimension","users.state":"dimension","users.country":"dimension","products.category_type":"dimension","products.category":"dimension","products.brand":"dimension","order_items.total_sale_price":"measure","order_items.total_tax_amount":"measure"},"filterType":{"users.state":"string","users.city":"string","users.country":"string","order_items.created_date":"date"}}]}],"groupIds":{"Calvin Klein":4,"Carhartt":5,"Columbia":6,"Levi\u2019s":7,"Dockers":8}},"vidly":{"label":"Vidly Media","vignette":{"name":"Vidly","logo":""},"layout":"right-appbar","demoComponents":[]}}')},880:function(e,t,n){var a={"./atom_logo_white.svg":881};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=880},881:function(e,t,n){e.exports=n.p+"static/media/atom_logo_white.89cfe3df.svg"},882:function(e,t,n){var a={"./atom_background1.jpg":883,"./atom_background2.jpg":884,"./atom_background3.jpg":885,"./atom_background4.jpg":886,"./atom_splash_blog.jpg":257,"./atom_splash_inventory.jpg":258,"./atom_splash_trends.jpg":259};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=882},883:function(e,t,n){e.exports=n.p+"static/media/atom_background1.9ed7593f.jpg"},884:function(e,t,n){e.exports=n.p+"static/media/atom_background2.c5efc290.jpg"},885:function(e,t,n){e.exports=n.p+"static/media/atom_background3.b9aecb61.jpg"},886:function(e,t,n){e.exports=n.p+"static/media/atom_background4.1acd6c1b.jpg"},887:function(e,t,n){var a={"./atom_logo_black.svg":888};function o(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=887},888:function(e,t,n){e.exports=n.p+"static/media/atom_logo_black.a213ea2a.svg"},890:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(23),i=n.n(r),s=(n(435),n(12)),l=n.n(s),c=n(20),d=n(30),m=n(53),u=n(37),p=n(35),h=n(87),b=n(86),g=(n(437),n(101)),f=n(132),y=n(261),C=n(42),k=n(36),v=n(40),x=n.n(v),E=n(3),w=n(5),_=n(1034),S=n(1061),j=n(1044),T=n(1010),O=n(1011),I=n(1051),N=n(1035),D=n(955),F=n(893),H=n(1031),P=n(1030),R=n(1036),A=n(1037),B=n(1038),U=n(1039),L=n(1040),$=n(1041),M=n(1042),G=n(391),q=n.n(G),V=n(395),z=n(1033),W=n(207),Q=n(210),K=n(8),J=n(951),Y=n(892),X=n(137),Z=n(397),ee=n(956),te=n(957),ne=n(1054),ae=n(1045),oe=o.a.createContext(null),re=(n(46).validIdHelper,Object(J.a)((function(e){return{zIndex1500:{zIndex:1500},mr12:{marginRight:12}}})));function ie(e){var t=e.lookerUser,n=e.switchLookerUser,r=e.onLogoutSuccess,i=e.lookerUserAttributeBrandOptions,s=e.switchUserAttributeBrand,l=re(),c=Object(a.useContext)(oe),d=c.togglePayWallModal,m=(c.codeShow,c.toggleShow,c.userProfile),u=o.a.useState(null),p=Object(K.a)(u,2),h=p[0],b=p[1],g=o.a.useState(t.user_attributes.brand||""),f=Object(K.a)(g,2),y=f[0],C=f[1],k=function(e){b(null),null==e?r({}):"basic"===e||"advanced"===e||"premium"===e?n(e):"modal"===e?d({show:!0,permissionNeeded:"explore"}):"string"===typeof e&&(s(e),C(e))};return o.a.createElement("div",{className:"".concat(l.zIndex1500)},o.a.createElement(Y.a,{"aria-label":"account of current user","aria-controls":"menu-appbar","aria-haspopup":"true",onClick:function(e){b(e.currentTarget)},color:"inherit"},o.a.createElement(I.a,{alt:m.name,src:m.imageUrl,className:l.mr12}),o.a.createElement(X.a,null,"string"===typeof t.user_attributes.permission_level?t.user_attributes.permission_level.charAt(0).toUpperCase()+t.user_attributes.permission_level.substring(1):"")),o.a.createElement(Z.a,{id:"simple-menu",anchorEl:h,keepMounted:!0,open:Boolean(h),onClose:k},o.a.createElement(ee.a,{autoFocus:!1},"Select User Level"),o.a.createElement(ee.a,{autoFocus:!1,onClick:function(){return k("basic")}},"Basic"),o.a.createElement(ee.a,{autoFocus:!1,onClick:function(){return k("advanced")}},"Advanced"),o.a.createElement(ee.a,{autoFocus:!1,onClick:function(){return k("premium")}},"Premium"),o.a.createElement(te.a,{className:l.divider}),o.a.createElement(ee.a,{onClick:function(){return k(null)}},"Sign Out"),o.a.createElement(te.a,{className:l.divider}),o.a.createElement(ee.a,{onClick:function(){return k("modal")}},"Show Modal"),o.a.createElement(te.a,{className:l.divider}),o.a.createElement(ee.a,null,"Current brand: ",y),o.a.createElement(ee.a,null,o.a.createElement(ae.a,{id:"combo-box-usermenu",options:i,getOptionLabel:function(e){return e.label},style:{width:300},onChange:function(e){return k(e.target.innerText||"")},renderInput:function(e){return o.a.createElement(ne.a,Object.assign({},e,{label:"Change merchant brand",variant:"outlined"}))},loadingText:"Loading...",disableautofocus:"true",onKeyDown:function(e){return e.stopPropagation()}}))))}var se=n(34),le=n(57),ce=n(64),de=n.n(ce),me=n(1008),ue=n(962),pe=n(1009),he=n(961),be=n(894),ge=n(367),fe=n.n(ge),ye=n(1049),Ce=n(963);function ke(e){var t=Object(a.useContext)(oe).toggleCodeShow,n=Object(a.useContext)(oe).codeShow,r=e.classes,i=(e.lookerContent,e.clientSideCode,e.serverSideCode,e.lookerUser);e.permissionNeededCode;return o.a.createElement(he.a,{onClickAway:function(){t()}},o.a.createElement(be.a,{in:n||!1},Object.keys(i).length?o.a.createElement(ue.a,{container:!0,spacing:3,className:r.padding30,style:{backgroundColor:"rgb(40, 42, 54)"}},o.a.createElement(ue.a,{item:!0,sm:10},o.a.createElement(X.a,{variant:"h6",className:" ".concat(r.mrAuto),style:{color:"white"}},"Looker User Object")),o.a.createElement(ue.a,{item:!0,sm:2,style:{textAlign:"right"}},o.a.createElement(fe.a,{style:{color:"white",cursor:"pointer"},onClick:function(){return t()}})),o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(ve,{code:i}))):""))}function ve(e){var t=e.code;return o.a.createElement(ye.a,{language:"json",style:Ce.a,showLineNumbers:!0},"object"===typeof t?JSON.stringify(t,!0,4):t)}var xe=n(208),Ee=n(211),we=xe.a[500],_e=Ee.a[500],Se=(xe.a[900],Ee.a[900],xe.a[100]),je=Ee.a[100],Te=Object(J.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275},maxHeight200:{maxHeight:200,height:200,overflow:"hidden"},mt30:{marginTop:30},mb30:{marginBottom:30},textCenter:{textAlign:"center"},cursorPointer:{cursor:"pointer"},border:{border:"1px solid black"},height800:{height:800},maxHeight100:{maxHeight:100,height:100},maxHeight400:{maxHeight:400,height:400},minHeight680:{minHeight:680},minHeight200:{minHeight:200,overflow:"scroll"},redNeg:{backgroundColor:Se,color:we,fontWeight:800},greenPos:{backgroundColor:je,color:_e,fontWeight:800},padding30:{padding:30},mb12:{marginBottom:12},overflowScroll:{overflow:"scroll"},overflowHidden:{overflow:"hidden"},overflowVisible:{overflow:"visible"},maxHeight150:{maxHeight:150,height:150},minHeight150:{minHeight:150,overflow:"scroll"},carouselLegend:{backgroundColor:"rgb(192,192,192, .5)\t !important",fontSize:"24px !important",textAlign:"center !important",opacity:"100 !important",fontWeight:800},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"},padding15:{padding:15},maxHeight75:{maxHeight:75,height:75},overflowYScroll:{overflowY:"scroll",overflowX:"hidden"},drawerHeader:Object(c.a)(Object(c.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"})}}));var Oe=n(1053);function Ie(e){var t=e.children,n=e.color,r=e.height,i=e.width,s=e.margin,l=e.id,d=e.backgroundColor,u=Object(m.a)(e,["children","color","height","width","margin","id","backgroundColor"]),p={};return p=Object(a.useContext)(oe).show?Object(c.a)(Object(c.a)({},p),{},{border:"3px solid ".concat(n),backgroundColor:"".concat(d),borderRadius:"4px",position:"relative"}):{border:"3px solid transparent",backgroundColor:"transparent"},r&&(p.height=r),i&&(p.width=i),s&&(p.margin=s),o.a.createElement("div",Object.assign({id:l,style:p},u),t)}function Ne(e){var t=Object.assign({},e),n=Object(a.useContext)(oe).show,r=t.classes,i=t.children;return o.a.createElement(Ie,Object.assign({},t,{color:"#A142F4",backgroundColor:"rgba(161, 66, 244, 0.1)"}),o.a.createElement(Oe.a,{size:"small",label:"API",className:n?"test":"".concat(r.hidden),display:"inline",align:"right",style:{backgroundColor:"#A142F4",color:"#fff",top:"-10px",left:"-10px",position:"absolute"}}),i)}function De(e){var t=Object.assign({},e),n=Object(a.useContext)(oe).show,r=t.classes,i=t.children;return o.a.createElement(Ie,Object.assign({},t,{color:"#12B5CB",backgroundColor:"rgba(18, 181, 203, 0.1)"}),o.a.createElement(Oe.a,{size:"small",label:"Embed",className:n?"test":"".concat(r.hidden),display:"inline",align:"right",style:{backgroundColor:"#12B5CB",color:"#fff",top:"-10px",left:"-10px",position:"absolute"}}),i)}var Fe=n(262),He=n(46),Pe=He.validIdHelper,Re=He.decodeHtml;function Ae(e){var t=e.lookerContent,n=e.classes,r=Object(a.useState)([]),i=Object(K.a)(r,2),s=i[0],c=i[1],m=Object(a.useContext)(oe),u=(m.userProfile,m.lookerUser),p=(m.show,{});Object(a.useEffect)((function(){(t||u)&&setTimeout((function(){return h()}),1e3)}),[t,u]);var h=function(){var e=Object(d.a)(l.a.mark((function e(){var n,a,o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c([]),n=encodeURIComponent(JSON.stringify(t.inlineQuery)),e.next=4,fetch("/runinlinequery/".concat(n,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 4:return a=e.sent,e.next=7,a.json();case 7:o=e.sent,p.id=Pe("singleVisValue-".concat(t.id)),p.data=[],r=[],o.queryResults.map((function(e){if(e[t.inlineQuery.fields[0]]){var n={x:e[t.inlineQuery.fields[0]].toString(),y:e[t.inlineQuery.fields[1]]||0,change:e.change};n&&"null"!==n.y&&r.push(n)}})),p.data=[].concat(r),c([p]);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),b=s.length?isNaN((100*s[0].data[0].change).toFixed(2))?"":parseInt((100*s[0].data[0].change).toFixed(0))>=0?"&uarr;":"&darr;":"";return o.a.createElement(me.a,{className:"".concat(n.padding15," ").concat(n.overflowHidden),variant:"outlined"},o.a.createElement("div",{style:{height:t.height}},s.length?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ne,{height:140,classes:n},o.a.createElement(ue.a,{container:!0,className:"".concat(n.textCenter)},o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(X.a,{variant:"body2",align:"left",color:"secondary"},t.label)),o.a.createElement(ue.a,{item:!0,sm:6},o.a.createElement(X.a,{variant:"subtitle1",align:"left"},o.a.createElement("b",null,s[0].data&&s[0].data[0]?s[0].data[0].y.toFixed(2):""))),o.a.createElement(ue.a,{item:!0,sm:6},o.a.createElement(Oe.a,{size:"small",label:"".concat(Re(b)," ").concat(parseInt(100*s[0].data[0].change).toFixed(0),"% "),className:isNaN((100*s[0].data[0].change).toFixed(2))?"":parseInt((100*s[0].data[0].change).toFixed(0))>=0?n.greenPos:n.redNeg,display:"inline",align:"right"}))),o.a.createElement(Fe.a,{data:s,margin:{top:25,right:25,bottom:25,left:25},xScale:{type:"time",format:"%Y-%m-%d",precision:"day"},yScale:{type:"linear",min:"auto",max:"auto",stacked:!0,reverse:!1},axisLeft:{orient:"left",tickSize:0,tickPadding:5,tickRotation:0,format:function(){return null}},axisBottom:{orient:"bottom",tickSize:0,tickPadding:5,tickRotation:0,format:function(){return null}},enablePoints:!1,enableGridX:!1,enableGridY:!1,height:100,colors:t.visColor,animate:!0}))):o.a.createElement(ue.a,{item:!0,sm:12,className:"".concat(n.flexCentered),style:{height:t.height}},o.a.createElement(pe.a,{className:n.circularProgress,style:{color:"".concat(t.visColor," ")}}))))}n(359);var Be=n(46),Ue=(Be.validIdHelper,Be.decodeHtml);function Le(e){var t=e.lookerContent,n=e.item,r=e.index,i=e.classes,s=Object(a.useState)(void 0),c=Object(K.a)(s,2),m=c[0],u=c[1],p=Object(a.useContext)(oe),h=(p.userProfile,p.lookerUser);p.show;Object(a.useEffect)((function(){n&&b()}),[n,h]);var b=function(){var e=Object(d.a)(l.a.mark((function e(){var a,o,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u(void 0),a=n,o=encodeURIComponent(JSON.stringify(a)),e.next=5,fetch("/runinlinequery/".concat(o,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return r=e.sent,e.next=8,r.json();case 8:i=e.sent,u(i.queryResults[0]);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),g=m?m.change>0?"&uarr;":"&darr;":"";return o.a.createElement(ue.a,{item:!0,sm:12},m?o.a.createElement(o.a.Fragment,null,o.a.createElement(Ne,{classes:i},o.a.createElement(X.a,{variant:"subtitle1",display:"inline"},"Your ",t.inlineQueriesMap[r]," category, ",o.a.createElement("b",null,m["products.category"]),", is ",m.change>0?"up ":"down "),o.a.createElement(Oe.a,{size:"small",label:"".concat(Ue(g)," ").concat(parseInt(100*m.change).toFixed(0),"% "),className:m.change>0?i.greenPos:i.redNeg,display:"inline"}),o.a.createElement(X.a,{variant:"subtitle1",display:"inline"},"\xa0over the past week."))):o.a.createElement("div",{style:{height:"56px"}}))}var $e=n(46).validIdHelper;function Me(e){var t=e.lookerContent,n=e.classes,r=Object(a.useContext)(oe),i=r.userProfile,s=r.lookerUser;return Object(a.useEffect)((function(){}),[t,s]),o.a.createElement("div",{className:"".concat(n.overflowScroll," ").concat(n.padding15),style:{maxHeight:t.height}},o.a.createElement(X.a,{variant:"h4"},"Welcome back"),o.a.createElement("br",null),o.a.createElement(X.a,{variant:"subtitle1",display:"inline"},"Hi ",o.a.createElement("b",null,i.givenName),", hope you're having a good day. Here are a few things you might want to know."),o.a.createElement("br",null),o.a.createElement(o.a.Fragment,null,t.inlineQueries.map((function(e,a){return o.a.createElement(Le,Object.assign({key:"".concat($e("naturalLanguage-splashPage-"+a))},{lookerContent:t,item:e,index:a,classes:n}))}))))}function Ge(e){e.lookerContent;var t=e.classes,n=e.item,r=e.handleMenuItemSelect,i=e.index,s=Object(a.useState)(void 0),c=Object(K.a)(s,2),m=c[0],u=c[1],p=Object(a.useContext)(oe),h=(p.userProfile,p.lookerUser);p.show;Object(a.useEffect)((function(){n&&b()}),[n,h]);var b=function(){var e=Object(d.a)(l.a.mark((function e(){var t,a,o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/getthumbnail/".concat(n.resourceType,"/").concat(n.id),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:a=e.sent,o=new Blob([a.svg],{type:"image/svg+xml"}),r=URL.createObjectURL(o),u(r);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.a.createElement(ue.a,{container:!0,onClick:function(){return r(n.id,1)},className:"".concat(t.cursorPointer),spacing:3},m?o.a.createElement(o.a.Fragment,null,o.a.createElement(ue.a,{item:!0,sm:1}),o.a.createElement(ue.a,{item:!0,sm:6},o.a.createElement(Ne,{classes:t},o.a.createElement("div",{className:" ".concat(t.maxHeight75," ").concat(t.textCenter," ").concat(t.cursorPointer," ").concat(t.overflowHidden)},o.a.createElement("img",{onClick:function(){return r(n.id,1)},src:m,style:{width:"100%"}})))),o.a.createElement(ue.a,{item:!0,sm:4},o.a.createElement(X.a,{variant:"subtitle1"},n.label)),i<2?o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(te.a,{className:"".concat(t.divider," ").concat(t.mb12," ").concat(t.mt12)})):""):"")}var qe=n(46).validIdHelper;function Ve(e){var t=e.lookerContent,n=e.classes,r=e.handleMenuItemSelect,i=Object(a.useState)([]),s=Object(K.a)(i,2);s[0],s[1];return o.a.createElement(me.a,{className:n.padding15,variant:"outlined"},o.a.createElement("div",{className:"".concat(n.overflowYScroll),style:{height:t.height}},o.a.createElement(ue.a,{container:!0,spacing:3},o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(X.a,{variant:"h6",align:"center",color:"secondary"},"Helpful Dashboards")),t.vectors.map((function(e,a){return o.a.createElement(Ge,Object.assign({key:"".concat(qe("vectorThumbnail-splashPage-"+a))},{lookerContent:t,item:e,classes:n,handleMenuItemSelect:r,index:a}))})))))}function ze(e){var t=e.lookerContent,n=e.classes,r=e.id,i=e.lookerHost,s=Object(a.useState)(0),l=Object(K.a)(s,2),c=l[0],d=l[1],m=Object(a.useContext)(oe),u=(m.userProfile,m.lookerUser);m.show;return Object(a.useEffect)((function(){de()("#".concat(r)).html(""),d(0),se.LookerEmbedSDK.createDashboardWithId(t.slug).appendTo(document.getElementById(r)).withClassName("dashboard").withClassName("splashPage").withClassName(t.id).withTheme("atom_fashion").build().connect().then((function(e){d(1),se.LookerEmbedSDK.init("https://".concat(i,".looker.com"))})).catch((function(e){console.error("Connection error",e)}))}),[u]),o.a.createElement(me.a,{className:n.padding15,variant:"outlined"},o.a.createElement("div",{className:"".concat(n.textCenter," ").concat(n.overflowVisible),style:{height:t.height}},c?"":o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(me.a,{className:"".concat(n.card," ").concat(n.flexCentered," ").concat(n.maxHeight400," "),elevation:0},o.a.createElement(pe.a,{className:n.circularProgress}))),o.a.createElement(j.a,null,o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(De,{classes:n},o.a.createElement("div",{className:"embedContainer splashPage",id:r,key:r}))))))}var We=n(384);n(46).validIdHelper;function Qe(e){var t=e.lookerContent,r=e.classes,i=Object(a.useContext)(oe),s=(i.userProfile,i.lookerUser);Object(a.useEffect)((function(){}),[t,s]);n(257),n(258),n(259);return o.a.createElement("div",{className:"".concat(r.overflowHidden,"  MuiPaper-rounded"),style:{maxHeight:t.height,borderRadius:"4px"}},o.a.createElement(We.Carousel,{infiniteLoop:!0,autoPlay:!0,showThumbs:!1},o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:n(257)}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},"Blog")),o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:n(258)}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},"Inventory Best Practices")),o.a.createElement("div",{style:{maxHeight:t.height}},o.a.createElement("img",{src:n(259)}),o.a.createElement("p",{className:"legend ".concat(r.carouselLegend)},"Macro Trends"))))}var Ke=n(1012),Je=n(1057),Ye=n(1013),Xe=n(385),Ze=n.n(Xe);function et(e){var t=e.classes,n=Object(a.useContext)(oe).toggleShow,r=Object(a.useContext)(oe).show,i=Object(a.useContext)(oe).toggleCodeShow;Object(a.useContext)(oe).codeShow,e.lookerUser;return o.a.createElement(T.a,{position:"fixed",className:Object(E.a)(t.appBarBottom),color:"transparent",elevation:0},o.a.createElement(O.a,null,o.a.createElement(Ke.a,{control:o.a.createElement(Je.a,{checked:r,onChange:n}),label:"Show source"}),o.a.createElement(Ye.a,{variant:"outlined",className:"".concat(t.mrAuto),startIcon:o.a.createElement(Ze.a,null),onClick:i},"Code")))}var tt=n(46).validIdHelper;function nt(e){var t=Object(a.useState)(0),n=Object(K.a)(t,2),r=(n[0],n[1],Object(a.useState)(1)),i=Object(K.a)(r,2),s=i[0],l=(i[1],Object(a.useState)("")),c=Object(K.a)(l,2),d=(c[0],c[1]),m=Object(a.useState)(""),u=Object(K.a)(m,2),p=(u[0],u[1],Object(a.useContext)(oe).toggleShow,Object(a.useContext)(oe).show,Object(a.useContext)(oe).codeShow),h=Te(),b=(e.staticContent,e.staticContent.lookerContent),g=e.staticContent.type,f=(e.handleTabChange,e.handleMenuItemSelect),y=e.lookerUser,C=e.lookerHost,k=g||"code flyout";return Object(a.useEffect)((function(){d("//imports\nimport $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport { AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, Divider } from '@material-ui/core'\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./SplashPage.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport { SingleValueVis } from './SingleValueVis';\nimport { Welcome } from './Welcome';\nimport { PopularAnalysis } from './PopularAnalysis';\nimport { EmbeddedLook } from './EmbeddedLook';\nimport { EmbeddedDashboard } from './EmbeddedDashboard';\nimport { ContentCarousel } from './ContentCarousel';\nimport BottomBar from '../../Material/BottomBar.js'\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of SplashPage Component\nexport default function SplashPage(props) {\n  // console.log('SplashPage')\n  //intialize state using hooks\n  const [value, setValue] = useState(0);\n  const [iFrameExists, setIFrame] = useState(1);\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const { toggleShow } = useContext(AppContext)\n  const { show } = useContext(AppContext)\n  const { codeShow } = useContext(AppContext)\n\n  //declare constants\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, handleTabChange, handleMenuItemSelect, lookerUser, lookerHost } = props;\n  const codeTab = {\n    type: 'code flyout', label: 'Code', id: 'codeFlyout',\n    lookerContent, lookerUser, clientSideCode, serverSideCode\n  }\n  // const tabContent = [[...lookerContent], codeTab];\n  // const tabContent = [[...lookerContent]];\n  const demoComponentType = type || 'code flyout';\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  /**\n   * listen for lookerContent and call \n   * setSampleCode\n  */\n  useEffect(() => {\n    // console.log('useEffect')\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent]);\n\n\n  /**\n   * What this return  does:\n   * Rendering of actual html elements,\n   * this section is necessary but less relevant to looker functionality itself\n   */\n  return (\n    <div className={`${classes.root} ${classes.minHeight680}   demoComponent`}>\n      <Card elevation={1} className={`${classes.padding30} `}>\n        <Grid container\n          spacing={3}\n          key={validIdHelper(type)} >\n          <div className={classes.root}>\n            {iFrameExists ? '' :\n              <Grid item sm={12} >\n                <Card className={`${classes.card} ${classes.flexCentered}`}>\n                  <CircularProgress className={classes.circularProgress} />\n                </Card>\n              </Grid>\n            }\n            <Box className={iFrameExists ? `${classes.positionRelative}` : `${classes.hidden} ${classes.positionRelative}`}>\n              <Grid container\n                spacing={3}\n                key={`${validIdHelper(demoComponentType + '-outerFragment')}`}>\n                {codeShow ? <Grid item sm={6}\n                  className={`${classes.positionTopRight}`}\n                >\n                  <CodeFlyout {...props}\n                    classes={classes}\n                    lookerUser={lookerUser} />\n                </Grid> : ''}\n                {lookerContent.map((lookerContent, innerIndex) => {\n                  return (\n                    <Grid\n                      key={`${validIdHelper(demoComponentType + '-innerFragment-' + innerIndex)}`}\n                      item\n                      sm={parseInt(lookerContent.gridWidth)}\n                    >\n                      {(lookerContent.type === 'welcome') && <Welcome\n                        {...{ lookerContent, classes, demoComponentType, lookerHost }}\n                      />}\n                      {(lookerContent.type === 'carousel') && <ContentCarousel\n                        {...{ lookerContent, classes, demoComponentType, lookerHost }}\n                      />}\n                      {(lookerContent.type === 'single value') && <SingleValueVis\n                        {...{ lookerContent, classes, demoComponentType, lookerHost }}\n                      />}\n                      {(lookerContent.type === 'dashboard') && <EmbeddedDashboard\n                        {...{ lookerContent, classes, lookerHost }} id={validIdHelper(`embedContainer-${demoComponentType}-${lookerContent.id}`)}\n                      />}\n                      {(lookerContent.type === 'popular analysis') && <PopularAnalysis\n                        {...{ lookerContent, classes, demoComponentType, handleMenuItemSelect, lookerHost }}\n                      />}\n                    </Grid>\n                  )\n                })}\n              </Grid>\n            </Box >\n          </div >\n        </Grid >\n      </Card>\n    </div >\n  )\n}")}),[b]),o.a.createElement("div",{className:"".concat(h.root," ").concat(h.minHeight680,"   demoComponent")},o.a.createElement(me.a,{elevation:1,className:"".concat(h.padding30," ")},o.a.createElement(ue.a,{container:!0,spacing:3,key:tt(g)},o.a.createElement("div",{className:h.root},s?"":o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(me.a,{className:"".concat(h.card," ").concat(h.flexCentered)},o.a.createElement(pe.a,{className:h.circularProgress}))),o.a.createElement(j.a,{className:s?"".concat(h.positionRelative):"".concat(h.hidden," ").concat(h.positionRelative)},o.a.createElement(ue.a,{container:!0,spacing:3,key:"".concat(tt(k+"-outerFragment"))},p?o.a.createElement(ue.a,{item:!0,sm:6,className:"".concat(h.positionTopRight)},o.a.createElement(ke,Object.assign({},e,{classes:h,lookerUser:y}))):"",b.map((function(e,t){return o.a.createElement(ue.a,{key:"".concat(tt(k+"-innerFragment-"+t)),item:!0,sm:parseInt(e.gridWidth)},"welcome"===e.type&&o.a.createElement(Me,{lookerContent:e,classes:h,demoComponentType:k,lookerHost:C}),"carousel"===e.type&&o.a.createElement(Qe,{lookerContent:e,classes:h,demoComponentType:k,lookerHost:C}),"single value"===e.type&&o.a.createElement(Ae,{lookerContent:e,classes:h,demoComponentType:k,lookerHost:C}),"dashboard"===e.type&&o.a.createElement(ze,Object.assign({lookerContent:e,classes:h,lookerHost:C},{id:tt("embedContainer-".concat(k,"-").concat(e.id))})),"popular analysis"===e.type&&o.a.createElement(Ve,{lookerContent:e,classes:h,demoComponentType:k,handleMenuItemSelect:f,lookerHost:C}))}))))))))}var at=n(1058),ot=n(1015),rt=n(1016),it=n(1014),st=n(1062),lt=n(1017),ct=n(85),dt=n.n(ct),mt=Object(J.a)((function(e){return Object(C.a)({root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden"},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},mrAuto:{marginRight:"auto"},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275,minHeight:680},padding30:{padding:30},minHeight680:{minHeight:680},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"}},"skeleton",{height:160,width:"100%"})}));function ut(e){var t=e.val,n=e.positive_good,a=(e.abs_val,{up:n?"green":"red",down:n?"red":"green"}),r=t<0?a.down:t>0?a.up:"black",i=Math.abs(t).toLocaleString("en",{style:"percent",minimumFractionDigits:2}),s=t<0?"\u25bc":t>0?"\u25b2":"\u2014";return o.a.createElement(o.a.Fragment,null,o.a.createElement("font",{color:r},"".concat(s," ").concat(i)))}var pt=n(46).validIdHelper;function ht(e){var t=Object(a.useState)(0),n=Object(K.a)(t,2),r=(n[0],n[1],Object(a.useState)(0)),i=Object(K.a)(r,2),s=i[0],m=i[1],u=Object(a.useState)([]),p=Object(K.a)(u,2),h=p[0],b=p[1],g=Object(a.useState)({}),f=Object(K.a)(g,2),y=f[0],v=f[1],E=Object(a.useState)(""),w=Object(K.a)(E,2),_=(w[0],w[1]),S=Object(a.useState)(""),T=Object(K.a)(S,2),O=T[0],I=T[1],N=Object(a.useState)(""),D=Object(K.a)(N,2),F=D[0],H=D[1],P=Object(a.useState)({}),R=Object(K.a)(P,2),A=R[0],B=R[1],U=Object(a.useState)("All"),L=Object(K.a)(U,2),$=L[0],M=L[1],G=(Object(a.useContext)(oe).toggleShow,Object(a.useContext)(oe).show,Object(a.useContext)(oe)),q=G.codeShow,V=(G.toggleCodeShow,mt()),z=e.staticContent.lookerContent,W=e.staticContent.type,Q=(e.activeTabValue,e.handleTabChange,e.lookerUser),J=e.lookerHost,Y=W||"code flyout",X=function(e,t){H(t);var n=x.a.filter(A.dashboard_layout_components,(function(e){return z[0].dynamicFieldLookUp[t].indexOf(e.dashboard_element_id)>-1})),a=Object(c.a)(Object(c.a)({},A),{},{dashboard_layout_components:n});y.setOptions({layouts:[a]})};Object(a.useEffect)((function(){setTimeout((function(){return Z(Object(k.a)(z))}),1e3),_("import $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, TextField, Toolbar, FormControlLabel, Switch, Chip,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails\n} from '@material-ui/core'\nimport { Autocomplete, ToggleButton, ToggleButtonGroup, Skeleton } from '@material-ui/lab'\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./Dashboard.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport BottomBar from '../../Material/BottomBar.js'\nimport { ApiHighlight, EmbedHighlight } from '../../Highlights/Highlight';\nimport { NumberToColoredPercent } from '../../Accessories/NumberToColoredPercent';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of Dashboard Component\nexport default function Dashboard(props) {\n  // console.log('Dashboard')\n  //initialize state using hooks\n  const [value, setValue] = useState(0);\n  const [iFrameExists, setIFrame] = useState(0);\n  const [apiContent, setApiContent] = useState([]);\n  const [dashboardObj, setDashboardObj] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const [toggleValue, setToggleValue] = useState('');\n  const [dashboardLayout, setDashboardLayout] = useState({});\n  const [regionValue, setRegionValue] = useState('All');\n  // const { togglePayWallModal } = useContext(AppContext)\n  const { toggleShow } = useContext(AppContext)\n  const { show } = useContext(AppContext)\n  const { codeShow, toggleCodeShow } = useContext(AppContext)\n\n  //declare constants\n  const classes = useStyles();\n  const { staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser, lookerHost } = props;\n  const demoComponentType = type || 'code flyout';\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  const handleToggle = (event, newValue) => {\n    setToggleValue(newValue)\n    const filteredLayout = _.filter(dashboardLayout.dashboard_layout_components, (row) => {\n      return (lookerContent[0].dynamicFieldLookUp[newValue].indexOf(row.dashboard_element_id) > -1)\n    })\n    const newDashboardLayout = {\n      ...dashboardLayout,\n      dashboard_layout_components: filteredLayout\n    }\n    dashboardObj.setOptions({ \"layouts\": [newDashboardLayout] })\n  };\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    setTimeout(() => performLookerApiCalls([...lookerContent]), 1000)\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent, lookerUser]);\n\n\n  useEffect(() => {\n    if (Object.keys(dashboardLayout).length && Object.keys(dashboardObj).length && lookerContent[0].dynamicFieldLookUp) {\n      handleToggle(null, Object.keys(lookerContent[0].dynamicFieldLookUp)[0])\n    }\n  }, [dashboardLayout]);\n\n  /** \n   * What this function does:\n   * iterate over Looker Content array referenced above and\n   * calls specific endpoints and methods available from Looker Node SDK\n   * and embed SDK to create the experience on this page\n   */\n  const performLookerApiCalls = function (lookerContent) {\n    // console.log('performLookerApiCalls')\n    $(`.embedContainer.${validIdHelper(demoComponentType)}:visible`).html('')\n    setIFrame(0)\n    setApiContent([])\n    lookerContent.map(async lookerContent => {\n      let dashboardId = lookerContent.id;\n      // let dashboardSlug = lookerContent.slug;\n\n      LookerEmbedSDK.createDashboardWithId(dashboardId) //dashboardSlug\n        .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${dashboardId}`))\n        .withClassName('iframe')\n        .withNext()\n        // .withNext(lookerContent.isNext || false) //how can I make this dynamic based on prop??\n        .withTheme(lookerContent.theme || 'atom_fashion')\n        .withParams({ 'schedule_modal': 'true' })\n        .on('page:property:change', (event) => {\n          // console.log('page property is changing!!!!')\n          changeHeight(event)\n        }) // dashboards-next\n        .on('dashboard:loaded', (event) => {\n          setDashboardLayout(event.dashboard.options.layouts[0])\n        })\n        // .on('drillmenu:click', (event) => {\n        //   drillMenuClick(event)\n        // })\n        .build()\n        .connect()\n        .then((dashboard) => {\n          setIFrame(1)\n          setDashboardObj(dashboard)\n          LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n\n        })\n        .catch((error) => {\n          // console.error('Connection error', error)\n        })\n\n      if (lookerContent.hasOwnProperty('filters')) {\n        //get inline query from usecase file & set user attribute dynamically\n\n        //iterating over filters\n        let orderedArrayForApiContent = []\n        lookerContent.filters.map(async (item, index) => {\n          // console.log('item', item)\n          let jsonQuery = lookerContent.inlineQueries[index];\n          jsonQuery.filters = {\n            ...jsonQuery.filters,\n            [item.desiredFilterName]: lookerUser.user_attributes.brand\n          };\n          // lookerContent.inlineQueries[index] = jsonQuery;\n          let stringifiedQuery = encodeURIComponent(JSON.stringify(jsonQuery))\n          let lookerResponse = await fetch('/runinlinequery/' + stringifiedQuery + '/json', {\n            method: 'GET',\n            headers: {\n              Accept: 'application/json',\n              'Content-Type': 'application/json'\n            }\n          })\n          let lookerResponseData = await lookerResponse.json();\n          let queryResultsForDropdown = [];\n          let desiredProperty = Object.keys(lookerResponseData.queryResults[0])[0];\n\n          for (let i = 0; i < lookerResponseData.queryResults.length; i++) {\n            queryResultsForDropdown.push({\n              'label': lookerResponseData.queryResults[i][desiredProperty],\n              'trend': (lookerResponseData.queryResults[i]['trend']) ? lookerResponseData.queryResults[i]['trend'] : undefined\n            })\n          }\n\n\n          // setApiContent(apiContent => {\n          //   return [...apiContent, queryResultsForDropdown]\n          // });\n          //needed solution for ordering apiContent to match order\n          //of content from usecaseContent\n          orderedArrayForApiContent[index] = queryResultsForDropdown\n          setApiContent([...orderedArrayForApiContent])\n\n          if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n        })\n      }\n\n    })\n  }\n\n  /**\n   * update dashboard when custom filter changed\n  */\n  const customFilterAction = (dashboardId, filterName, newFilterValue) => {\n    if (Object.keys(dashboardObj).length) {\n      dashboardObj.updateFilters({ [filterName]: newFilterValue })\n      dashboardObj.run()\n    }\n  }\n\n  // const drillMenuClick = (event) => {\n\n  //   const basicLookerUser = lookerUser.user_attributes.permission_level === 'basic' ? true : false;\n  //   if (basicLookerUser) {\n  //     togglePayWallModal()\n  //     return { cancel: (basicLookerUser) ? true : false }\n  //   }\n  // }\n\n  const changeHeight = (event) => {\n    // console.log('changeHeight')\n    // console.log('event', event)\n  }\n\n  /**\n   * What this return  does:\n   * Rendering of actual html elements,\n   * this section is necessary but less relevant to looker functionality itself\n   */\n\n  // console.log('apiContent', apiContent)\n\n  return (\n    <div className={`${classes.root} ${classes.minHeight680}   demoComponent`}>\n      <Card elevation={1} className={`${classes.padding30} `}>\n        <Grid container spacing={3}>\n          <div className={`${classes.root} ${classes.positionRelative}`}>\n\n            {lookerContent[0].hasOwnProperty(\"filters\") &&\n              apiContent.length === lookerContent[0].filters.length ?\n              <Grid item\n                sm={12}\n                key={validIdHelper(`${demoComponentType}-FilterBar-${lookerContent[0].id}`)}\n              >\n                <FilterBar {...props}\n                  classes={classes}\n                  apiContent={apiContent}\n                  customFilterAction={customFilterAction}\n                  regionValue={regionValue}\n                  setRegionValue={setRegionValue}\n                  toggleValue={toggleValue}\n                  handleToggle={handleToggle}\n                />\n              </Grid> :\n              lookerContent[0].hasOwnProperty(\"filters\") ?\n                <Skeleton variant=\"rect\" animation=\"wave\" className={classes.skeleton} /> :\n                ''}\n\n\n            {\n              iFrameExists\n                ? ''\n                :\n                <Grid item sm={12} >\n                  <Card className={`${classes.card} ${classes.flexCentered}`} elevation={0}>\n                    <CircularProgress className={classes.circularProgress} />\n                  </Card>\n                </Grid>\n            }\n            <Box\n              className={iFrameExists ? ` ` : `${classes.hidden} `}>\n              {codeShow ?\n                <Grid item sm={6}\n                  className={`${classes.positionTopRight}`}\n                >\n                  <CodeFlyout {...props}\n                    classes={classes}\n                    lookerUser={lookerUser} />\n                </Grid>\n                : ''}\n              <Grid item sm={12}>\n\n                <Box className={classes.w100} mt={lookerContent[0].filter || lookerContent[0].dynamicFieldLookUp ? 2 : 0}>\n\n\n                  <EmbedHighlight classes={classes}>\n                    <div\n                      className={`embedContainer ${validIdHelper(demoComponentType)}`}\n                      id={validIdHelper(`embedContainer-${demoComponentType}-${lookerContent[0].id}`)}\n                      key={validIdHelper(`embedContainer-${demoComponentType}-${lookerContent[0].id}`)}\n                    >\n                    </div>\n                  </EmbedHighlight>\n                </Box>\n              </Grid>\n            </Box>\n          </div>\n        </Grid>\n      </Card>\n    </div>\n  )\n}\n\n\n\n\nfunction FilterBar(props) {\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, classes,\n    apiContent, customFilterAction, regionValue, setRegionValue, toggleValue, handleToggle } = props;\n\n  const [expanded, setExpanded] = useState(true);\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n  return (\n\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel} className={classes.w100} elevation={0}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMoreIcon />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <Typography className={classes.heading}>Filter Data</Typography>\n\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        {\n          lookerContent[0].filters || lookerContent[0].dynamicFieldLookUp ?\n            <Grid\n              container>\n              {apiContent.map((item, index) => {\n                return (\n                  lookerContent[0].filterComponents[index] === 'autocomplete' ?\n                    <ApiHighlight classes={classes}\n                      key={validIdHelper(`dashEmbed-${type}${lookerContent.id}-${index}`)} >\n                      <Grid item sm={6}>\n                        <Autocomplete\n                          id={`combo-box-dashboard-${lookerContent.id}`}\n                          options={Array.isArray(apiContent[index]) ?\n                            apiContent[index] :\n                            []}\n                          renderOption={(option) => (\n                            <Grid container justify=\"space-between\">\n                              <Grid item>\n                                {option.label}\n                              </Grid>\n                              {option.trend && <Grid item>\n                                <NumberToColoredPercent\n                                  val={option.trend}\n                                  positive_good={true}\n                                  abs_val={Math.abs(option.trend)}\n                                />\n                              </Grid>}\n                            </Grid>\n                          )}\n                          getOptionLabel={(option) => option.label}\n                          style={{ width: 400 }}\n                          onChange={(event, newValue) => {\n                            customFilterAction(lookerContent[0].id,\n                              lookerContent[0].filters[index].filterName,\n                              (newValue) ? newValue.label : '')\n                          }}\n                          renderInput={(params) => <TextField {...params} label={lookerContent[0].filters[index].filterName} variant=\"outlined\" />}\n                          loadingText=\"Loading...\"\n                        />\n                      </Grid>\n                    </ApiHighlight>\n                    : lookerContent[0].filterComponents[index] === 'togglebutton' ?\n\n                      <ApiHighlight classes={classes}\n                        key={validIdHelper(`dashEmbed-${type}${lookerContent.id}-${index}`)} >\n                        <Grid item sm={12}>\n                          <ToggleButtonGroup\n                            value={regionValue}\n                            exclusive\n                            onChange={(event, newValue) => {\n                              setRegionValue(newValue)\n                              customFilterAction(lookerContent[0].id,\n                                lookerContent[0].filters[index].filterName,\n                                (newValue) ? newValue : '')\n                            }}\n                            aria-label=\"region\"\n                          >\n                            {apiContent[index].map((region, index) => {\n                              return (\n                                <ToggleButton\n                                  key={validIdHelper(`${type}-FilterBar-ToggleButton-${lookerContent[0].id}-${index}`)}\n                                  value={region.label} aria-label={region.label}>\n                                  {region.label}\n                                </ToggleButton>\n                              )\n                            })}\n                          </ToggleButtonGroup>\n                        </Grid>\n                      </ApiHighlight>\n                      : 'ooooopppp')\n              })}\n              <Grid item sm={1} />\n              {lookerContent[0].dynamicFieldLookUp ?\n                <EmbedHighlight classes={classes} >\n                  <Grid item sm={5}>\n                    <ToggleButtonGroup\n                      value={toggleValue}\n                      exclusive\n                      onChange={handleToggle}\n                      aria-label=\"text alignment\"\n                    >\n                      {Object.keys(lookerContent[0].dynamicFieldLookUp).map(key => {\n                        return (\n                          <ToggleButton\n                            key={validIdHelper(`dynamicDashToggle-${key}`)}\n                            value={key} aria-label=\"left aligned\">\n                            {key}\n                          </ToggleButton>\n                        )\n                      })}\n                    </ToggleButtonGroup>\n                  </Grid>\n                </EmbedHighlight>\n                : ''\n              }\n            </Grid> : ''\n        }\n      </ExpansionPanelDetails>\n    </ExpansionPanel >\n  )\n}")}),[z,Q]),Object(a.useEffect)((function(){Object.keys(A).length&&Object.keys(y).length&&z[0].dynamicFieldLookUp&&X(0,Object.keys(z[0].dynamicFieldLookUp)[0])}),[A]);var Z=function(e){de()(".embedContainer.".concat(pt(Y),":visible")).html(""),m(0),b([]),e.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.id,se.LookerEmbedSDK.createDashboardWithId(n).appendTo(pt("#embedContainer-".concat(Y,"-").concat(n))).withClassName("iframe").withNext().withTheme(t.theme||"atom_fashion").withParams({schedule_modal:"true"}).on("page:property:change",(function(e){ee(e)})).on("dashboard:loaded",(function(e){B(e.dashboard.options.layouts[0])})).build().connect().then((function(e){m(1),v(e),se.LookerEmbedSDK.init("https://".concat(J,".looker.com"))})).catch((function(e){})),t.hasOwnProperty("filters")&&(a=[],t.filters.map(function(){var e=Object(d.a)(l.a.mark((function e(n,o){var r,i,s,d,m,u,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.inlineQueries[o]).filters=Object(c.a)(Object(c.a)({},r.filters),{},Object(C.a)({},n.desiredFilterName,Q.user_attributes.brand)),i=encodeURIComponent(JSON.stringify(r)),e.next=5,fetch("/runinlinequery/"+i+"/json",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return s=e.sent,e.next=8,s.json();case 8:for(d=e.sent,m=[],u=Object.keys(d.queryResults[0])[0],p=0;p<d.queryResults.length;p++)m.push({label:d.queryResults[p][u],trend:d.queryResults[p].trend?d.queryResults[p].trend:void 0});a[o]=m,b([].concat(a)),0===O.length&&I(d.code);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},ee=function(e){};return o.a.createElement("div",{className:"".concat(V.root," ").concat(V.minHeight680,"   demoComponent")},o.a.createElement(me.a,{elevation:1,className:"".concat(V.padding30," ")},o.a.createElement(ue.a,{container:!0,spacing:3},o.a.createElement("div",{className:"".concat(V.root," ").concat(V.positionRelative)},z[0].hasOwnProperty("filters")&&h.length===z[0].filters.length?o.a.createElement(ue.a,{item:!0,sm:12,key:pt("".concat(Y,"-FilterBar-").concat(z[0].id))},o.a.createElement(bt,Object.assign({},e,{classes:V,apiContent:h,customFilterAction:function(e,t,n){Object.keys(y).length&&(y.updateFilters(Object(C.a)({},t,n)),y.run())},regionValue:$,setRegionValue:M,toggleValue:F,handleToggle:X}))):z[0].hasOwnProperty("filters")?o.a.createElement(it.a,{variant:"rect",animation:"wave",className:V.skeleton}):"",s?"":o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(me.a,{className:"".concat(V.card," ").concat(V.flexCentered),elevation:0},o.a.createElement(pe.a,{className:V.circularProgress}))),o.a.createElement(j.a,{className:s?" ":"".concat(V.hidden," ")},q?o.a.createElement(ue.a,{item:!0,sm:6,className:"".concat(V.positionTopRight)},o.a.createElement(ke,Object.assign({},e,{classes:V,lookerUser:Q}))):"",o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(j.a,{className:V.w100,mt:z[0].filter||z[0].dynamicFieldLookUp?2:0},o.a.createElement(De,{classes:V},o.a.createElement("div",{className:"embedContainer ".concat(pt(Y)),id:pt("embedContainer-".concat(Y,"-").concat(z[0].id)),key:pt("embedContainer-".concat(Y,"-").concat(z[0].id))})))))))))}function bt(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.staticContent.type,r=e.classes,i=e.apiContent,s=e.customFilterAction,l=e.regionValue,c=e.setRegionValue,d=e.toggleValue,m=e.handleToggle,u=Object(a.useState)(!0),p=Object(K.a)(u,2),h=p[0],b=p[1];return o.a.createElement(at.a,{expanded:h,onChange:function(e,t){b(!h)},className:r.w100,elevation:0},o.a.createElement(ot.a,{expandIcon:o.a.createElement(dt.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(X.a,{className:r.heading},"Filter Data")),o.a.createElement(rt.a,null,t[0].filters||t[0].dynamicFieldLookUp?o.a.createElement(ue.a,{container:!0},i.map((function(e,a){return"autocomplete"===t[0].filterComponents[a]?o.a.createElement(Ne,{classes:r,key:pt("dashEmbed-".concat(n).concat(t.id,"-").concat(a))},o.a.createElement(ue.a,{item:!0,sm:6},o.a.createElement(ae.a,{id:"combo-box-dashboard-".concat(t.id),options:Array.isArray(i[a])?i[a]:[],renderOption:function(e){return o.a.createElement(ue.a,{container:!0,justify:"space-between"},o.a.createElement(ue.a,{item:!0},e.label),e.trend&&o.a.createElement(ue.a,{item:!0},o.a.createElement(ut,{val:e.trend,positive_good:!0,abs_val:Math.abs(e.trend)})))},getOptionLabel:function(e){return e.label},style:{width:400},onChange:function(e,n){s(t[0].id,t[0].filters[a].filterName,n?n.label:"")},renderInput:function(e){return o.a.createElement(ne.a,Object.assign({},e,{label:t[0].filters[a].filterName,variant:"outlined"}))},loadingText:"Loading..."}))):"togglebutton"===t[0].filterComponents[a]?o.a.createElement(Ne,{classes:r,key:pt("dashEmbed-".concat(n).concat(t.id,"-").concat(a))},o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(st.a,{value:l,exclusive:!0,onChange:function(e,n){c(n),s(t[0].id,t[0].filters[a].filterName,n||"")},"aria-label":"region"},i[a].map((function(e,a){return o.a.createElement(lt.a,{key:pt("".concat(n,"-FilterBar-ToggleButton-").concat(t[0].id,"-").concat(a)),value:e.label,"aria-label":e.label},e.label)}))))):"ooooopppp"})),o.a.createElement(ue.a,{item:!0,sm:1}),t[0].dynamicFieldLookUp?o.a.createElement(De,{classes:r},o.a.createElement(ue.a,{item:!0,sm:5},o.a.createElement(st.a,{value:d,exclusive:!0,onChange:m,"aria-label":"text alignment"},Object.keys(t[0].dynamicFieldLookUp).map((function(e){return o.a.createElement(lt.a,{key:pt("dynamicDashToggle-".concat(e)),value:e,"aria-label":"left aligned"},e)}))))):""):""))}var gt=n(960),ft=n(1056),yt=n(1048),Ct=n(1050),kt=n(1019),vt=n(1023),xt=n(1022),Et=n(1018),wt=n(1020),_t=n(1021),St=n(399),jt=n(46),Tt=jt.validIdHelper,Ot=jt.prettifyString,It=Object(J.a)((function(e){return{paper:{position:"absolute",width:800,maxHeight:450,overflow:"scroll",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},table:{maxHeight:310},card:{minWidth:275,minHeight:"10rem",boxShadow:"none"},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"}}}));function Nt(){return{top:"".concat(10,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(10,"%)")}}function Dt(e){var t=It(),n=e.open,a=e.onClose,r=e.modalContent,i=o.a.useState(Nt),s=Object(K.a)(i,1)[0];return o.a.createElement(Ct.a,{open:n,onClose:a,"aria-labelledby":"simple-modal-title","aria-describedby":"simple-modal-description"},o.a.createElement("div",{style:s,className:t.paper},o.a.createElement("h2",{id:"simple-modal-title"},r.title),r.body?o.a.createElement(Et.a,{component:St.a,className:t.table},o.a.createElement(kt.a,{stickyHeader:!0,className:t.table,size:"small","aria-label":"a dense table"},o.a.createElement(wt.a,null,o.a.createElement(_t.a,null,Object.keys(r.body[0]).map((function(e,t){return o.a.createElement(xt.a,{align:"right",key:Tt(e+"-TableHead-TableCell-"+t),id:Tt(e+"-TableHead-TableCell-"+t)},Ot(e.substring(e.lastIndexOf(".")+1,e.length)))})))),o.a.createElement(vt.a,null,r.body.map((function(e,t){return o.a.createElement(_t.a,{key:Tt("TableRow-"+t),id:Tt("TableRow-"+t)},Object.keys(e).map((function(e){return o.a.createElement(xt.a,{align:"right",key:Tt(e+"-TableBody-TableCell-"+t),id:Tt(e+"-TableBody-TableCell-"+t)},r.body[t][e]?r.body[t][e].rendered?r.body[t][e].rendered:r.body[t][e].value?r.body[t][e].value:"number"===typeof r.body[t][e]?Math.round(100*r.body[t][e])/100:r.body[t][e]:"")})))}))))):o.a.createElement(me.a,{className:"".concat(t.card," ").concat(t.flexCentered)},o.a.createElement(pe.a,{className:t.circularProgress}))))}var Ft=n(386),Ht=Object(J.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},card:{minWidth:275,minHeight:600},height500:{height:500},height600:{height:600},height700:{height:700},height800:{height:800},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},formControl:{margin:e.spacing(1),minWidth:120},selectEmpty:{marginTop:e.spacing(2)},skeleton:{height:160,width:"100%"},padding30:{padding:30},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"}}}));var Pt=n(396),Rt=n(274),At=n(277),Bt=n(45),Ut=n(1043),Lt=n(46).validIdHelper;function $t(e){var t=Object(a.useState)(0),n=Object(K.a)(t,2),r=(n[0],n[1],Object(a.useState)("")),i=Object(K.a)(r,2),s=i[0],m=i[1],u=Object(a.useState)(""),p=Object(K.a)(u,2),h=p[0],b=p[1],g=Object(a.useState)("All"),f=Object(K.a)(g,2),y=f[0],v=f[1],E=Object(a.useState)(""),w=Object(K.a)(E,2),_=w[0],S=w[1],T=Object(a.useState)([]),O=Object(K.a)(T,2),I=O[0],N=O[1],D=o.a.useState(!1),F=Object(K.a)(D,2),H=F[0],P=F[1],R=Object(a.useState)({}),A=Object(K.a)(R,2),B=A[0],U=A[1],L=Object(a.useState)(""),$=Object(K.a)(L,2),M=($[0],$[1]),G=Object(a.useState)(""),q=Object(K.a)(G,2),V=q[0],z=q[1],W=Object(a.useContext)(oe),Q=W.togglePayWallModal,J=(W.show,W.codeShow),Y=Ht(),X=(e.staticContent,e.staticContent.lookerContent),Z=e.staticContent.type,ee=(e.activeTabValue,e.handleTabChange,e.lookerUser),ne=(e.lookerHost,function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,o,r,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.day,(o=JSON.parse(JSON.stringify(X[0].inlineQuery))).filters=Object(c.a)(Object(c.a)({},o.filters),{},(n={},Object(C.a)(n,o.fields[0],a),Object(C.a)(n,o.fields[1],"All"===y?"":y),n)),o.total=!0,o.limit="25",P(!0),e.next=8,fetch("/runinlinequery/"+encodeURIComponent(JSON.stringify(o))+"/json",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 8:return r=e.sent,e.next=11,r.json();case 11:i=e.sent,s={title:"Detail View for ".concat(a),body:i.queryResults},U(s);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ae=[];if(I.queryResults&&I.queryResults&&(ae=(ae=x.a.filter(I.queryResults,(function(e){return e[I.inlineQuery.fields[0]]>=s&&e[I.inlineQuery.fields[0]]<h&&("All"===y||e[I.inlineQuery.fields[1]]===y)}))).map((function(e){return{day:e[I.inlineQuery.fields[0]],category:e[I.inlineQuery.fields[1]],value:e[_]}})),"All"===y)){var re=Object(k.a)(new Set(ae.map((function(e){return e.day})))),ie=[];re.map((function(e){var t=x.a.filter(ae,(function(t){return t.day===e})).reduce((function(e,t){return e+t.value}),0),n={day:e,value:t,category:"All"};ie.push(n)})),ae=ie}Object(a.useEffect)((function(){X.length&&(setTimeout((function(){return se(X)}),100),S(X[0].desiredFields[0]),M("import _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, CircularProgress, Card, TextField,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails, Divider, InputLabel, MenuItem,\n  FormControl, Select, Modal\n} from '@material-ui/core'\nimport { Skeleton } from '@material-ui/lab';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ModalTable from '../../Material/ModalTable';\nimport { ResponsiveCalendar } from '@nivo/calendar'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./CustomVis.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport { ApiHighlight } from '../../Highlights/Highlight';\n\n//new date pickers\nimport { format, endOfDay, addDays } from 'date-fns';\n// import React from 'react';\n// import Grid from '@material-ui/core/Grid';\nimport DateFnsUtils from '@date-io/date-fns';\nimport {\n  MuiPickersUtilsProvider,\n  KeyboardTimePicker,\n  KeyboardDatePicker,\n} from '@material-ui/pickers';\n\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of Custom Viz Calendar Component\nexport default function CustomVis(props) {\n  // console.log('CustomVis')\n  //initialize state using hooks\n  const [value, setValue] = useState(0);\n  const [fromDate, setFromDate] = useState('');\n  const [toDate, setToDate] = useState('');\n  const [category, setCategory] = useState('All')\n  const [desiredField, setDesiredField] = useState('')\n  const [apiContent, setApiContent] = useState([]);\n  const [open, setOpen] = React.useState(false);\n  const [modalContent, setModalContent] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n\n  const { togglePayWallModal, show, codeShow } = useContext(AppContext)\n\n  //declare constants\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser, lookerHost } = props;\n  // const codeTab = {\n  //   type: 'code flyout', label: 'Code', id: 'codeFlyout',\n  //   lookerContent, lookerUser, clientSideCode, serverSideCode\n  // }\n  // const tabContent = [...lookerContent, codeTab]\n  // const demoComponentType = type || 'code flyout';\n\n  //handle opening of modal for advanced and premium users\n  const handleModalOpen = async ({ day }) => {\n    let originalInlineQueryCopy = JSON.parse(JSON.stringify(lookerContent[0].inlineQuery));\n    originalInlineQueryCopy.filters = {\n      ...originalInlineQueryCopy.filters,\n      [originalInlineQueryCopy.fields[0]]: day,\n      [originalInlineQueryCopy.fields[1]]: category === \"All\" ? '' : category\n    }\n    originalInlineQueryCopy.total = true;\n    originalInlineQueryCopy.limit = \"25\";\n\n    setOpen(true);\n    let lookerResponse = await fetch('/runinlinequery/' + encodeURIComponent(JSON.stringify(originalInlineQueryCopy)) + '/json', {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n    let lookerResponseData = await lookerResponse.json();\n    let modalObj = {\n      \"title\": `Detail View for ${day}`,\n      \"body\": lookerResponseData.queryResults\n    }\n    setModalContent(modalObj);\n  };\n\n  //handle modal close\n  const handleModalClose = () => {\n    setModalContent({})\n    setOpen(false);\n  };\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  const handleFromDate = newValue => {\n    let validDate = Date.parse(newValue);\n    if (validDate > 0) {\n      let newValueAsDate = format(addDays(new Date(newValue), 1), 'yyyy-MM-dd');\n      setFromDate(newValueAsDate);\n    }\n  }\n  const handleToDate = newValue => {\n    let validDate = Date.parse(newValue);\n    if (validDate > 0) {\n      let newValueAsDate = format(addDays(new Date(newValue), 1), 'yyyy-MM-dd');\n      setToDate(newValueAsDate);\n    }\n  }\n  const handleCategory = newValue => {\n    setCategory(newValue)\n  }\n  const handleDesiredField = newValue => {\n    setDesiredField(newValue)\n  }\n\n  //format response from initial api call based on LookerContent array\n  //to match format required by Nivo Calendar component\n  let filterData = [];\n  if (apiContent.queryResults && apiContent.queryResults) {\n    //filtering for fromDate, toDate and category\n    filterData = _.filter(apiContent.queryResults, (row) => {\n      return (row[apiContent.inlineQuery.fields[0]] >= fromDate\n        && row[apiContent.inlineQuery.fields[0]] < toDate\n        && (category === 'All' ? true : row[apiContent.inlineQuery.fields[1]] === category)\n      )\n    })\n    //converting filterDAta to desired format for vis\n    filterData = filterData.map(item => {\n      return {\n        'day': item[apiContent.inlineQuery.fields[0]],\n        'category': item[apiContent.inlineQuery.fields[1]],\n        'value': item[desiredField]\n      }\n    })\n\n    //special exception for category all\n    //need to reduce array by day across categories\n    //destructuing in reduce of value would not work for dynamic var\n    if (category === 'All') {\n      //create array of all unique dates\n      const uniqueDates = [...new Set(filterData.map(item => item.day))];\n      let filteredAndReducedForAll = []\n      //iterate over unique date\n      uniqueDates.map(uniqueDate => {\n        //filter filterData for current unique date\n        let value = _.filter(filterData, row => {\n          return row.day === uniqueDate\n        }).reduce((acc, { value }) => acc + value, 0)\n        let thisObj = {\n          day: uniqueDate,\n          value: value,\n          category: 'All'\n        }\n        filteredAndReducedForAll.push(thisObj)\n\n      })\n      filterData = filteredAndReducedForAll;\n    }\n  }\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    if (lookerContent.length) {\n      setTimeout(() => performLookerApiCalls(lookerContent), 100);\n      setDesiredField(lookerContent[0].desiredFields[0])\n      setClientSideCode(rawSampleCode)\n    }\n  }, [lookerContent, lookerUser])\n\n  /** \n   * What this function does:\n   * iterate over Looker Content array referenced above and\n   * calls specific endpoints and methods available from Looker Node SDK\n   * and embed SDK to create the experience on this page\n   */\n  const performLookerApiCalls = function (lookerContent) {\n    setApiContent([]); //set to empty array to show progress bar and skeleton\n    lookerContent.map(async lookerContent => {\n      let inlineQuery = lookerContent.inlineQuery;\n      inlineQuery.filters = {\n        // ...inlineQuery.filters,\n        // [Object.keys(inlineQuery.filters)[0]]: lookerUser.user_attributes.time_horizon,\n        [lookerContent.desiredFilterName]: lookerUser.user_attributes.brand\n      };\n      let stringifiedQuery = encodeURIComponent(JSON.stringify(inlineQuery));\n      // console.log('stringifiedQuery', stringifiedQuery)\n      let lookerResponse = await fetch(`/runinlinequery/${stringifiedQuery}/${lookerContent.resultFormat}`, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })\n      let lookerResponseData = await lookerResponse.json();\n      // console.log('lookerResponseData', lookerResponseData)\n      lookerResponseData.queryResults = lookerResponseData.queryResults.filter(item => {\n        return item[inlineQuery.fields[0]]\n      })\n      let uniqueCategories = ['All'];\n      for (let i = 0; i < lookerResponseData.queryResults.length; i++) {\n        if (uniqueCategories.indexOf(lookerResponseData.queryResults[i][inlineQuery.fields[1]]) === -1) {\n          uniqueCategories.push(lookerResponseData.queryResults[i][inlineQuery.fields[1]])\n        }\n      }\n      lookerResponseData.inlineQuery = inlineQuery;\n      lookerResponseData.uniqueCategories = uniqueCategories;\n      setFromDate(lookerResponseData.queryResults[lookerResponseData.queryResults.length - 1][lookerResponseData.inlineQuery.fields[0]]);\n      setToDate(incrementDate(lookerResponseData.queryResults[0][lookerResponseData.inlineQuery.fields[0]], 1));\n      setApiContent(lookerResponseData)\n      if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n    })\n  }\n\n  let redToBlueColorScale = ['#0302FC', '#2A00D5', '#63009E', '#A1015D', '#D80027', '#FE0002'];\n  let yellowToGreenColorScale = ['#FEFE69', '#DDF969', '#A9F36A', '#A1015D', '#78EC6C', '#57E86B'];\n  let nivoColorScale = ['#61cdbb', '#97e3d5', '#e8c1a0', '#f47560']\n  let googleColorScale = ['#4595EC', '#F3A759', '#E24E3A', '#65AB5A'];\n\n  return (\n    <div className={`${classes.root} ${classes.minHeight680}   demoComponent`}>\n      <Card elevation={1} className={`${classes.padding30} `}>\n        <Grid container\n          spacing={3}\n          key={validIdHelper(type)} >\n          <div className={`${classes.root} ${classes.positionRelative}`}>\n\n            {!apiContent.queryResults ?\n              <Skeleton variant=\"rect\" animation=\"wave\" className={classes.skeleton} />\n              :\n              <FilterBar {...props}\n                classes={classes}\n                apiContent={apiContent}\n                fromDate={fromDate}\n                toDate={toDate}\n                category={category}\n                desiredField={desiredField}\n                handleFromDate={handleFromDate}\n                handleToDate={handleToDate}\n                handleCategory={handleCategory}\n                handleDesiredField={handleDesiredField}\n              />\n            }\n\n\n            {!apiContent.queryResults ?\n              <Grid item sm={12} >\n                <Card className={`${classes.card} ${classes.flexCentered}`} elevation={0}>\n                  <CircularProgress className={classes.circularProgress} />\n                </Card>\n              </Grid>\n\n              : apiContent.queryResults && apiContent.queryResults.length ?\n\n                <Box\n                  className={``}>\n                  <Grid container>\n                    {codeShow ? <Grid item sm={6}\n                      className={`${classes.positionTopRight}`}\n                    >\n                      <CodeFlyout {...props}\n                        classes={classes}\n                        lookerUser={lookerUser} />\n                    </Grid> : ''}\n                    <Divider className={classes.divider} />\n                    <Grid item sm={12} className={classes.height600}>\n\n                      <Box className={classes.w100} mt={2}>\n\n                        <ApiHighlight height={400} classes={classes}>\n                          <ResponsiveCalendar\n                            data={filterData}\n                            align=\"top\"\n                            from={incrementDate(fromDate, 1)}\n                            to={incrementDate(toDate, 1)}\n                            emptyColor=\"#eeeeee\"\n                            colors={desiredField === lookerContent[0].desiredFields[0] ? googleColorScale : nivoColorScale}\n                            yearSpacing={40}\n                            monthBorderColor=\"#ffffff\"\n                            dayBorderWidth={2}\n                            dayBorderColor=\"#ffffff\"\n                            margin={{ bottom: 40, left: 40 }}\n                            legends={[\n                              {\n                                anchor: 'bottom-right',\n                                direction: 'row',\n                                translateY: 36,\n                                itemCount: 4,\n                                itemWidth: 42,\n                                itemHeight: 36,\n                                itemsSpacing: 14,\n                                itemDirection: 'right-to-left'\n                              }\n                            ]}\n                            onClick={(day, event) => {\n                              if (!day.value) {\n                              } else if (lookerUser.user_attributes.permission_level === 'basic') {\n                                togglePayWallModal({\n                                  'show': true,\n                                  'permissionNeeded': 'see_drill_overlay'\n                                });\n                              } else {\n                                handleModalOpen(day)\n                                event.stopPropagation();\n                              }\n                            }}\n                          />\n                        </ApiHighlight>\n                      </Box>\n                    </Grid>\n                  </Grid>\n                </Box> :\n                ''\n            }\n          </div>\n        </Grid >\n        {\n          open ?\n            <ModalTable\n              {...props}\n              open={open}\n              onClose={handleModalClose}\n              classes={classes}\n              modalContent={modalContent}\n            />\n\n            : ''\n        }\n      </Card>\n    </div >\n  )\n}\n//Filter Bar code\nfunction FilterBar(props) {\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, classes,\n    apiContent, fromDate, toDate, category, desiredField, handleFromDate, handleToDate, handleCategory, handleDesiredField } = props;\n\n  const [expanded, setExpanded] = useState(true);\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n\n  // console.log('FilterBar')\n  // console.log('fromDate', fromDate)\n  // console.log('toDate', toDate)\n\n  return (\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel} className={classes.w100} elevation={0}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMoreIcon />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <Typography className={classes.heading}>Filter Data</Typography>\n\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <Grid container spacing={3}>\n          {apiContent.queryResults ?\n            <>\n              <Grid item sm={3}>\n\n                <ApiHighlight classes={classes}>\n                  <FormControl className={classes.formControl}>\n                    <InputLabel\n                      id={`${validIdHelper(type + '-FilterBar-DataPropery-SelectLabel')}`}\n                    >\n                      Metric</InputLabel>\n                    <Select\n                      labelId={`${validIdHelper(type + '-FilterBar-DataPropery-SelectLabel')}`}\n                      id={`${validIdHelper(type + '-FilterBar-DataPropery-Select')}`}\n                      value={desiredField}\n                      onChange={(event) => handleDesiredField(event.target.value)}\n                    >\n                      {lookerContent[0].desiredFields.map((item, index) => (\n\n                        <MenuItem\n                          id={validIdHelper(`${item}-${index}`)}\n                          key={validIdHelper(`${item}-${index}`)}\n                          value={item}\n                        >{item.substring(item.lastIndexOf(\".\") + 1, item.length).split(\"_\").map(item => item.charAt(0).toUpperCase() + item.substring(1)).join(\" \")}</MenuItem>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </ApiHighlight>\n              </Grid>\n              <Grid item sm={3}>\n                <ApiHighlight classes={classes}>\n                  <FormControl className={classes.formControl}>\n                    <InputLabel\n                      id={`${validIdHelper(type + '-FilterBar-Category-SelectLabel')}`}\n                    >\n                      Category</InputLabel>\n                    <Select\n                      labelId={`${validIdHelper(type + '-FilterBar-Category-SelectLabel')}`}\n                      id={`${validIdHelper(type + '-FilterBar-Category-Select')}`}\n                      value={category}\n                      onChange={(event) => handleCategory(event.target.value)}\n                    >\n                      {apiContent.uniqueCategories.map((item, index) => (\n\n                        <MenuItem\n                          id={validIdHelper(`${item}-${index}`)}\n                          key={validIdHelper(`${item}-${index}`)}\n                          value={item}>{item}</MenuItem>\n                      ))}\n                    </Select>\n                  </FormControl>\n                </ApiHighlight>\n              </Grid>\n\n              <Grid item sm={3}>\n\n                <ApiHighlight classes={classes}>\n                  <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                    <KeyboardDatePicker\n                      disableToolbar\n                      variant=\"inline\"\n                      format=\"MM/dd/yyyy\"\n                      margin=\"normal\"\n                      id=\"fromDate\"\n                      label=\"From date\"\n                      value={fromDate}\n                      onChange={handleFromDate}\n                      KeyboardButtonProps={{\n                        'aria-label': 'change date',\n                      }}\n                      minDate={fromDate}\n                      maxDate={toDate}\n                    />\n                  </MuiPickersUtilsProvider>\n                </ApiHighlight>\n              </Grid>\n              <Grid item sm={3}>\n                <ApiHighlight classes={classes}>\n                  <MuiPickersUtilsProvider utils={DateFnsUtils}>\n                    <KeyboardDatePicker\n                      disableToolbar\n                      variant=\"inline\"\n                      format=\"MM/dd/yyyy\"\n                      margin=\"normal\"\n                      id=\"toDate\"\n                      label=\"To date\"\n                      value={toDate}\n                      onChange={handleToDate}\n                      KeyboardButtonProps={{\n                        'aria-label': 'change date',\n                      }}\n                      minDate={fromDate}\n                      maxDate={toDate}\n                    />\n                  </MuiPickersUtilsProvider>\n                </ApiHighlight>\n              </Grid>\n            </>\n            : ''}\n        </Grid>\n      </ExpansionPanelDetails>\n    </ExpansionPanel >\n  )\n}\n\nfunction incrementDate(dateInput, increment) {\n  var dateFormatTotime = new Date(dateInput);\n  var increasedDate = new Date(dateFormatTotime.getTime() + (increment * 86400000));\n  return increasedDate.toISOString().split('T')[0];\n}"))}),[X,ee]);var se=function(e){N([]),e.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,o,r,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.inlineQuery).filters=Object(C.a)({},t.desiredFilterName,ee.user_attributes.brand),a=encodeURIComponent(JSON.stringify(n)),e.next=5,fetch("/runinlinequery/".concat(a,"/").concat(t.resultFormat),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return o=e.sent,e.next=8,o.json();case 8:for((r=e.sent).queryResults=r.queryResults.filter((function(e){return e[n.fields[0]]})),i=["All"],s=0;s<r.queryResults.length;s++)-1===i.indexOf(r.queryResults[s][n.fields[1]])&&i.push(r.queryResults[s][n.fields[1]]);r.inlineQuery=n,r.uniqueCategories=i,m(r.queryResults[r.queryResults.length-1][r.inlineQuery.fields[0]]),b(Gt(r.queryResults[0][r.inlineQuery.fields[0]],1)),N(r),0===V.length&&z(r.code);case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return o.a.createElement("div",{className:"".concat(Y.root," ").concat(Y.minHeight680,"   demoComponent")},o.a.createElement(me.a,{elevation:1,className:"".concat(Y.padding30," ")},o.a.createElement(ue.a,{container:!0,spacing:3,key:Lt(Z)},o.a.createElement("div",{className:"".concat(Y.root," ").concat(Y.positionRelative)},I.queryResults?o.a.createElement(Mt,Object.assign({},e,{classes:Y,apiContent:I,fromDate:s,toDate:h,category:y,desiredField:_,handleFromDate:function(e){if(Date.parse(e)>0){var t=Object(Pt.a)(Object(Rt.a)(new Date(e),1),"yyyy-MM-dd");m(t)}},handleToDate:function(e){if(Date.parse(e)>0){var t=Object(Pt.a)(Object(Rt.a)(new Date(e),1),"yyyy-MM-dd");b(t)}},handleCategory:function(e){v(e)},handleDesiredField:function(e){S(e)}})):o.a.createElement(it.a,{variant:"rect",animation:"wave",className:Y.skeleton}),I.queryResults?I.queryResults&&I.queryResults.length?o.a.createElement(j.a,{className:""},o.a.createElement(ue.a,{container:!0},J?o.a.createElement(ue.a,{item:!0,sm:6,className:"".concat(Y.positionTopRight)},o.a.createElement(ke,Object.assign({},e,{classes:Y,lookerUser:ee}))):"",o.a.createElement(te.a,{className:Y.divider}),o.a.createElement(ue.a,{item:!0,sm:12,className:Y.height600},o.a.createElement(j.a,{className:Y.w100,mt:2},o.a.createElement(Ne,{height:400,classes:Y},o.a.createElement(Ft.a,{data:ae,align:"top",from:Gt(s,1),to:Gt(h,1),emptyColor:"#eeeeee",colors:_===X[0].desiredFields[0]?["#4595EC","#F3A759","#E24E3A","#65AB5A"]:["#61cdbb","#97e3d5","#e8c1a0","#f47560"],yearSpacing:40,monthBorderColor:"#ffffff",dayBorderWidth:2,dayBorderColor:"#ffffff",margin:{bottom:40,left:40},legends:[{anchor:"bottom-right",direction:"row",translateY:36,itemCount:4,itemWidth:42,itemHeight:36,itemsSpacing:14,itemDirection:"right-to-left"}],onClick:function(e,t){e.value&&("basic"===ee.user_attributes.permission_level?Q({show:!0,permissionNeeded:"see_drill_overlay"}):(ne(e),t.stopPropagation()))}})))))):"":o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(me.a,{className:"".concat(Y.card," ").concat(Y.flexCentered),elevation:0},o.a.createElement(pe.a,{className:Y.circularProgress}))))),H?o.a.createElement(Dt,Object.assign({},e,{open:H,onClose:function(){U({}),P(!1)},classes:Y,modalContent:B})):""))}function Mt(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.staticContent.type,r=e.classes,i=e.apiContent,s=e.fromDate,l=e.toDate,c=e.category,d=e.desiredField,m=e.handleFromDate,u=e.handleToDate,p=e.handleCategory,h=e.handleDesiredField,b=Object(a.useState)(!0),g=Object(K.a)(b,2),f=g[0],y=g[1];return o.a.createElement(at.a,{expanded:f,onChange:function(e,t){y(!f)},className:r.w100,elevation:0},o.a.createElement(ot.a,{expandIcon:o.a.createElement(dt.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(X.a,{className:r.heading},"Filter Data")),o.a.createElement(rt.a,null,o.a.createElement(ue.a,{container:!0,spacing:3},i.queryResults?o.a.createElement(o.a.Fragment,null,o.a.createElement(ue.a,{item:!0,sm:3},o.a.createElement(Ne,{classes:r},o.a.createElement(gt.a,{className:r.formControl},o.a.createElement(ft.a,{id:"".concat(Lt(n+"-FilterBar-DataPropery-SelectLabel"))},"Metric"),o.a.createElement(yt.a,{labelId:"".concat(Lt(n+"-FilterBar-DataPropery-SelectLabel")),id:"".concat(Lt(n+"-FilterBar-DataPropery-Select")),value:d,onChange:function(e){return h(e.target.value)}},t[0].desiredFields.map((function(e,t){return o.a.createElement(ee.a,{id:Lt("".concat(e,"-").concat(t)),key:Lt("".concat(e,"-").concat(t)),value:e},e.substring(e.lastIndexOf(".")+1,e.length).split("_").map((function(e){return e.charAt(0).toUpperCase()+e.substring(1)})).join(" "))})))))),o.a.createElement(ue.a,{item:!0,sm:3},o.a.createElement(Ne,{classes:r},o.a.createElement(gt.a,{className:r.formControl},o.a.createElement(ft.a,{id:"".concat(Lt(n+"-FilterBar-Category-SelectLabel"))},"Category"),o.a.createElement(yt.a,{labelId:"".concat(Lt(n+"-FilterBar-Category-SelectLabel")),id:"".concat(Lt(n+"-FilterBar-Category-Select")),value:c,onChange:function(e){return p(e.target.value)}},i.uniqueCategories.map((function(e,t){return o.a.createElement(ee.a,{id:Lt("".concat(e,"-").concat(t)),key:Lt("".concat(e,"-").concat(t)),value:e},e)})))))),o.a.createElement(ue.a,{item:!0,sm:3},o.a.createElement(Ne,{classes:r},o.a.createElement(Bt.a,{utils:At.a},o.a.createElement(Ut.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"fromDate",label:"From date",value:s,onChange:m,KeyboardButtonProps:{"aria-label":"change date"},minDate:s,maxDate:l})))),o.a.createElement(ue.a,{item:!0,sm:3},o.a.createElement(Ne,{classes:r},o.a.createElement(Bt.a,{utils:At.a},o.a.createElement(Ut.a,{disableToolbar:!0,variant:"inline",format:"MM/dd/yyyy",margin:"normal",id:"toDate",label:"To date",value:l,onChange:u,KeyboardButtonProps:{"aria-label":"change date"},minDate:s,maxDate:l}))))):"")))}function Gt(e,t){var n=new Date(e);return new Date(n.getTime()+864e5*t).toISOString().split("T")[0]}var qt=n(1046),Vt=n(1025),zt=n(1026),Wt=n(1027),Qt=n(1028),Kt=n(389),Jt=n.n(Kt),Yt=Object(J.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},card:{minWidth:275,minHeight:800},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},skeleton:{minWidth:275,minHeight:600},ml24:{marginLeft:24},parentHoverVisibility:{"&:hover $childHoverVisibility":{visibility:"visible"}},childHoverVisibility:{visibility:"hidden"},faSm:{fontSize:".75em"},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"},padding30:{padding:30},mr12:{marginRight:12},ml12:{marginLeft:12}}}));function Xt(e){var t=e.children,n=e.value,a=e.index,r=Object(m.a)(e,["children","value","index"]);return o.a.createElement(X.a,Object.assign({component:"div",role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},r),o.a.createElement(j.a,{p:3},t))}n(260);var Zt=n(46).validIdHelper;function en(e){var t=Object(a.useState)(0),n=Object(K.a)(t,2),r=n[0],i=n[1],s=Object(a.useState)([]),m=Object(K.a)(s,2),u=m[0],p=m[1],h=Object(a.useState)({}),b=Object(K.a)(h,2),g=b[0],f=b[1],y=Object(a.useState)(""),C=Object(K.a)(y,2),v=(C[0],C[1]),x=Object(a.useState)(""),E=Object(K.a)(x,2),w=E[0],_=E[1],S=Object(a.useContext)(oe),O=S.togglePayWallModal,I=S.codeShow,N=Yt(),D=Object(a.useState)(0),F=Object(K.a)(D,2),H=F[0],P=F[1],R=(e.staticContent,e.staticContent.lookerContent),A=e.staticContent.type,B=e.activeTabValue,U=e.handleTabChange,L=e.lookerUser,$=e.lookerHost,M=A,G=Object(k.a)(R),q=function(e,t){1==t&&"premium"!=L.user_attributes.permission_level?O({show:!0,permissionNeeded:"explore"}):(U(t),P(t),H>0&&0===t&&z(R))};Object(a.useEffect)((function(){B>H&&P(B),setTimeout((function(){return z(R,1)}),100),v("import $ from 'jquery';\nimport _ from 'lodash'\nimport React, { useState, useEffect, useContext } from 'react';\nimport { AppBar, Tabs, Tab, Typography, Box, Grid, Icon, CircularProgress, Card, Button } from '@material-ui/core'\nimport { TreeView, TreeItem } from '@material-ui/lab';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight';\nimport { LookerEmbedSDK } from '@looker/embed-sdk'\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./ReportBuilder.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { TabPanel, a11yProps } from './helpers.js';\nimport '../../Home.css';\nimport { ApiHighlight, EmbedHighlight } from '../../Highlights/Highlight';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper } = require('../../../tools');\n\n//start of ReportBuilder Component\nexport default function ReportBuilder(props) {\n  //initialize state using hooks\n  const [iFrameExists, setIFrame] = useState(0);\n  const [apiContent, setApiContent] = useState([]);\n  const [exploreObj, setExploreObj] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n\n  const { togglePayWallModal, codeShow } = useContext(AppContext)\n\n  //declare constants\n  const classes = useStyles();\n  const [value, setValue] = useState(0);\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser, lookerHost } = props;\n\n  const demoComponentType = type;\n  const tabContent = [...lookerContent]\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n\n    if (newValue == 1 && lookerUser.user_attributes.permission_level != 'premium') {\n      // togglePayWallModal()\n\n      togglePayWallModal({\n        'show': true,\n        'permissionNeeded': 'explore'\n      });\n    } else {\n      handleTabChange(newValue);\n      setValue(newValue);\n      if (value > 0 && newValue === 0) performLookerApiCalls(lookerContent)\n    }\n  };\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    if (activeTabValue > value) {\n      setValue(activeTabValue)\n    }\n    setTimeout(() => performLookerApiCalls(lookerContent, 1), 100)\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent, lookerUser]);\n\n  const action = async (contentType, contentId, secondaryAction, qid, exploreId, newReportEmbedContainer) => {\n    let iFrameArray = $(\".embedContainer:visible > iframe\")\n\n    let matchingIndex = 0;\n    for (let i = 0; i < iFrameArray.length; i++) {\n      if (iFrameArray[i].classList.contains(contentType) && iFrameArray[i].classList.contains(contentId)) {\n        iFrameArray[i].classList.remove('dNone')\n        matchingIndex = i;\n      } else {\n        iFrameArray[i].classList.add('dNone')\n      }\n    }\n\n    if (secondaryAction === 'edit' || secondaryAction === 'explore') {\n      $(`#${newReportEmbedContainer}`).empty();\n\n      LookerEmbedSDK.createExploreWithId(exploreId)\n        .appendTo(`#${newReportEmbedContainer}`)\n        .withClassName('iframe')\n        .on('explore:state:changed', (event) => {\n        })\n        .withClassName(\"exploreIframe\")\n        .withParams({\n          qid: qid\n        })\n        .build()\n        .connect()\n        .then((explore) => {\n          setIFrame(1)\n          setExploreObj(explore)\n          LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n        })\n        .catch((error) => {\n          console.error('Connection error', error)\n        })\n      handleChange('edit', 1)\n    } else if (secondaryAction === 'delete') {\n      let lookerResponse = await fetch('/deletelook/' + contentId, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      });\n      if (lookerResponse.status === 200) {\n        performLookerApiCalls(lookerContent, 1)\n      }\n    }\n  }\n\n  const performLookerApiCalls = function (lookerContent, animateLoad) {\n    if (animateLoad) {\n      handleChange('refresh', 0)\n      setIFrame(0)\n      setApiContent([])\n    }\n\n    lookerContent.map(async lookerContent => {\n      if (lookerContent.type === 'folder') {\n        let lookerResponse = await fetch('/fetchfolder/' + lookerContent.id, {\n          method: 'GET',\n          headers: {\n            Accept: 'application/json',\n            'Content-Type': 'application/json'\n          }\n        })\n\n        let lookerResponseData = await lookerResponse.json();\n        if (serverSideCode.length === 0) setServerSideCode(lookerResponseData.code);\n\n        let looksToUse = [...lookerResponseData.sharedFolder.looks];\n        if (lookerUser.user_attributes.permission_level === 'premium' &&\n          Object.keys(lookerResponseData.embeddedUserFolder).length) {\n          looksToUse = [\n            ...looksToUse, ...lookerResponseData.embeddedUserFolder.looks\n          ]\n\n        }\n        let dashboardsToUse = [...lookerResponseData.sharedFolder.dashboards]\n        let objToUse = {\n          looks: looksToUse,\n          dashboards: dashboardsToUse\n        }\n        let iFrameArray = $(`.embedContainer.${validIdHelper(demoComponentType)} > iframe`);\n        if (objToUse.looks.length) {\n          objToUse.looks.map((item, index) => {\n\n            let lookId = item.id;\n            let lookIsRendered = false;\n            for (let i = 0; i < iFrameArray.length; i++) {\n              if (iFrameArray[i].classList.contains('look') && iFrameArray[i].classList.contains(lookId)) {\n                lookIsRendered = true;\n              }\n            }\n\n            if (!lookIsRendered) {\n              LookerEmbedSDK.createLookWithId(lookId)\n                .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n                .withClassName('iframe')\n                .withClassName('look')\n                .withClassName(lookerResponseData.sharedFolder.looks.indexOf(item) > -1 ? \"shared\" : \"personal\")\n                .withClassName(index > 0 ? 'dNone' : 'oops')\n                .withClassName(lookId)\n                .build()\n                .connect()\n                .then((look) => {\n                  // setIFrame(1)\n                  LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n                })\n                .catch((error) => {\n                  console.error('Connection error', error)\n                })\n            }\n\n            if (index === objToUse.looks.length - 1) {\n              setTimeout(() => setIFrame(1), 1000)\n            }\n          })\n        }\n\n        if (objToUse.dashboards.length) {\n          objToUse.dashboards.map((item, index) => {\n            let dashboardId = item.id\n            let dashboardIsRendered = false;\n            for (let i = 0; i < iFrameArray.length; i++) {\n              if (iFrameArray[i].classList.contains('dashboard') && iFrameArray[i].classList.contains(dashboardId)) {\n                dashboardIsRendered = true;\n              }\n            }\n            if (!dashboardIsRendered) {\n              LookerEmbedSDK.createDashboardWithId(dashboardId)\n                .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n                .withClassName('iframe')\n                .withClassName('dashboard')\n                .withClassName(lookerResponseData.sharedFolder.dashboards.indexOf(item) > -1 ? \"shared\" : \"personal\")\n                .withClassName('dNone')\n                .withClassName(dashboardId)\n                .build()\n                .connect()\n                .then((dashboard) => {\n                  setTimeout(() => {\n                    // setIFrame(1)\n                  }, 1000)\n                  LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n                })\n                .catch((error) => {\n                  console.error('Connection error', error)\n                })\n            }\n\n\n            if (index === objToUse.dashboards.length - 1) {\n              setTimeout(() => setIFrame(1), 1000)\n            }\n          })\n        }\n        setApiContent(objToUse)\n      } else if (lookerContent.type === 'explore' && lookerUser.user_attributes.permission_level === 'premium') {\n        let exploreId = lookerContent.id;\n        $(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`)).html('')\n        LookerEmbedSDK.createExploreWithId(exploreId)\n          .appendTo(validIdHelper(`#embedContainer-${demoComponentType}-${lookerContent.id}`))\n          .withClassName('iframe')\n          .on('explore:state:changed', (event) => {\n          })\n          .build()\n          .connect()\n          .then((explore) => {\n            setTimeout(() => setIFrame(1), 1000)\n            setExploreObj(exploreObj)\n            LookerEmbedSDK.init(`https://${lookerHost}.looker.com`);\n          })\n          .catch((error) => {\n            console.error('Connection error', error)\n          })\n      }\n    })\n  }\n\n\n  return (\n    <div className={`${classes.root} ${classes.minHeight680}   demoComponent`}>\n      <Card elevation={1} className={`${classes.padding30} `}>\n        <Grid container\n          spacing={3}\n          key={validIdHelper(type)} >\n          <div className={classes.root}>\n            {iFrameExists ? '' :\n              <Grid item sm={12} >\n                <Card className={`${classes.card} ${classes.flexCentered}`} elevation={0}>\n                  <CircularProgress className={classes.circularProgress} />\n                </Card>\n              </Grid>\n            }\n\n            {/* additional loading logic, need embedContainer to exist but want it hidden until iFrame has content...*/}\n            <Box className={iFrameExists ? `${classes.positionRelative}` : `${classes.hidden} ${classes.positionRelative}`}>\n              <AppBar position=\"static\" elevation={0}>\n                <Tabs\n                  className={classes.tabs}\n                  value={value}\n                  onChange={handleChange}\n                  aria-label=\"simple tabs example\">\n                  {tabContent.map((item, index) => (\n                    <Tab\n                      key={`${validIdHelper(demoComponentType + '-tab-' + index)}`}\n                      label={index == 1 ?\n                        <div>\n\n                          {lookerUser.user_attributes.permission_level != 'premium' ?\n                            <Icon className={`fa fa-lock ${classes.faSm} ${classes.mr12}`} /> : <Icon className={`fa fa-plus ${classes.faSm} ${classes.mr12}`} />}\n                          {item.label}\n                        </div> :\n                        item.label}\n                      className={value === 1 && index === 1 ? `${classes.hidden}` : index == 1 ? `${classes.mlAuto}` : ``}\n                      style={index === 1 ? {\n                        backgroundColor: '#5896E6',\n                        borderRadius: '4px',\n                        color: '#fff',\n                        opacity: '1.0'\n                      } : {}}\n                      {...a11yProps(index)} />\n                  ))}\n                </Tabs>\n              </AppBar>\n\n              <Box className=\"tabPanelContainer\">\n                {codeShow ? <Grid item sm={6}\n                  className={`${classes.positionTopRight}`}\n                >\n                  <CodeFlyout {...props}\n                    classes={classes}\n                    lookerUser={lookerUser} />\n                </Grid> : ''}\n                {tabContent.map((tabContentItem, tabContentItemIndex) => (\n                  <TabPanel\n                    key={`${validIdHelper(demoComponentType + '-tabPanel-' + tabContentItemIndex)}`}\n                    value={value}\n                    index={tabContentItemIndex}>\n                    <Grid container>\n                      {\n                        tabContentItemIndex === 0\n                          ?\n                          <React.Fragment\n                            key={`${validIdHelper(demoComponentType + '-outerFragment-' + tabContentItemIndex)}`}>\n                            <Grid item sm={4} >\n                              <ApiHighlight height={500} classes={classes}>\n                                <TreeSideBar {...{\n                                  togglePayWallModal,\n                                  classes,\n                                  demoComponentType,\n                                  tabContent,\n                                  tabContentItemIndex,\n                                  action,\n                                  apiContent,\n                                  ...props\n                                }}\n                                />\n                              </ApiHighlight>\n                            </Grid>\n                            <Grid item sm={8} >\n                              <EmbedHighlight classes={classes}>\n                                <div\n                                  className={`embedContainer ${validIdHelper(demoComponentType)}`}\n                                  id={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                  key={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                >\n                                </div>\n                              </EmbedHighlight>\n                            </Grid>\n                          </React.Fragment>\n                          :\n                          <Grid item sm={12} >\n                            <EmbedHighlight classes={classes}>\n                              <div\n                                className=\"embedContainer\"\n                                id={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                                key={validIdHelper(`embedContainer-${demoComponentType}-${tabContentItem.id}`)}\n                              >\n                              </div>\n                            </EmbedHighlight>\n                          </Grid>\n                      }\n                    </Grid>\n                  </TabPanel>\n                ))}\n              </Box>\n            </Box >\n          </div>\n        </Grid >\n      </Card>\n    </div >\n  )\n}\n\n\nfunction TreeSideBar(props) {\n  // console.log('TreeSideBar')\n  const { staticContent, staticContent: { lookerContent }, classes, demoComponentType, tabContent, tabContentItemIndex, action, apiContent, lookerUser, togglePayWallModal } = props\n  const sharedFolderId = lookerContent[0].type === 'folder' ? lookerContent[0].id : '';\n  let treeCounter = 0;\n  const [selected, setSelected] = useState(2)\n  const expandedArr = Object.keys(apiContent).length ? [\"1\", \"\" + (2 + apiContent[Object.keys(apiContent)[0]].length)] : [];\n  const [expanded, setExpanded] = useState(expandedArr);\n\n  const handleToggle = (event, nodeIds) => {\n    setExpanded(nodeIds);\n  }\n\n  const handleSelect = (event, nodeIds) => {\n    setSelected(nodeIds);\n  };\n\n\n  useEffect(() => {\n    setExpanded(expandedArr)\n  }, [apiContent]);\n\n  return (\n    <TreeView\n      className={classes.tree}\n      defaultCollapseIcon={<ExpandMoreIcon />}\n      defaultExpandIcon={<ChevronRightIcon />}\n      expanded={expanded}\n      onNodeToggle={handleToggle}\n      onNodeSelect={handleSelect}\n    >\n      {apiContent ? Object.keys(apiContent).map((key, outerIndex) => (\n        <React.Fragment\n          key={`${validIdHelper(demoComponentType + '-innerFragment-' + outerIndex)}`}>\n          <TreeItem\n            key={`${validIdHelper(demoComponentType + '-outerTreeItem-' + outerIndex)}`}\n            nodeId={\"\" + (treeCounter += 1)}\n            // treecounter={treeCounter}\n            label={_.capitalize(key)}\n            icon={<Icon className={`fa fa-folder ${classes.icon}`} />}\n            disabled={apiContent[key].length ? false : true}\n          >\n            {\n              apiContent[key].length ?\n                apiContent[key].map((item, index) => (\n                  <TreeItem\n                    key={`${validIdHelper(demoComponentType + '-innerTreeItem-' + treeCounter)}`}\n                    nodeId={\"\" + (treeCounter += 1)}\n                    treecounter={treeCounter}\n                    selected={selected === treeCounter}\n                    className={selected === treeCounter ? `Mui-selected innerTreeItem` : `innerTreeItem`}\n                    contentid={item.id}\n                    label={item.folder_id === sharedFolderId &&\n                      key === 'looks' ?\n\n                      < div\n                        id={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                        key={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                        className={`${classes.labelRoot} ${classes.parentHoverVisibility}`}>\n                        {item.title.length > 15 ? item.title.substring(0, 15) + '...' : item.title}\n\n                        <Button\n                          id={`${validIdHelper(demoComponentType + '-innerTreeItem-Explore' + treeCounter)}`}\n                          key={`${validIdHelper(demoComponentType + '-innerTreeItem-Explore' + treeCounter)}`}\n                          size=\"small\"\n                          className={`${classes.ml12} ${classes.childHoverVisibility}`}\n                          onClick={(event) => {\n                            if (lookerUser.user_attributes.permission_level === 'premium') {\n                              // setSelected(treeCounter);\n                              action(\n                                key.substring(0, key.length - 1),\n                                item.id,\n                                'explore',\n                                item.client_id,\n                                tabContent[tabContentItemIndex + 1].id,\n                                validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                              );\n                              event.stopPropagation();\n                            } else {\n                              // togglePayWallModal();\n\n                              togglePayWallModal({\n                                'show': true,\n                                'permissionNeeded': 'explore'\n                              });\n                            }\n                          }\n                          }\n                          color=\"default\"\n                        >\n                          {lookerUser.user_attributes.permission_level === 'premium' ? 'Explore' : <div> <Icon className={`fa fa-lock ${classes.faSm} ${classes.mr12}`} />Explore</div>}\n                        </Button>\n                      </div>\n                      : key === 'looks' ?\n                        <div\n                          id={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                          key={`${validIdHelper(demoComponentType + '-innerTreeItem-LabelContainer' + treeCounter)}`}\n                          className={`${classes.labelRoot} ${classes.parentHoverVisibility}`}>\n\n                          {item.title.length > 15 ? item.title.substring(0, 15) + '...' : item.title}                          <Button\n                            id={`${validIdHelper(demoComponentType + '-innerTreeItem-EditButton' + treeCounter)}`}\n                            key={`${validIdHelper(demoComponentType + '-innerTreeItem-EditButton' + treeCounter)}`}\n                            size=\"small\"\n                            className={`${classes.ml12} ${classes.childHoverVisibility}`}\n                            onClick={(event) => {\n                              if (lookerUser.user_attributes.permission_level === 'premium') {\n                                // setSelected(treeCounter);\n                                action(\n                                  key.substring(0, key.length - 1),\n                                  item.id,\n                                  'edit',\n                                  item.client_id,\n                                  tabContent[tabContentItemIndex + 1].id,\n                                  validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                                );\n                                event.stopPropagation();\n                              } else {\n                                // togglePayWallModal();\n\n                                togglePayWallModal({\n                                  'show': true,\n                                  'permissionNeeded': 'explore'\n                                });\n                              }\n                            }\n                            }\n                            color=\"primary\"\n                          >\n                            Edit\n                                                                                            </Button>\n                          <Button\n                            id={`${validIdHelper(demoComponentType + '-innerTreeItem-DeleteButton' + treeCounter)}`}\n                            key={`${validIdHelper(demoComponentType + '-innerTreeItem-DeleteButton' + treeCounter)}`}\n                            size=\"small\"\n                            className={`${classes.ml12} ${classes.childHoverVisibility}`}\n                            onClick={(event) => {\n                              if (lookerUser.user_attributes.permission_level === 'premium') {\n                                // setSelected(treeCounter);\n                                action(\n                                  key.substring(0, key.length - 1),\n                                  item.id,\n                                  'delete',\n                                  item.client_id,\n                                  tabContent[tabContentItemIndex + 1].id,\n                                  validIdHelper(`embedContainer-${demoComponentType}-${tabContent[tabContentItemIndex + 1].id}`)\n                                );\n                                event.stopPropagation();\n                              } else {\n                                // togglePayWallModal();\n\n                                togglePayWallModal({\n                                  'show': true,\n                                  'permissionNeeded': 'explore'\n                                });\n                              }\n                            }\n                            }\n                            color=\"secondary\"\n                          >\n                            Delete\n                                                                                            </Button>\n                        </div>\n                        : item.title.length > 15 ? item.title.substring(0, 15) + '...' : item.title\n                    }\n                    onClick={() => {\n                      // setSelected(treeCounter)\n                      action(\n                        key.substring(0, key.length - 1), item.id)\n                    }} />\n\n                ))\n                :\n                ''\n            }\n          </TreeItem>\n\n        </React.Fragment>\n      )) : ''}\n    </TreeView>\n  )\n}")}),[R,L]);var V=function(){var e=Object(d.a)(l.a.mark((function e(t,n,a,o,r,s){var c,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(c=de()(".embedContainer:visible > iframe"),0,d=0;d<c.length;d++)c[d].classList.contains(t)&&c[d].classList.contains(n)?(c[d].classList.remove("dNone"),d):c[d].classList.add("dNone");if("edit"!==a&&"explore"!==a){e.next=9;break}de()("#".concat(s)).empty(),se.LookerEmbedSDK.createExploreWithId(r).appendTo("#".concat(s)).withClassName("iframe").on("explore:state:changed",(function(e){})).withClassName("exploreIframe").withParams({qid:o}).build().connect().then((function(e){i(1),f(e),se.LookerEmbedSDK.init("https://".concat($,".looker.com"))})).catch((function(e){console.error("Connection error",e)})),q(0,1),e.next=14;break;case 9:if("delete"!==a){e.next=14;break}return e.next=12,fetch("/deletelook/"+n,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 12:200===e.sent.status&&z(R,1);case 14:case"end":return e.stop()}}),e)})));return function(t,n,a,o,r,i){return e.apply(this,arguments)}}(),z=function(e,t){t&&(q(0,0),i(0),p([])),e.map(function(){var e=Object(d.a)(l.a.mark((function e(t){var n,a,o,r,s,c,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("folder"!==t.type){e.next=18;break}return e.next=3,fetch("/fetchfolder/"+t.id,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 3:return n=e.sent,e.next=6,n.json();case 6:a=e.sent,0===w.length&&_(a.code),o=Object(k.a)(a.sharedFolder.looks),"premium"===L.user_attributes.permission_level&&Object.keys(a.embeddedUserFolder).length&&(o=[].concat(Object(k.a)(o),Object(k.a)(a.embeddedUserFolder.looks))),r=Object(k.a)(a.sharedFolder.dashboards),s={looks:o,dashboards:r},c=de()(".embedContainer.".concat(Zt(M)," > iframe")),s.looks.length&&s.looks.map((function(e,n){for(var o=e.id,r=!1,l=0;l<c.length;l++)c[l].classList.contains("look")&&c[l].classList.contains(o)&&(r=!0);r||se.LookerEmbedSDK.createLookWithId(o).appendTo(Zt("#embedContainer-".concat(M,"-").concat(t.id))).withClassName("iframe").withClassName("look").withClassName(a.sharedFolder.looks.indexOf(e)>-1?"shared":"personal").withClassName(n>0?"dNone":"oops").withClassName(o).build().connect().then((function(e){se.LookerEmbedSDK.init("https://".concat($,".looker.com"))})).catch((function(e){console.error("Connection error",e)})),n===s.looks.length-1&&setTimeout((function(){return i(1)}),1e3)})),s.dashboards.length&&s.dashboards.map((function(e,n){for(var o=e.id,r=!1,l=0;l<c.length;l++)c[l].classList.contains("dashboard")&&c[l].classList.contains(o)&&(r=!0);r||se.LookerEmbedSDK.createDashboardWithId(o).appendTo(Zt("#embedContainer-".concat(M,"-").concat(t.id))).withClassName("iframe").withClassName("dashboard").withClassName(a.sharedFolder.dashboards.indexOf(e)>-1?"shared":"personal").withClassName("dNone").withClassName(o).build().connect().then((function(e){setTimeout((function(){}),1e3),se.LookerEmbedSDK.init("https://".concat($,".looker.com"))})).catch((function(e){console.error("Connection error",e)})),n===s.dashboards.length-1&&setTimeout((function(){return i(1)}),1e3)})),p(s),e.next=19;break;case 18:"explore"===t.type&&"premium"===L.user_attributes.permission_level&&(d=t.id,de()(Zt("#embedContainer-".concat(M,"-").concat(t.id))).html(""),se.LookerEmbedSDK.createExploreWithId(d).appendTo(Zt("#embedContainer-".concat(M,"-").concat(t.id))).withClassName("iframe").on("explore:state:changed",(function(e){})).build().connect().then((function(e){setTimeout((function(){return i(1)}),1e3),f(g),se.LookerEmbedSDK.init("https://".concat($,".looker.com"))})).catch((function(e){console.error("Connection error",e)})));case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return o.a.createElement("div",{className:"".concat(N.root," ").concat(N.minHeight680,"   demoComponent")},o.a.createElement(me.a,{elevation:1,className:"".concat(N.padding30," ")},o.a.createElement(ue.a,{container:!0,spacing:3,key:Zt(A)},o.a.createElement("div",{className:N.root},r?"":o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(me.a,{className:"".concat(N.card," ").concat(N.flexCentered),elevation:0},o.a.createElement(pe.a,{className:N.circularProgress}))),o.a.createElement(j.a,{className:r?"".concat(N.positionRelative):"".concat(N.hidden," ").concat(N.positionRelative)},o.a.createElement(T.a,{position:"static",elevation:0},o.a.createElement(qt.a,{className:N.tabs,value:H,onChange:q,"aria-label":"simple tabs example"},G.map((function(e,t){return o.a.createElement(Vt.a,Object.assign({key:"".concat(Zt(M+"-tab-"+t)),label:1==t?o.a.createElement("div",null,"premium"!=L.user_attributes.permission_level?o.a.createElement(zt.a,{className:"fa fa-lock ".concat(N.faSm," ").concat(N.mr12)}):o.a.createElement(zt.a,{className:"fa fa-plus ".concat(N.faSm," ").concat(N.mr12)}),e.label):e.label,className:1===H&&1===t?"".concat(N.hidden):1==t?"".concat(N.mlAuto):"",style:1===t?{backgroundColor:"#5896E6",borderRadius:"4px",color:"#fff",opacity:"1.0"}:{}},function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}(t)))})))),o.a.createElement(j.a,{className:"tabPanelContainer"},I?o.a.createElement(ue.a,{item:!0,sm:6,className:"".concat(N.positionTopRight)},o.a.createElement(ke,Object.assign({},e,{classes:N,lookerUser:L}))):"",G.map((function(t,n){return o.a.createElement(Xt,{key:"".concat(Zt(M+"-tabPanel-"+n)),value:H,index:n},o.a.createElement(ue.a,{container:!0},0===n?o.a.createElement(o.a.Fragment,{key:"".concat(Zt(M+"-outerFragment-"+n))},o.a.createElement(ue.a,{item:!0,sm:4},o.a.createElement(Ne,{height:500,classes:N},o.a.createElement(tn,Object(c.a)({togglePayWallModal:O,classes:N,demoComponentType:M,tabContent:G,tabContentItemIndex:n,action:V,apiContent:u},e)))),o.a.createElement(ue.a,{item:!0,sm:8},o.a.createElement(De,{classes:N},o.a.createElement("div",{className:"embedContainer ".concat(Zt(M)),id:Zt("embedContainer-".concat(M,"-").concat(t.id)),key:Zt("embedContainer-".concat(M,"-").concat(t.id))})))):o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(De,{classes:N},o.a.createElement("div",{className:"embedContainer",id:Zt("embedContainer-".concat(M,"-").concat(t.id)),key:Zt("embedContainer-".concat(M,"-").concat(t.id))})))))}))))))))}function tn(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.classes,r=e.demoComponentType,i=e.tabContent,s=e.tabContentItemIndex,l=e.action,c=e.apiContent,d=e.lookerUser,m=e.togglePayWallModal,u="folder"===t[0].type?t[0].id:"",p=0,h=Object(a.useState)(2),b=Object(K.a)(h,2),g=b[0],f=b[1],y=Object.keys(c).length?["1",""+(2+c[Object.keys(c)[0]].length)]:[],C=Object(a.useState)(y),k=Object(K.a)(C,2),v=k[0],E=k[1];return Object(a.useEffect)((function(){E(y)}),[c]),o.a.createElement(Wt.a,{className:n.tree,defaultCollapseIcon:o.a.createElement(dt.a,null),defaultExpandIcon:o.a.createElement(Jt.a,null),expanded:v,onNodeToggle:function(e,t){E(t)},onNodeSelect:function(e,t){f(t)}},c?Object.keys(c).map((function(e,t){return o.a.createElement(o.a.Fragment,{key:"".concat(Zt(r+"-innerFragment-"+t))},o.a.createElement(Qt.a,{key:"".concat(Zt(r+"-outerTreeItem-"+t)),nodeId:""+(p+=1),label:x.a.capitalize(e),icon:o.a.createElement(zt.a,{className:"fa fa-folder ".concat(n.icon)}),disabled:!c[e].length},c[e].length?c[e].map((function(t,a){return o.a.createElement(Qt.a,{key:"".concat(Zt(r+"-innerTreeItem-"+p)),nodeId:""+(p+=1),treecounter:p,selected:g===p,className:g===p?"Mui-selected innerTreeItem":"innerTreeItem",contentid:t.id,label:t.folder_id===u&&"looks"===e?o.a.createElement("div",{id:"".concat(Zt(r+"-innerTreeItem-LabelContainer"+p)),key:"".concat(Zt(r+"-innerTreeItem-LabelContainer"+p)),className:"".concat(n.labelRoot," ").concat(n.parentHoverVisibility)},t.title.length>15?t.title.substring(0,15)+"...":t.title,o.a.createElement(Ye.a,{id:"".concat(Zt(r+"-innerTreeItem-Explore"+p)),key:"".concat(Zt(r+"-innerTreeItem-Explore"+p)),size:"small",className:"".concat(n.ml12," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.user_attributes.permission_level?(l(e.substring(0,e.length-1),t.id,"explore",t.client_id,i[s+1].id,Zt("embedContainer-".concat(r,"-").concat(i[s+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"default"},"premium"===d.user_attributes.permission_level?"Explore":o.a.createElement("div",null," ",o.a.createElement(zt.a,{className:"fa fa-lock ".concat(n.faSm," ").concat(n.mr12)}),"Explore"))):"looks"===e?o.a.createElement("div",{id:"".concat(Zt(r+"-innerTreeItem-LabelContainer"+p)),key:"".concat(Zt(r+"-innerTreeItem-LabelContainer"+p)),className:"".concat(n.labelRoot," ").concat(n.parentHoverVisibility)},t.title.length>15?t.title.substring(0,15)+"...":t.title,"                          ",o.a.createElement(Ye.a,{id:"".concat(Zt(r+"-innerTreeItem-EditButton"+p)),key:"".concat(Zt(r+"-innerTreeItem-EditButton"+p)),size:"small",className:"".concat(n.ml12," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.user_attributes.permission_level?(l(e.substring(0,e.length-1),t.id,"edit",t.client_id,i[s+1].id,Zt("embedContainer-".concat(r,"-").concat(i[s+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"primary"},"Edit"),o.a.createElement(Ye.a,{id:"".concat(Zt(r+"-innerTreeItem-DeleteButton"+p)),key:"".concat(Zt(r+"-innerTreeItem-DeleteButton"+p)),size:"small",className:"".concat(n.ml12," ").concat(n.childHoverVisibility),onClick:function(n){"premium"===d.user_attributes.permission_level?(l(e.substring(0,e.length-1),t.id,"delete",t.client_id,i[s+1].id,Zt("embedContainer-".concat(r,"-").concat(i[s+1].id))),n.stopPropagation()):m({show:!0,permissionNeeded:"explore"})},color:"secondary"},"Delete")):t.title.length>15?t.title.substring(0,15)+"...":t.title,onClick:function(){l(e.substring(0,e.length-1),t.id)}})})):""))})):"")}var nn=n(1059),an=n(1060),on=n(155),rn=n.n(on),sn=n(209),ln=(W.a[400],W.a[100],sn.a[400],sn.a[100],Object(J.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},heading:{fontSize:e.typography.pxToRem(15),fontWeight:e.typography.fontWeightRegular},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},hidden:{visibility:"hidden",position:"absolute",zIndex:-1},tabs:{backgroundColor:"white",color:"#6c757d"},dNone:{display:"none"},dBlock:{display:"block"},tree:{height:240,flexGrow:1,maxWidth:400},icon:{marginRight:12,fontSize:"1rem",overflow:"visible"},ml12:{marginLeft:12},mt12:{marginTop:12},w100:{width:"100%"},mlAuto:{marginLeft:"auto"},table:{minWidth:650},tableContainer:{maxHeight:650},visuallyHidden:{border:0,clip:"rect(0 0 0 0)",height:1,margin:-1,overflow:"hidden",padding:0,position:"absolute",top:20,width:1},formControl:{margin:e.spacing(1),minWidth:120},skeleton:{minWidth:275,minHeight:600},card:{minWidth:275,minHeight:600},textCenter:{textAlign:"center"},bluePrimary:{backgroundColor:"rgba(69, 149, 236, 1)"},blueSecondary:{backgroundColor:"rgba(69, 149, 236, .5)"},orangePrimary:{backgroundColor:"rgba(243, 167, 89, 1)"},orangeSecondary:{backgroundColor:"rgba(243, 167, 89, .5)"},positionTopRight:{position:"absolute",top:-30,right:-50,bottom:0,zIndex:100},positionRelative:{position:"relative"},bottomBarSpacer:Object(c.a)(Object(c.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),maxHeight600:{maxHeight:600,overflow:"scroll"},padding30:{padding:30},m12:{margin:12},m6:{margin:6}}})));function cn(e,t,n){return e[n]&&t[n]&&t[n].value<e[n].value?-1:e[n]&&t[n]&&t[n].value>e[n].value?1:0}var dn=n(46),mn=dn.validIdHelper,un=dn.prettifyString;function pn(e){var t=Object(a.useState)(0),n=Object(K.a)(t,2),r=(n[0],n[1],Object(a.useState)({})),i=Object(K.a)(r,2),s=i[0],m=i[1],u=Object(a.useState)(""),p=Object(K.a)(u,2),h=(p[0],p[1]),b=Object(a.useState)(""),g=Object(K.a)(b,2),f=(g[0],g[1]),y=Object(a.useContext)(oe),C=(y.togglePayWallModal,y.show,y.codeShow),k=ln(),v=(e.staticContent,e.staticContent.lookerContent),x=e.staticContent.type,E=(e.activeTabValue,e.handleTabChange,e.lookerUser);Object(a.useEffect)((function(){v.map((function(e){setTimeout((function(){return w(e.queryBody,e.resultFormat)}),100)})),h("import $ from 'jquery';\nimport _ from 'lodash';\nimport React, { useState, useEffect, useContext } from 'react';\nimport PropTypes from 'prop-types';\nimport {\n  AppBar, Tabs, Tab, Typography, Box, Grid, Icon, CircularProgress, Card, Button,\n  ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails, InputLabel, MenuItem, FormControl,\n  Select, Table, TableBody, TableCell, TableContainer, TableHead, TablePagination, TableRow,\n  TableSortLabel, FormControlLabel, Switch, Chip, Divider\n} from '@material-ui/core'\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ExpandLessIcon from '@material-ui/icons/ExpandMore';\nimport DoneIcon from '@material-ui/icons/Done';\nimport CodeFlyout from '../CodeFlyout';\nimport rawSampleCode from '!!raw-loader!./QueryBuilder.js'; // eslint-disable-line import/no-webpack-loader-syntax\nimport useStyles from './styles.js';\nimport { ApiHighlight } from '../../Highlights/Highlight';\nimport { TabPanel, a11yProps, descendingComparator, getComparator, stableSort } from './helpers.js';\nimport AppContext from '../../../AppContext';\nconst { validIdHelper, prettifyString } = require('../../../tools');\n\n//start of QueryBuilder Component\nexport default function QueryBuilder(props) {\n  // console.log('QueryBuilder')\n  // console.log('props', props)\n\n  //initialize state using hooks\n  const [value, setValue] = useState(0);\n  const [apiContent, setApiContent] = useState({});\n  const [clientSideCode, setClientSideCode] = useState('');\n  const [serverSideCode, setServerSideCode] = useState('');\n  const { togglePayWallModal, show, codeShow } = useContext(AppContext)\n  //declare constants\n\n  const classes = useStyles();\n  const { staticContent, staticContent: { lookerContent }, staticContent: { type }, activeTabValue, handleTabChange, lookerUser } = props;\n\n  //handle tab change\n  const handleChange = (event, newValue) => {\n    handleTabChange(0);\n    setValue(newValue);\n  };\n\n  /**\n   * listen for lookerContent and call \n   * performLookerApiCalls and setSampleCode\n  */\n  useEffect(() => {\n    lookerContent.map(lookerContent => {\n      setTimeout(() => performLookerApiCalls(lookerContent.queryBody, lookerContent.resultFormat), 100);\n    })\n    setClientSideCode(rawSampleCode)\n  }, [lookerContent, lookerUser])\n\n  const performLookerApiCalls = async (newQuery, resultFormat) => {\n    // console.log('performLookerApiCalls')\n    let apiContentCopy = { ...apiContent }\n    apiContentCopy.status = 'running';\n    setApiContent(apiContentCopy)\n\n    let lookerCreateTaskResposnse = await fetch('/createquerytask/' + JSON.stringify(newQuery), {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json',\n        'Content-Type': 'application/json'\n      }\n    })\n    let lookerCreateTaskResponseData = await lookerCreateTaskResposnse.json();\n\n    let taskInterval = setInterval(async () => {\n      let lookerCheckTaskResposnse = await fetch('/checkquerytask/' + lookerCreateTaskResponseData.queryTaskId, {\n        method: 'GET',\n        headers: {\n          Accept: 'application/json',\n          'Content-Type': 'application/json'\n        }\n      })\n      let lookerCheckTaskResponseData = await lookerCheckTaskResposnse.json();\n      if (lookerCheckTaskResponseData.queryResults.status === 'complete') {\n        clearInterval(taskInterval);\n        setApiContent(lookerCheckTaskResponseData.queryResults)\n        setServerSideCode(lookerCreateTaskResponseData.code)\n      }\n    }, 5000)\n  }\n\n  return (\n    <div className={`${classes.root} ${classes.minHeight680}   demoComponent`}>\n      <Card elevation={1} className={`${classes.padding30} `}>\n        <Grid container\n          spacing={3}\n          key={validIdHelper(type)} >\n          <div className={`${classes.root} ${classes.positionRelative}`}>\n            <Grid item sm={12}>\n              <FilterBar {...props}\n                classes={classes}\n                action={performLookerApiCalls}\n              />\n            </Grid>\n            {apiContent.status === 'running' ?\n              <Grid item sm={12} >\n                <Card className={`${classes.card} ${classes.flexCentered}`} elevation={0}>\n                  <CircularProgress className={classes.circularProgress} />\n                </Card>\n              </Grid >\n              : apiContent.data && apiContent.data.length ?\n                <Box\n                >\n                  <Grid container>\n                    {codeShow ? <Grid item sm={6}\n                      className={`${classes.positionTopRight}`}\n                    >\n                      <CodeFlyout {...props}\n                        classes={classes}\n                        lookerUser={lookerUser} />\n                    </Grid> : ''}\n                    <Divider className={classes.divider} />\n                    <Grid item sm={12}>\n                      <Box className={`${classes.w100} ${classes.maxHeight600} ${classes.padding30}`} mt={2}>\n                        <EnhancedTable\n                          {...props}\n                          classes={classes}\n                          rows={apiContent.data}\n                          lookerContent={lookerContent}\n                        />\n                      </Box>\n                    </Grid>\n                  </Grid>\n                </Box>\n                :\n                <Grid item sm={12} >\n                  <Typography variant=\"h6\" component=\"h6\" className={`${classes.gridTitle} ${classes.textCenter}`}>\n                    No results found, try a new query<br />\n                  </Typography>\n                </Grid>\n            }\n          </div >\n        </Grid >\n      </Card>\n    </div >\n  )\n}\n\n\nfunction FilterBar(props) {\n  const { staticContent, staticContent: { lookerContent }, classes, action, lookerUser } = props;\n  let measureCounter = 0;\n  let dimensionCounter = 0;\n\n  const [expanded, setExpanded] = useState(true);\n  const [fieldsChipData, setFieldsChipData] = useState(lookerContent[0].queryBody ? lookerContent[0].queryBody.fields.map((item, index) => {\n    return {\n      key: 'fieldChipData' + index,\n      label: prettifyString(item.substring(item.lastIndexOf('.') + 1, item.length)),\n      datalabel: item,\n      selected: true,\n      fieldType: lookerContent[0].fieldType[item]\n    }\n  }) : '');\n\n  const [queryModified, setQueryModified] = useState(false);\n  const [filtersData, setFilterData] = useState(lookerContent[0].queryBody ? Object.keys(lookerContent[0].queryBody.filters).map((key, index) => {\n    return {\n      key: 'filter' + index,\n      label: key,\n      value: lookerContent[0].queryBody.filters[key],\n      type: lookerContent[0].filterType[key]\n    }\n  }) : '')\n\n  const handleExpansionPanel = (event, newValue) => {\n    setExpanded(expanded ? false : true);\n  };\n\n  const handleFieldChipClick = (chip, index) => {\n    let updatedFieldsChipData = [...fieldsChipData]\n    updatedFieldsChipData[index].selected = updatedFieldsChipData[index].selected === false ? true : false\n    setFieldsChipData(updatedFieldsChipData)\n    setQueryModified(true)\n  }\n\n  const handleSelectChange = (index, newValue) => {\n    let updatedFiltersData = [...filtersData]\n    updatedFiltersData[index].value = newValue;\n    setFilterData(updatedFiltersData)\n    setQueryModified(true)\n  }\n\n  const handleQuerySubmit = (event) => {\n    if (queryModified) {\n      let newFields = fieldsChipData.filter(chip => chip.selected).map(item => item.datalabel);\n      let currentFilters = {}; //needs to be object\n      filtersData.map((item, index) => {\n        currentFilters[item.label] = item.value\n      })\n      let newQueryObj = lookerContent[0].queryBody;\n      newQueryObj.fields = newFields;\n      newQueryObj.filters = currentFilters;\n      action(newQueryObj, lookerContent[0].resultFormat);\n      setQueryModified(false)\n    }\n  }\n\n  // useEffect(() => {\n  //   handleQuerySubmit()\n  // }, [fieldsChipData, filtersData]);\n\n  const datePermissionMap = {\n    'basic': [\"1 week\", \"1 month\", \"3 months\", \"6 months\"]\n  }\n  datePermissionMap.advanced = [...datePermissionMap.basic, \"1 year\"]\n  datePermissionMap.premium = [...datePermissionMap.advanced, \"before today\"]\n\n  useEffect(() => {\n    let updatedFiltersData = [...filtersData]\n    updatedFiltersData[3].value = \"6 months\";\n    setFilterData(updatedFiltersData)\n  }, [lookerUser]);\n\n  return (\n    <ExpansionPanel expanded={expanded} onChange={handleExpansionPanel} elevation={0}>\n      <ExpansionPanelSummary\n        expandIcon={<ExpandMoreIcon />}\n        aria-controls=\"panel1a-content\"\n        id=\"panel1a-header\"\n      >\n        <Typography className={classes.heading}>Build Query</Typography>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails>\n        <Grid container spacing={3}>\n          <Grid item sm={12}>\n            <Typography variant=\"subtitle1\">\n              Select Metrics:\n      {fieldsChipData.length ?\n                fieldsChipData.map((item, index) => {\n                  return (\n                    item.fieldType === 'measure' ?\n                      <Chip\n                        key={item.label}\n                        // key={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        measurecounter={measureCounter += 1}\n                        className={item.selected ? `${classes.orangePrimary} ${classes.m6}` : `${classes.m6}`}\n                        label={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        datalabel={item.label}\n                        onClick={() => handleFieldChipClick(item, index)}\n                        icon={item.selected ? <DoneIcon className={classes.dBlock} /> : <DoneIcon className={classes.dNone} />}\n                      /> : ''\n                  )\n                }) : ''\n              }<br />\n            </Typography>\n          </Grid>\n          <Grid item sm={12}>\n            <Typography variant=\"subtitle1\">\n              Group By:\n                          {fieldsChipData.length ?\n                fieldsChipData.map((item, index) => {\n                  return (\n                    item.fieldType === 'dimension' ?\n                      <Chip\n                        key={item.label}\n                        dimensioncounter={dimensionCounter += 1}\n                        className={item.selected ? `${classes.bluePrimary} ${classes.m6}` : `${classes.m6}`}\n                        label={prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}\n                        datalabel={item.label}\n                        onClick={() => handleFieldChipClick(item, index)}\n                        icon={item.selected ? <DoneIcon className={classes.dBlock} /> : <DoneIcon className={classes.dNone} />}\n                      /> : ''\n                  )\n                }) : ''\n              }<br />\n            </Typography>\n          </Grid>\n\n          <Grid item sm={3}>\n            <Typography variant=\"subtitle1\">\n              Filter By:\n                      </Typography>\n            {filtersData.length ? filtersData.map((item, index) => {\n              return (\n                <FormControl className={item.value.length ? classes.formControl : classes.hidden} key={validIdHelper(`${item.label}FormControl`)}>\n                  {\n                    item.type === 'yesno' ?\n                      <>\n                        <InputLabel id={validIdHelper(`${item.label}FilterLabel`)}>{prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}:</InputLabel>\n                        <Select\n                          labelId={validIdHelper(`${item.label}FilterLabel`)}\n                          id={validIdHelper(`${item.label}FilterSelect`)}\n                          value={item.value}\n                          onChange={(event) => handleSelectChange(index, event.target.value)}\n                        >\n                          <MenuItem value=\"Yes\">Yes</MenuItem>\n                          <MenuItem value=\"No\">No</MenuItem>\n                          <MenuItem value=\"All\">All</MenuItem>\n                        </Select>\n                      </>\n                      : item.type === 'date' ?\n                        <>\n                          <InputLabel id={validIdHelper(`${item.label}FilterLabel`)}>{prettifyString(item.label.substring(item.label.lastIndexOf('.') + 1, item.label.length))}:</InputLabel>\n\n                          <Select\n                            labelId={validIdHelper(`${item.label}FilterLabel`)}\n                            id={validIdHelper(`${item.label}FilterSelect`)}\n                            value={item.value || '6 months'}\n                            onChange={(event) => handleSelectChange(index, event.target.value)}\n                          >\n                            {lookerUser.user_attributes.permission_level ? datePermissionMap[lookerUser.user_attributes.permission_level].map(item => (\n                              <MenuItem key={validIdHelper(item)} value={item}>{_.capitalize(item)}</MenuItem>\n                            )) : ''}\n                          </Select>\n                        </>\n                        : ''\n                  }\n                </FormControl>\n              )\n            }) : ''}\n          </Grid>\n          <Grid item sm={9}>\n            <br />\n            <Button\n              color=\"primary\"\n              variant=\"contained\"\n              size=\"large\"\n              onClick={handleQuerySubmit}\n              disabled={queryModified ? false : true}\n            >Run Query</Button></Grid>\n        </Grid>\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  )\n}\n\nfunction EnhancedTableHead(props) {\n  const { classes, onSelectAllClick, order, orderBy, numSelected, rowCount, onRequestSort, rows } = props;\n  const createSortHandler = (property) => (event) => {\n    onRequestSort(event, property);\n  };\n\n  return (\n    <TableHead>\n      <TableRow>\n        {Object.keys(rows[0]).map((key, index) => (\n          <TableCell\n            key={validIdHelper(key + '-TableHead-TableCell-' + index)}\n            id={validIdHelper(key + '-TableHead-TableCell-' + index)}\n            align={key.numeric ? 'right' : 'left'}\n            padding={key.disablePadding ? 'none' : 'default'}\n            sortDirection={orderBy === key ? order : false}\n          >\n            <TableSortLabel\n              active={orderBy === key}\n              direction={orderBy === key ? order : 'asc'}\n              onClick={createSortHandler(key)}\n            >\n              {prettifyString(key.substring(key.lastIndexOf('.') + 1, key.length))}\n              {orderBy === key ? (\n                <span className={classes.visuallyHidden}>\n                  {order === 'desc' ? 'sorted descending' : 'sorted ascending'}\n                </span>\n              ) : null}\n            </TableSortLabel>\n          </TableCell>\n        ))}\n      </TableRow>\n    </TableHead>\n  );\n}\n\nEnhancedTableHead.propTypes = {\n  classes: PropTypes.object.isRequired,\n  // numSelected: PropTypes.number.isRequired,\n  onRequestSort: PropTypes.func.isRequired,\n  // onSelectAllClick: PropTypes.func.isRequired,\n  order: PropTypes.oneOf(['asc', 'desc']).isRequired,\n  orderBy: PropTypes.string.isRequired,\n  rowCount: PropTypes.number.isRequired,\n};\n\nfunction EnhancedTable(props) {\n  const { rows, classes, lookerContent } = props;\n  const [order, setOrder] = React.useState('asc');\n  const [orderBy, setOrderBy] = React.useState(Object.keys(rows[0])[0]);\n  const [page, setPage] = React.useState(0);\n  const [dense, setDense] = React.useState(true);\n  const [rowsPerPage, setRowsPerPage] = React.useState(25);\n\n  const handleRequestSort = (event, property) => {\n    const isAsc = orderBy === property && order === 'asc';\n    setOrder(isAsc ? 'desc' : 'asc');\n    setOrderBy(property);\n  };\n\n  const handleChangePage = (event, newPage) => {\n    setPage(newPage);\n  };\n\n  const handleChangeRowsPerPage = (event) => {\n    setRowsPerPage(parseInt(event.target.value, 10));\n    setPage(0);\n  };\n\n  const handleChangeDense = (event) => {\n    setDense(event.target.checked);\n  };\n\n  const emptyRows = rowsPerPage - Math.min(rowsPerPage, rows.length - page * rowsPerPage);\n  return (\n    <div className={classes.root}>\n      <ApiHighlight classes={classes} >\n        <TableContainer>\n          <Table\n            className={classes.table}\n            aria-labelledby=\"tableTitle\"\n            size={dense ? 'small' : 'medium'}\n            aria-label=\"enhanced table\"\n          >\n            <EnhancedTableHead\n              {...props}\n              classes={classes}\n              order={order}\n              orderBy={orderBy}\n              onRequestSort={handleRequestSort}\n              rowCount={rows.length}\n            />\n            <TableBody>\n              {stableSort(rows, getComparator(order, orderBy))\n                .slice(page * rowsPerPage, page * rowsPerPage + rowsPerPage)\n                .map((row, index) => {\n                  return (\n                    <TableRow\n                      hover\n                      key={validIdHelper('TableRow-' + index)}\n                      id={validIdHelper('TableRow-' + index)}>\n                      {Object.keys(row).map((key, index) => (\n                        <TableCell\n                          key={validIdHelper(key + '-TableBody-TableCell-' + index)}\n                          id={validIdHelper(key + '-TableBody-TableCell-' + index)}\n                          className={lookerContent[0].fieldType[key] === 'dimension' ? classes.blueSecondary : classes.orangeSecondary}\n                          align=\"right\">\n                          {row[key].rendered ? row[key].rendered : row[key].value}\n                        </TableCell>\n                      ))}\n                    </TableRow>\n                  );\n                })}\n              {emptyRows > 0 && (\n                <TableRow style={{ height: (dense ? 33 : 53) * emptyRows }}>\n                  <TableCell colSpan={6} />\n                </TableRow>\n              )}\n            </TableBody>\n          </Table>\n        </TableContainer>\n      </ApiHighlight>\n      <Grid container>\n        <Grid item sm={6}>\n          <FormControlLabel\n            control={<Switch checked={dense} onChange={handleChangeDense} />}\n            label=\"Compact\"\n          /></Grid>\n        <Grid item sm={6}>\n          <TablePagination\n            rowsPerPageOptions={[5, 10, 25, 50]}\n            component=\"div\"\n            count={rows.length}\n            rowsPerPage={rowsPerPage}\n            page={page}\n            onChangePage={handleChangePage}\n            onChangeRowsPerPage={handleChangeRowsPerPage}\n          /></Grid>\n      </Grid>\n      <div className={classes.bottomBarSpacer} />\n    </div>\n  );\n}")}),[v,E]);var w=function(){var e=Object(d.a)(l.a.mark((function e(t,n){var a,o,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=Object(c.a)({},s)).status="running",m(a),e.next=5,fetch("/createquerytask/"+JSON.stringify(t),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 5:return o=e.sent,e.next=8,o.json();case 8:r=e.sent,i=setInterval(Object(d.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/checkquerytask/"+r.queryTaskId,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:"complete"===(n=e.sent).queryResults.status&&(clearInterval(i),m(n.queryResults),f(r.code));case 7:case"end":return e.stop()}}),e)}))),5e3);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return o.a.createElement("div",{className:"".concat(k.root," ").concat(k.minHeight680,"   demoComponent")},o.a.createElement(me.a,{elevation:1,className:"".concat(k.padding30," ")},o.a.createElement(ue.a,{container:!0,spacing:3,key:mn(x)},o.a.createElement("div",{className:"".concat(k.root," ").concat(k.positionRelative)},o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(hn,Object.assign({},e,{classes:k,action:w}))),"running"===s.status?o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(me.a,{className:"".concat(k.card," ").concat(k.flexCentered),elevation:0},o.a.createElement(pe.a,{className:k.circularProgress}))):s.data&&s.data.length?o.a.createElement(j.a,null,o.a.createElement(ue.a,{container:!0},C?o.a.createElement(ue.a,{item:!0,sm:6,className:"".concat(k.positionTopRight)},o.a.createElement(ke,Object.assign({},e,{classes:k,lookerUser:E}))):"",o.a.createElement(te.a,{className:k.divider}),o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(j.a,{className:"".concat(k.w100," ").concat(k.maxHeight600," ").concat(k.padding30),mt:2},o.a.createElement(gn,Object.assign({},e,{classes:k,rows:s.data,lookerContent:v})))))):o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(X.a,{variant:"h6",component:"h6",className:"".concat(k.gridTitle," ").concat(k.textCenter)},"No results found, try a new query",o.a.createElement("br",null)))))))}function hn(e){e.staticContent;var t=e.staticContent.lookerContent,n=e.classes,r=e.action,i=e.lookerUser,s=0,l=0,c=Object(a.useState)(!0),d=Object(K.a)(c,2),m=d[0],u=d[1],p=Object(a.useState)(t[0].queryBody?t[0].queryBody.fields.map((function(e,n){return{key:"fieldChipData"+n,label:un(e.substring(e.lastIndexOf(".")+1,e.length)),datalabel:e,selected:!0,fieldType:t[0].fieldType[e]}})):""),h=Object(K.a)(p,2),b=h[0],g=h[1],f=Object(a.useState)(!1),y=Object(K.a)(f,2),C=y[0],v=y[1],E=Object(a.useState)(t[0].queryBody?Object.keys(t[0].queryBody.filters).map((function(e,n){return{key:"filter"+n,label:e,value:t[0].queryBody.filters[e],type:t[0].filterType[e]}})):""),w=Object(K.a)(E,2),_=w[0],S=w[1],j=function(e,t){var n=Object(k.a)(b);n[t].selected=!1===n[t].selected,g(n),v(!0)},T=function(e,t){var n=Object(k.a)(_);n[e].value=t,S(n),v(!0)},O={basic:["1 week","1 month","3 months","6 months"]};return O.advanced=[].concat(Object(k.a)(O.basic),["1 year"]),O.premium=[].concat(Object(k.a)(O.advanced),["before today"]),Object(a.useEffect)((function(){var e=Object(k.a)(_);e[3].value="6 months",S(e)}),[i]),o.a.createElement(at.a,{expanded:m,onChange:function(e,t){u(!m)},elevation:0},o.a.createElement(ot.a,{expandIcon:o.a.createElement(dt.a,null),"aria-controls":"panel1a-content",id:"panel1a-header"},o.a.createElement(X.a,{className:n.heading},"Build Query")),o.a.createElement(rt.a,null,o.a.createElement(ue.a,{container:!0,spacing:3},o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(X.a,{variant:"subtitle1"},"Select Metrics:",b.length?b.map((function(e,t){return"measure"===e.fieldType?o.a.createElement(Oe.a,{key:e.label,measurecounter:s+=1,className:e.selected?"".concat(n.orangePrimary," ").concat(n.m6):"".concat(n.m6),label:un(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),datalabel:e.label,onClick:function(){return j(0,t)},icon:e.selected?o.a.createElement(rn.a,{className:n.dBlock}):o.a.createElement(rn.a,{className:n.dNone})}):""})):"",o.a.createElement("br",null))),o.a.createElement(ue.a,{item:!0,sm:12},o.a.createElement(X.a,{variant:"subtitle1"},"Group By:",b.length?b.map((function(e,t){return"dimension"===e.fieldType?o.a.createElement(Oe.a,{key:e.label,dimensioncounter:l+=1,className:e.selected?"".concat(n.bluePrimary," ").concat(n.m6):"".concat(n.m6),label:un(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),datalabel:e.label,onClick:function(){return j(0,t)},icon:e.selected?o.a.createElement(rn.a,{className:n.dBlock}):o.a.createElement(rn.a,{className:n.dNone})}):""})):"",o.a.createElement("br",null))),o.a.createElement(ue.a,{item:!0,sm:3},o.a.createElement(X.a,{variant:"subtitle1"},"Filter By:"),_.length?_.map((function(e,t){return o.a.createElement(gt.a,{className:e.value.length?n.formControl:n.hidden,key:mn("".concat(e.label,"FormControl"))},"yesno"===e.type?o.a.createElement(o.a.Fragment,null,o.a.createElement(ft.a,{id:mn("".concat(e.label,"FilterLabel"))},un(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),":"),o.a.createElement(yt.a,{labelId:mn("".concat(e.label,"FilterLabel")),id:mn("".concat(e.label,"FilterSelect")),value:e.value,onChange:function(e){return T(t,e.target.value)}},o.a.createElement(ee.a,{value:"Yes"},"Yes"),o.a.createElement(ee.a,{value:"No"},"No"),o.a.createElement(ee.a,{value:"All"},"All"))):"date"===e.type?o.a.createElement(o.a.Fragment,null,o.a.createElement(ft.a,{id:mn("".concat(e.label,"FilterLabel"))},un(e.label.substring(e.label.lastIndexOf(".")+1,e.label.length)),":"),o.a.createElement(yt.a,{labelId:mn("".concat(e.label,"FilterLabel")),id:mn("".concat(e.label,"FilterSelect")),value:e.value||"6 months",onChange:function(e){return T(t,e.target.value)}},i.user_attributes.permission_level?O[i.user_attributes.permission_level].map((function(e){return o.a.createElement(ee.a,{key:mn(e),value:e},x.a.capitalize(e))})):"")):"")})):""),o.a.createElement(ue.a,{item:!0,sm:9},o.a.createElement("br",null),o.a.createElement(Ye.a,{color:"primary",variant:"contained",size:"large",onClick:function(e){if(C){var n=b.filter((function(e){return e.selected})).map((function(e){return e.datalabel})),a={};_.map((function(e,t){a[e.label]=e.value}));var o=t[0].queryBody;o.fields=n,o.filters=a,r(o,t[0].resultFormat),v(!1)}},disabled:!C},"Run Query")))))}function bn(e){var t=e.classes,n=(e.onSelectAllClick,e.order),a=e.orderBy,r=(e.numSelected,e.rowCount,e.onRequestSort),i=e.rows;return o.a.createElement(wt.a,null,o.a.createElement(_t.a,null,Object.keys(i[0]).map((function(e,i){return o.a.createElement(xt.a,{key:mn(e+"-TableHead-TableCell-"+i),id:mn(e+"-TableHead-TableCell-"+i),align:e.numeric?"right":"left",padding:e.disablePadding?"none":"default",sortDirection:a===e&&n},o.a.createElement(nn.a,{active:a===e,direction:a===e?n:"asc",onClick:(s=e,function(e){r(e,s)})},un(e.substring(e.lastIndexOf(".")+1,e.length)),a===e?o.a.createElement("span",{className:t.visuallyHidden},"desc"===n?"sorted descending":"sorted ascending"):null));var s}))))}function gn(e){var t=e.rows,n=e.classes,a=e.lookerContent,r=o.a.useState("asc"),i=Object(K.a)(r,2),s=i[0],l=i[1],c=o.a.useState(Object.keys(t[0])[0]),d=Object(K.a)(c,2),m=d[0],u=d[1],p=o.a.useState(0),h=Object(K.a)(p,2),b=h[0],g=h[1],f=o.a.useState(!0),y=Object(K.a)(f,2),C=y[0],k=y[1],v=o.a.useState(25),x=Object(K.a)(v,2),E=x[0],w=x[1],_=E-Math.min(E,t.length-b*E);return o.a.createElement("div",{className:n.root},o.a.createElement(Ne,{classes:n},o.a.createElement(Et.a,null,o.a.createElement(kt.a,{className:n.table,"aria-labelledby":"tableTitle",size:C?"small":"medium","aria-label":"enhanced table"},o.a.createElement(bn,Object.assign({},e,{classes:n,order:s,orderBy:m,onRequestSort:function(e,t){l(m===t&&"asc"===s?"desc":"asc"),u(t)},rowCount:t.length})),o.a.createElement(vt.a,null,function(e,t){var n=e.map((function(e,t){return[e,t]}));return n.sort((function(e,n){var a=t(e[0],n[0]);return 0!==a?a:e[1]-n[1]})),n.map((function(e){return e[0]}))}(t,function(e,t){return"desc"===e?function(e,n){return cn(e,n,t)}:function(e,n){return-cn(e,n,t)}}(s,m)).slice(b*E,b*E+E).map((function(e,t){return o.a.createElement(_t.a,{hover:!0,key:mn("TableRow-"+t),id:mn("TableRow-"+t)},Object.keys(e).map((function(t,r){return o.a.createElement(xt.a,{key:mn(t+"-TableBody-TableCell-"+r),id:mn(t+"-TableBody-TableCell-"+r),className:"dimension"===a[0].fieldType[t]?n.blueSecondary:n.orangeSecondary,align:"right"},e[t].rendered?e[t].rendered:e[t].value)})))})),_>0&&o.a.createElement(_t.a,{style:{height:(C?33:53)*_}},o.a.createElement(xt.a,{colSpan:6})))))),o.a.createElement(ue.a,{container:!0},o.a.createElement(ue.a,{item:!0,sm:6},o.a.createElement(Ke.a,{control:o.a.createElement(Je.a,{checked:C,onChange:function(e){k(e.target.checked)}}),label:"Compact"})),o.a.createElement(ue.a,{item:!0,sm:6},o.a.createElement(an.a,{rowsPerPageOptions:[5,10,25,50],component:"div",count:t.length,rowsPerPage:E,page:b,onChangePage:function(e,t){g(t)},onChangeRowsPerPage:function(e){w(parseInt(e.target.value,10)),g(0)}}))),o.a.createElement("div",{className:n.bottomBarSpacer}))}var fn=n(1029),yn=n(1032),Cn=n(390),kn=n.n(Cn),vn=n(103),xn=n(46).validIdHelper,En=Object(J.a)((function(e){return{paper:{position:"absolute",width:1e3,height:580,overflow:"scroll",backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},card:{display:"flex",flexDirection:"column",justifyContent:"space-between",overflow:"scroll",cursor:"pointer","&:hover":{transform:"scale(1.05)",transition:"transform .2s"}},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},padding15:{padding:15},divider:{marginTop:15,marginBottom:15,color:"#fff"},basic:{},advanced:{},premium:{backgroundColor:"#5F6BD8",color:"#ffffff"},font75:{fontSize:".75em"},font875:{},padding30:{padding:30}}}));function wn(){return{top:"".concat(10,"%"),left:"".concat(50,"%"),transform:"translate(-".concat(50,"%, -").concat(10,"%)")}}function _n(e){e.props;var t=e.switchLookerUser,n=Object(a.useContext)(oe),r=n.payWallModal,i=n.togglePayWallModal,s=n.lookerUser,l=o.a.useState(wn),c=Object(K.a)(l,1)[0],d=En(),m={basic:["6 months of order data history","Atom Merchant Dashboards","Download PDFs, CSVs"],advanced:["Full year of order data history","Drill to row level information","Download row level information","Schedule dashboards for delivery (to you or others)","Set alerts and key threshold notifications"],premium:["2 Full years of order data history","Analyze your own data and save custom reports","View premium level, productivity enhancing reports","Share your reports with colleagues in Atom","Text message alerts"]};return o.a.createElement(Ct.a,{className:"".concat(d.modal," "),open:r.show||!1,onClose:i},o.a.createElement(be.a,{in:r.show||!1},o.a.createElement("div",{style:c,className:"".concat(d.paper," ").concat(d.padding30)},o.a.createElement(ue.a,{container:!0,spacing:3},Object.keys(vn).map((function(e){return o.a.createElement(ue.a,{item:!0,sm:4,key:xn("monetizationModal-gridItem-".concat(e))},o.a.createElement(me.a,{className:"".concat(d.card," ").concat(d[e]),elevation:1,style:e===s.user_attributes.permission_level?{transform:"scale(1.05)",transition:"transform .2s",height:495}:{height:495},onClick:function(){t(e),i()}},o.a.createElement(fn.a,null,o.a.createElement(X.a,{variant:"h6"},x.a.capitalize(e)),o.a.createElement(X.a,{variant:"subtitle1",style:{fontStyle:"italic"}},"basic"===e?"Drive your business with clear KPIs":"advanced"===e?"Deeper insights, operations":"Drive your business with Atom"),o.a.createElement(te.a,{className:"".concat(d.divider," ")}),o.a.createElement(D.a,{className:d.root},m[e].map((function(t,n){return o.a.createElement(F.a,{dense:!0,className:d.font875,key:"monetizationModal-ListItem-".concat(e,"-").concat(n)},o.a.createElement(P.a,null,o.a.createElement(kn.a,{fontSize:"small"})),o.a.createElement(H.a,{primary:t}))})))),o.a.createElement(yn.a,{disableSpacing:!1},o.a.createElement(Ye.a,{color:"primary",variant:"outlined",disabled:e===s.user_attributes.permission_level,fullWidth:!0,onClick:function(){t(e),i()}},Object.keys(m).indexOf(s.user_attributes.permission_level)<Object.keys(m).indexOf(e)?"Upgrade":"Switch"))))}))))))}var Sn=n(46).validIdHelper,jn=Object(V.a)({}),Tn=Object(V.a)({palette:{primary:{main:W.a[900]},secondary:{main:W.a[400]}}}),On=Object(V.a)({palette:{primary:{main:Q.a[500]}}}),In=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).togglePayWallModal=function(e){a.setState({payWallModal:Object(c.a)({},e)})},a.toggleHighlightShow=function(){a.state.codeShow&&a.toggleCodeShow(),a.setState({highlightShow:!a.state.highlightShow})},a.toggleCodeShow=function(){a.state.highlightShow&&a.toggleHighlightShow(),a.setState({codeShow:!a.state.codeShow})},a.handleTabChange=function(e){a.setState({activeTabValue:e})},a.handleMenuItemSelect=function(e,t){a.handleTabChange(0),a.state.highlightShow&&a.toggleHighlightShow(),a.state.codeShow&&a.toggleCodeShow();var n="";t?le[a.state.activeUsecase].demoComponents.map((function(t){"splash page"!==t.type&&t.lookerContent.map((function(a){a.id===e&&(n=Sn(t.type+a.id))}))})):n=e;var o=Object(k.a)(a.state.renderedDemoComponents);-1==o.indexOf(n)&&o.unshift(n),a.setState((function(e){return{selectedMenuItem:n,renderedDemoComponents:Object(k.a)(o)}}))},a.state={drawerOpen:!0,drawerTabValue:0,activeTabValue:0,activeUsecase:"",appLayout:"",highlightShow:!1,payWallModal:{},selectedMenuItem:"",renderedDemoComponents:[],codeShow:!1},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(e){var t=this,n=window.location.pathname.replace(/^\/([^\/]*).*$/,"$1");this.setState({activeUsecase:n,appLayout:le[n].layout||"left-sidebar"},(function(){se.LookerEmbedSDK.init("https://".concat(t.props.lookerHost,".looker.com"),"/auth")}))}},{key:"componentDidUpdate",value:function(e){var t=e.lookerUser.user_attributes.permission_level,n=this.props.lookerUser.user_attributes.permission_level,a=e.lookerUser.user_attributes.brand,o=this.props.lookerUser.user_attributes.brand;t===n&&a===o||(se.LookerEmbedSDK.init("https://".concat(this.props.lookerHost,".looker.com"),"/auth"),this.setState({renderedDemoComponents:[this.state.selectedMenuItem]},(function(){})))}},{key:"render",value:function(){var e={splashpage19:nt,simpledashboard5:ht,simpledashboard9:ht,customfilter1:ht,customvis:$t,querybuilderexplorelite:pn,reportbuilder14:en},t={atom:Tn,vidly:On},n=this.state,a=(n.drawerTabValue,n.drawerOpen),r=n.activeTabValue,i=n.activeUsecase,s=n.selectedMenuItem,l=n.renderedDemoComponents,c=this.handleTabChange,d=this.handleMenuItemSelect,m=this.props,u=m.classes,p=(m.activeCustomization,m.switchLookerUser),h=m.lookerUser,b=m.applySession,g=m.lookerUserAttributeBrandOptions,f=m.switchUserAttributeBrand,y=m.lookerHost,v=m.userProfile,w=i?x.a.orderBy(le[i].demoComponents,["menuCategory"],["asc"]):[],T={},O=[],I=0;if(w.map((function(e,t){T.hasOwnProperty(e.menuCategory)?T[e.menuCategory]=[].concat(Object(k.a)(T[e.menuCategory]),[e]):(T[e.menuCategory]=[e],I+=1,O.push(""+(t+I)))})),i&&!s.length){var N=le[i].demoComponents[0].lookerContent[0].id?Sn(le[i].demoComponents[0].type+le[i].demoComponents[0].lookerContent[0].id):Sn(le[i].demoComponents[0].type);this.setState({selectedMenuItem:N,renderedDemoComponents:[N]},(function(){}))}return o.a.createElement("div",{className:u.root},o.a.createElement(oe.Provider,{value:{show:this.state.highlightShow,toggleShow:this.toggleHighlightShow,payWallModal:this.state.payWallModal,togglePayWallModal:this.togglePayWallModal,lookerUser:h,userProfile:v,codeShow:this.state.codeShow,toggleCodeShow:this.toggleCodeShow}},o.a.createElement(z.a,{theme:i?t[i]:jn},o.a.createElement(_.a,null),o.a.createElement(Dn,Object.assign({},this.props,{classes:u,activeUsecase:i,lookerUser:h,switchLookerUser:p,applySession:b,lookerUserAttributeBrandOptions:g,switchUserAttributeBrand:f})),o.a.createElement(S.a,{className:u.drawer,variant:"persistent",anchor:"left",open:a,classes:{paper:u.drawerPaper}},o.a.createElement("div",{className:u.drawerHeader}),Object.keys(T).length?o.a.createElement(Fn,Object.assign({},this.props,{classes:u,activeUsecase:i,orderedDemoComponentsForMenuObj:T,selectedMenuItem:s,handleMenuItemSelect:d})):"",o.a.createElement(_n,{switchLookerUser:p}),o.a.createElement(et,{classes:u,lookerUser:h})),o.a.createElement("main",{className:Object(E.a)(u.content,Object(C.a)({},u.contentShift,a))},o.a.createElement("div",{className:u.drawerHeader}),i?le[i].demoComponents.map((function(t,n){var a=t.lookerContent[0].id?Sn(t.type+t.lookerContent[0].id):Sn(t.type),m=e[a];return o.a.createElement(o.a.Fragment,{key:Sn("outerFragment-".concat(t.type,"-").concat(n))},l.indexOf(a)>-1?o.a.createElement(j.a,{key:Sn("box-".concat(t.type,"-").concat(n)),className:a===s?"":"".concat(u.hide)},o.a.createElement(m,{key:Sn("demoComponent-".concat(t.type,"-").concat(n)),staticContent:t,handleMenuItemSelect:d,activeTabValue:r,handleTabChange:c,lookerUser:h,activeUsecase:i,lookerHost:y,userProfile:v})):"")})):""))))}}]),n}(a.Component),Nn=Object(w.a)((function(e){return{root:{display:"flex"},appBar:{transition:e.transitions.create(["margin","width"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),zIndex:1201,backgroundColor:"#343D4E"},menuButton:{marginRight:e.spacing(2)},hide:{display:"none"},drawer:{width:240,flexShrink:0,borderRight:"none",backgroundColor:"transparent"},drawerPaper:{width:240,borderRight:"none",backgroundColor:"transparent"},drawerHeader:Object(c.a)(Object(c.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-end"}),content:{flexGrow:1,padding:e.spacing(3),transition:e.transitions.create("margin",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),marginLeft:-240},contentShift:{transition:e.transitions.create("margin",{easing:e.transitions.easing.easeOut,duration:e.transitions.duration.enteringScreen}),marginLeft:0},title:{flexGrow:1},tabs:{borderRight:"1px solid ".concat(e.palette.divider)},dNone:{display:"none"},dBlock:{display:"block"},relative:{position:"relative"},absolute:{position:"absolute"},right0:{right:0},top0:{top:0},right24:{right:24},top24:{top:24},ml12:{marginLeft:12},mr12:{marginRight:12},mt12:{marginTop:12},highlightLegend:{position:"fixed",bottom:e.spacing(2),left:e.spacing(2),zIndex:1200},tree:{height:240,flexGrow:1,maxWidth:400},parentHoverVisibility:{"&:hover $childHoverVisibility":{visibility:"visible"}},childHoverVisibility:{visibility:"hidden"},fontSize1em:{fontSize:"1em"},padding10:{padding:10},mt5:{marginTop:5},mb5:{marginBottom:5},modal:{display:"flex",alignItems:"center",justifyContent:"center"},paper:{backgroundColor:e.palette.background.paper,border:"2px solid #000",boxShadow:e.shadows[5],padding:e.spacing(2,4,3)},list:{width:"100%",maxWidth:360,backgroundColor:"transparent"},nested:{paddingLeft:e.spacing(4)},mlAuto:{marginLeft:"auto"},mrAuto:{marginRight:"auto"},appBarBottom:{top:"auto",bottom:0},hidden:{visibility:"hidden"},roundedTab:{borderRadius:"0 100px 100px 0"},paddingBottom30:{paddingBottom:30}}}))(In);function Dn(e){var t=e.classes,a=e.activeUsecase,r=e.lookerUser,i=e.switchLookerUser,s=e.applySession,l=e.lookerUserAttributeBrandOptions,c=e.switchUserAttributeBrand;return o.a.createElement(T.a,{position:"fixed",className:Object(E.a)(t.appBar)},o.a.createElement(O.a,null,a?o.a.createElement(I.a,{alt:"Icon",src:n(880)("./".concat(a,"_logo_white.svg")),variant:"square"}):"",o.a.createElement(N.a,{badgeContent:3,color:"error",className:"".concat(t.mlAuto," ").concat(t.mr12," ")},o.a.createElement(R.a,null)),o.a.createElement(ie,{lookerUser:r,switchLookerUser:i,onLogoutSuccess:s,lookerUserAttributeBrandOptions:l,switchUserAttributeBrand:c})))}function Fn(e){var t=e.classes,n=e.activeUsecase,a=e.orderedDemoComponentsForMenuObj,r=e.selectedMenuItem,i=e.handleMenuItemSelect,s={splashpage19:q.a,simpledashboard5:A.a,simpledashboard9:B.a,customfilter1:U.a,customvis:L.a,querybuilderexplorelite:$.a,reportbuilder14:M.a};return o.a.createElement(D.a,{component:"nav","aria-labelledby":"nested-list-subheader",className:t.list},n?Object.keys(a).map((function(e,n){return o.a.createElement(o.a.Fragment,{key:"".concat(Sn(e+"-menuList-"+n))},o.a.createElement(F.a,{key:"".concat(Sn(e+"-outerListItem-"+n))},o.a.createElement(H.a,{primary:"home"===e?"":x.a.upperCase(e)})),o.a.createElement(D.a,{component:"div",disablePadding:!0,key:"".concat(Sn(e+"-innerList-"+n))},a[e].map((function(n,a){var l=n.lookerContent[0].id?Sn(n.type+n.lookerContent[0].id):Sn(n.type),c=s[l];return o.a.createElement(F.a,{button:!0,className:"".concat(t.nested," ").concat(t.roundedTab),key:"".concat(Sn(e+"-innerListItem-"+a)),onClick:function(){return i(Sn(n.lookerContent[0].id?n.type+n.lookerContent[0].id:n.type))},selected:Sn(n.lookerContent[0].id?n.type+n.lookerContent[0].id:n.type)===r},o.a.createElement(P.a,null,o.a.createElement(c,null)),o.a.createElement(H.a,{primary:x.a.capitalize(n.label)}))}))))})):"")}var Hn=n(46).validIdHelper,Pn=W.a[200],Rn=Object(J.a)((function(e){return{root:{flexGrow:1,backgroundColor:e.palette.background.paper},flexCentered:{display:"flex",justifyContent:"center",alignItems:"center"},card:{minWidth:350,minHeight:500,left:"75%",top:"50%",transform:"translate(-75%, -50%)",position:"absolute",textAlign:"center",backgroundColor:Pn},h100:{height:"100%"},title:{fontSize:14},pos:{marginBottom:12},actions:{alignItems:"center",justifyContent:"center"},cardCopy:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",margin:"0",width:"80%"}}}));function An(e){var t=e.googleClientId,a=e.onSuccess,r=(e.onFailure,Rn()),i=window.location.pathname.replace(/^\/([^\/]*).*$/,"$1"),s=Math.floor(4*Math.random())+1,l=n(882)("./".concat(i,"_background").concat(s,".jpg")),c=n(887)("./".concat(i,"_logo_black.svg"));return o.a.createElement("div",{className:"".concat(r.root," demoComponent ").concat(r.h100)},o.a.createElement(ue.a,{container:!0,key:Hn("sign in page"),className:"".concat(r.h100)},o.a.createElement(ue.a,{item:!0,sm:12,className:"sign-in-background-img",style:{backgroundImage:"url(".concat(l,")"),backgroundSize:"cover"}},o.a.createElement(me.a,{className:r.card},o.a.createElement("div",{className:r.cardCopy},o.a.createElement("img",{src:c}),o.a.createElement(fn.a,null,o.a.createElement(X.a,{variant:"h5",component:"h2"},"Welcome"),o.a.createElement(X.a,{variant:"body2",component:"p"},"Please sign in to access ",o.a.createElement("br",null)," your merchant portal")),o.a.createElement(yn.a,{className:"".concat(r.actions)},o.a.createElement(y.GoogleLogin,{clientId:t,buttonText:"Login",onSuccess:a,onFailure:a,cookiePolicy:"single_host_origin"})))))))}var Bn=n(119),Un=n(392),Ln=n.n(Un),$n=(o.a.Component,n(61));o.a.Component;var Mn=n(276),Gn=n(394),qn=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).responseGoogle=function(e){e.error?console.log("response.error",e.error):a.props.applySession(e.profileObj)},a}return Object(p.a)(n,[{key:"render",value:function(){var e=(this.props.location.state||{from:{pathname:"/home"}}).from,t=(this.props.location.pathname,this.props.activeCustomization,this.props.userProfile),n="".concat("610722499102-hqo4cena1n453n11mqk88jj5arv4p3ft",".apps.googleusercontent.com");return Object.keys(t).length?o.a.createElement("div",{className:"App"},o.a.createElement(g.a,{to:e})):o.a.createElement(An,{googleClientId:n,onSuccess:this.responseGoogle,onFailure:this.responseGoogle})}}]),n}(o.a.Component),Vn=function(e){var t=e.component,n=e.customizations,a=e.activeCustomization,r=e.applyCustomization,i=e.editCustomization,s=e.indexOfCustomizationToEdit,l=e.saveCustomization,c=e.cancelIndexOfCustomizationToEdit,d=e.lookerContent,u=e.saveLookerContent,p=e.userProfile,h=e.lookerUser,b=e.lookerHost,f=e.switchLookerUser,y=e.applySession,C=e.lookerUserAttributeBrandOptions,k=e.switchUserAttributeBrand,v=Object(m.a)(e,["component","customizations","activeCustomization","applyCustomization","editCustomization","indexOfCustomizationToEdit","saveCustomization","cancelIndexOfCustomizationToEdit","lookerContent","saveLookerContent","userProfile","lookerUser","lookerHost","switchLookerUser","applySession","lookerUserAttributeBrandOptions","switchUserAttributeBrand"]);return o.a.createElement(g.b,Object.assign({},v,{render:function(e){return Object.keys(p).length?o.a.createElement(t,Object.assign({},e,{customizations:n,activeCustomization:a,applyCustomization:r,editCustomization:i,indexOfCustomizationToEdit:s,saveCustomization:l,cancelIndexOfCustomizationToEdit:c,lookerContent:d,saveLookerContent:u,userProfile:p,lookerUser:h,lookerHost:b,switchLookerUser:f,applySession:y,lookerUserAttributeBrandOptions:C,switchUserAttributeBrand:k})):o.a.createElement(g.a,{to:{pathname:"/",state:{from:e.location}}})}}))},zn=function(e){Object(h.a)(n,e);var t=Object(b.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).checkSession=Object(d.a)(l.a.mark((function e(){var t,n,o,r,i,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/readsession",{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,o=n.session.userProfile,r=n.session.customizations,i=n.session.activeCustomization?n.session.activeCustomization:0,s=n.session.lookerUser?n.session.lookerUser:a.state.lookerUser,d=n.session.lookerHost?n.session.lookerHost:a.state.lookerHost,o&&Object.keys(o).length&&a.setState((function(e){return{userProfile:o,customizations:r,lookerUser:Object(c.a)(Object(c.a)({},e.lookerUser),{},{external_user_id:o.googleId,first_name:o.givenName,last_name:o.familyName,permissions:vn[s.user_attributes.permission_level]||vn.basic,user_attributes:Object(c.a)({},s.user_attributes||{locale:"en_US",country:"USA",brand:"Calvin Klein",permission_level:"basic"})}),lookerHost:d}}),(function(){a.applyCustomization(i)}));case 12:case"end":return e.stop()}}),e)}))),a.applySession=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,o,r,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(t).length){e.next=7;break}return e.next=3,fetch("/endsession",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"}});case 3:e.sent,a.setState({userProfile:{},lookerUser:Object(c.a)({},Mn)}),e.next=17;break;case 7:return e.next=9,fetch("/writesession",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({userProfile:t,lookerUser:a.state.lookerUser})});case 9:return n=e.sent,e.next=12,n.json();case 12:o=e.sent,r=o.session.customizations,i=o.session.lookerUser?o.session.lookerUser:a.state.lookerUser,s=o.session.lookerHost?o.session.lookerHost:a.state.lookerHost,a.setState((function(e){return{userProfile:t,customizations:r,lookerUser:Object(c.a)(Object(c.a)({},e.lookerUser),{},{external_user_id:t.googleId,first_name:t.givenName,last_name:t.familyName,permissions:vn[i.user_attributes.permission_level]||vn.basic,user_attributes:Object(c.a)({},i.user_attributes||{locale:"en_US",country:"USA",brand:"Calvin Klein",time_horizon:"last 6 months",permission_level:"basic"})}),lookerHost:s}}),(function(){a.applyCustomization(0)}));case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.applyCustomization=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/applyactivecustomziation",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({customizationIndex:t})});case 2:return n=e.sent,e.next=5,n.json();case 5:e.sent,o=[],a.state.customizations[t].industry,a.state.customizations[t].lookerContent,a.setState({activeCustomization:a.state.customizations[t],lookerContent:o},(function(){}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.editCustomization=function(e){var t="undefined"===typeof a.state.customizations[e]?null:e;a.setState({indexOfCustomizationToEdit:t},(function(){}))},a.saveCustomization=function(){var e=Object(d.a)(l.a.mark((function e(t){var n,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/savecustomization",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)});case 2:return n=e.sent,e.next=5,n.json();case 5:o=e.sent,a.setState({customizations:o.customizations},(function(){a.applyCustomization(t.customizationIndex)}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.cancelIndexOfCustomizationToEdit=function(){a.setState({indexOfCustomizationToEdit:null})},a.saveLookerContent=function(){var e=Object(d.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.switchLookerUser=function(e){var t=Object(c.a)(Object(c.a)({},a.state.lookerUser.user_attributes),{},{permission_level:e});t.time_horizon={basic:"last 182 days",advanced:"last 365 days",premium:"last 730 days"}[e],a.setState((function(n){return{lookerUser:Object(c.a)(Object(c.a)({},n.lookerUser),{},{permissions:vn[e],user_attributes:t})}}),Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/updatelookeruser",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a.state.lookerUser)});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)}))))},a.switchUserAttributeBrand=function(e){var t=Object(c.a)({},a.state.lookerUser.user_attributes);t.brand=e;var n=window.location.pathname.replace(/^\/([^\/]*).*$/,"$1");n.length?le.hasOwnProperty(n)||(window.location.href=window.location.href.replace(n,"atom")):window.location.href=window.location.href+"atom",a.setState((function(a){return{lookerUser:Object(c.a)(Object(c.a)({},a.lookerUser),{},{user_attributes:t,group_ids:[le[n].groupIds[e]]})}}),Object(d.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/updatelookeruser",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(a.state.lookerUser)});case 2:return t=e.sent,e.next=5,t.json();case 5:e.sent;case 6:case"end":return e.stop()}}),e)}))))},a.state={userProfile:{},customizations:[],activeCustomization:{},indexOfCustomizationToEdit:null,lookerContent:[],lookerUser:Object(c.a)({},Mn),lookerHost:"",activeUsecase:""},a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.checkSession()}},{key:"render",value:function(){var e=this,t=this.state,n=t.userProfile,a=(t.customizations,t.activeCustomization),r=(t.indexOfCustomizationToEdit,t.lookerContent),i=t.lookerUser,s=t.lookerHost,l=window.location.pathname.replace(/^\/([^\/]*).*$/,"$1");return l.length?le.hasOwnProperty(l)||(window.location.href=window.location.href.replace(l,"atom")):window.location.href=window.location.href+"atom",o.a.createElement(f.a,{basename:l},o.a.createElement("div",null,o.a.createElement(g.b,{path:"",render:function(t){return o.a.createElement(qn,Object.assign({},t,{applySession:e.applySession,userProfile:n,activeCustomization:a,lookerUser:i,switchLookerUser:e.switchLookerUser,lookerHost:s}))}}),o.a.createElement(Vn,{path:"*/home",component:Nn,activeCustomization:a,lookerContent:r,saveLookerContent:this.saveLookerContent,userProfile:n,lookerUser:i,applySession:this.applySession,lookerHost:s,switchLookerUser:this.switchLookerUser,lookerUserAttributeBrandOptions:Gn,switchUserAttributeBrand:this.switchUserAttributeBrand})))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(zn,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[430,1,2]]]);
//# sourceMappingURL=main.b6d8df1f.chunk.js.map